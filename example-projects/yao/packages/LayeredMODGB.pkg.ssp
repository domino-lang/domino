package LayeredMODGB {
    params {
        w: Integer,
        p: Integer,
    }

    import oracles {
        GBLG(
            i: Integer, 
            l: Integer, 
            r: Integer, 
            op: Table((Bool,Bool),Bool), 
            j: Integer) -> Table(Bits(p),Bool),
    }

    oracle GBL(
            i: Integer, 
            Ci: Table(Integer, (Integer, Integer, Table((Bool,Bool),Bool)))) 
            -> Table(Integer, Table(Bits(p), Bool)) 
    {
        T   <- new Table(Integer, Table(Bits(p), Bool));
        tmp <- new Table(Bits(p),Bool);
        for j: 1 <= j <= w {
            (l,r,op) <- parse Unwrap(Ci[j]);
            assert not (op[(true,  true)] == None);
            assert not (op[(true, false)] == None);
            assert not (op[(false, true)] == None);
            assert not (op[(false,false)] == None);
            tmp <- invoke GBLG(i, l, r, op, j);
            T[j] <- Some(tmp);
        }
        return T;
    }
}
