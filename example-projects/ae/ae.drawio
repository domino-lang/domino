<mxfile host="app.diagrams.net" modified="2024-07-11T22:24:16.602Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36" etag="ARIf329eyP12jAZw6W4G" version="24.4.6" type="device">
  <diagram name="Page-1" id="ZuFnQlpUNbcYl7VYdP77">
    <mxGraphModel dx="736" dy="519" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="GizzI6XRx-BD20AivPmG-1" value="kx-to-ks-reduction (hard)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="80" y="120" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-2" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="200" y="40" as="sourcePoint" />
            <mxPoint x="360" y="40" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-3" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="360" y="60" as="sourcePoint" />
            <mxPoint x="200" y="60" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-4" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="200" y="79" as="sourcePoint" />
            <mxPoint x="360" y="79" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-5" value="U" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="110" y="10" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-6" value="V" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="395" y="10" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-7" value="nonce&lt;sub&gt;U&lt;/sub&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="227" y="18" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-8" value="nonce&lt;sub&gt;V&lt;/sub&gt;, tau&lt;sub&gt;V&lt;/sub&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="232" y="38" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-9" value="tau&lt;sub&gt;U&lt;/sub&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="255" y="57" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-10" value="tau&lt;sub&gt;V&lt;/sub&gt; &amp;lt;-- mac(&amp;nbsp; prf(ltk&lt;sub&gt;{U,V}&lt;/sub&gt;,(nonce&lt;sub&gt;U&lt;/sub&gt;,nonce&lt;sub&gt;V&lt;/sub&gt;,0))&amp;nbsp; ,(U,V)&amp;nbsp; )&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 1 = verify(&amp;nbsp; prf(ltk&lt;sub&gt;{U,V}&lt;/sub&gt;,(nonce&lt;sub&gt;U&lt;/sub&gt;,nonce&lt;sub&gt;V&lt;/sub&gt;,1)),&amp;nbsp; (U,V),&amp;nbsp;&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;tau&lt;/span&gt;&lt;sub style=&quot;background-color: initial;&quot;&gt;U&lt;/sub&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;k &amp;lt;-- prf(ltk&lt;sub&gt;{U,V}&lt;/sub&gt;,(nonce&lt;sub&gt;U&lt;/sub&gt;,nonce&lt;sub&gt;V&lt;/sub&gt;,2))&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="324" y="33" width="370" height="80" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-11" value="?" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="368" y="54" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-12" value="kx:&lt;div&gt;- sessions&lt;/div&gt;&lt;div&gt;- ideal game: only accept if there exists a matching session at the other party.&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="80" y="170" width="110" height="120" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-13" value="ks:&lt;div&gt;- keys&lt;/div&gt;&lt;div&gt;- nonce pairs&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="200" y="170" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-14" value="This is a horrible condition. How can we deal with it?!" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#fad9d5;strokeColor=#ae4132;" vertex="1" parent="1">
          <mxGeometry x="80" y="290" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-15" value="It follows from:&lt;div&gt;- nonce uniqueness&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;- PRF security&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;- MAC security&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="80" y="330" width="200" height="70" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-16" value="But nonces can&#39;t &quot;collide&quot; in our world anyways since they are symbolic...&lt;div&gt;...could add an assert, but&lt;/div&gt;&lt;div&gt;how can the code know this?!&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="80" y="410" width="200" height="110" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-17" value="kx-to-ks-reduction (toy version)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="360" y="120" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-18" value="kx:&lt;div&gt;- sessions&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="360" y="170" width="110" height="120" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-19" value="ks:&lt;div&gt;- keys&lt;/div&gt;&lt;div&gt;- nonce pairs&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="480" y="170" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-20" value="Needs:&lt;div&gt;- nonce uniqueness&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;- PRF security&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="360" y="280" width="200" height="70" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-21" value="Classic reduction style:&lt;div&gt;- add assert in real and ideal game.&lt;/div&gt;&lt;div&gt;- idealize all PRFs.&lt;/div&gt;&lt;div&gt;- just sample things randomly.&lt;/div&gt;&lt;div&gt;- handwave that keys are now truly random and independent of everything else (replace by code equivalence with randomness mapping)&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="360" y="360" width="200" height="160" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-22" value="How about the horrible condition?&lt;div&gt;- idealize nonces, PRFs, MAC&lt;/div&gt;&lt;div&gt;- then invariant is that nothing&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; enters the MAC table unless&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;there exists a&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;session with the&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; correct ids + nonces. Hence,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;can introduce abort.&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- then de-idealize everything.&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;--&amp;gt; cleanest way with hidden bit?&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#fad9d5;strokeColor=#ae4132;" vertex="1" parent="1">
          <mxGeometry x="360" y="529" width="200" height="131" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-23" value="What is the point of&amp;nbsp;&lt;div&gt;kx-to-ks reduction?&lt;/div&gt;&lt;div&gt;Could we do the&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;TLS 1.3 proof differently?&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#fff2cc;strokeColor=#d6b656;rotation=15;" vertex="1" parent="1">
          <mxGeometry x="80" y="570" width="200" height="70" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-24" value="Maybe, Charlotte is right about the blended approach, i.e., just pull things out and don&#39;t push them back in again?" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#fff2cc;strokeColor=#d6b656;rotation=0;" vertex="1" parent="1">
          <mxGeometry x="80" y="680" width="200" height="70" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-25" value="For TLS 1.3, it&#39;s not just about&lt;div&gt;pulling things out...&lt;/div&gt;&lt;div&gt;...but what is the issue exactly?&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#fff2cc;strokeColor=#d6b656;rotation=0;" vertex="1" parent="1">
          <mxGeometry x="80" y="760" width="200" height="70" as="geometry" />
        </mxCell>
        <mxCell id="GizzI6XRx-BD20AivPmG-26" value="As a session identifier, we can use&lt;div&gt;(U,V,nonce&lt;sub&gt;U&lt;/sub&gt;,nonce&lt;sub&gt;V&lt;/sub&gt;)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In the ideal game, we want to set keys (for the first time) whenever they are set in the real game (else, reduction to PRF becomes a mess).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;...do we want to store keys indexed by their session identifier or do we store an equal key when the 2nd session accepts?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I kind of like indexing keys by their session&lt;/div&gt;&lt;div&gt;identifier, and one can still prove that session identifiers are &quot;proper&quot;. In fact, one can hardcode this via an assert in the real game only (in the ideal game, it holds automatically).&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#fff2cc;strokeColor=#d6b656;rotation=0;" vertex="1" parent="1">
          <mxGeometry x="360" y="680" width="260" height="240" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
