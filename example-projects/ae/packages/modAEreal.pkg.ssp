package modAEReal {
    params {
     n: Integer,
     enc: fn Bits(n), Bits(n), Bits(n) -> Bits(n),
     dec: fn Bits(n), Bits(n) -> Bits(n),
    }


    import oracles {
        Get(h: Bits(n)) -> Bits(n),
        Get_(h_: Bits(n)) -> Bits(n),
    }
    
    oracle Enc(h: Bits(n), msg: Bits(n)) -> Bits(n) {
        k <- invoke Get(h);   
        r <-$ Bits(n);
        return enc(k,msg,r);
    }

    oracle Dec(h_: Bits(n), c: Bits(n)) -> Bits(n) {
        k <- invoke Get_(h_);   
        return dec(k,c);
    }
}
