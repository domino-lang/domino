\newif\iffull\fullfalse% do not change flags here
\newif\ifdraft\draftfalse% do not change flags here

\fulltrue  % full  = long version (stuff to move to appendix)
\drafttrue % draft = comments and half-baked bits

\pdfsuppressptexinfo-1

%
%\documentclass[letterpaper,table,dvipsnames,10pt]{article}
\documentclass[hyperref,envcountsame,envcountsect,runningheads]{llncs}%
\usepackage[dvipsnames]{xcolor}
\usepackage{hyperref}
% \pagestyle{plain}
%   \addtolength{\oddsidemargin}{-.5in}
%   \addtolength{\evensidemargin}{-.5in}
%   \addtolength{\textwidth}{1in}
\hypersetup{
    bookmarks=true,         % show bookmarks bar?
    unicode=false,          % non-Latin characters in Acrobatâ€™s bookmarks
    colorlinks=true,       % false: boxed links; true: colored links
    linkcolor=RoyalPurple,          % color of internal links (change box color with linkbordercolor)
    citecolor=black,
    filecolor=black,
    urlcolor=black,
    hypertexnames=false
}
 \pagestyle{plain}
%   \addtolength{\oddsidemargin}{-1.6in}
%   \addtolength{\evensidemargin}{-1.6in}
%   \addtolength{\textwidth}{3.2in}

\def\topfraction{0.8}

\setcounter{tocdepth}{2}

%\usepackage{savetrees}
\usepackage{xspace}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{latexsym}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{nameref}
%\usepackage{cleveref}
%\usepackage{amsthm}
\usepackage{tikz}
\usetikzlibrary{fit}

\usepackage{verbatim}
\usepackage{enumitem}
\usepackage[probability,adversary,sets,operators,primitives]{cryptocode}[=2018-11-11]
\usepackage{wrapfig}
\usepackage{booktabs}
\usepackage{pdfpages}
\usepackage{enumitem}
\usepackage{multicol}
\usepackage{catchfilebetweentags}
% \usepackage{lipsum}
\usepackage{url}
\usepackage{lscape}
\usepackage{subcaption}
\usepackage{todonotes}
\usepackage{placeins}
\usepackage{rotating}
\usepackage{thm-restate}

\makeatletter
\let\claim\@undefined
\let\endclaim\@undefined
\makeatother
\spnewtheorem{claim}[theorem]{Claim}{\bfseries}{\itshape}

% include code in verbatim
\usepackage{listings}
\lstset{basicstyle=\footnotesize\ttfamily,
breaklines=true,
numbers=left,
tabsize=4,
escapeinside={<@}{@>}}

\let\llncssubparagraph\subparagraph
\let\subparagraph\paragraph
\usepackage{titlesec}
%\let\subparagraph\llncssubparagraph
\let\paragraph\subsubsection
\titlespacing*{\section} {0pt}{3ex plus 1ex minus .2ex}{2.1ex plus .2ex}
\titlespacing*{\subsection} {0pt}{2.75ex plus 1ex minus .2ex}{1.3ex plus .2ex}
\titlespacing*{\subsubsection}{0pt}{1ex plus 1ex minus .2ex}{2mm}

\input{macros}

%\usepackage{ntheorem}
%\theoremstyle{definition}
%\newtheorem{definition}{Definition}[section]
% \newtheorem{remark}{Remark}
%\newtheorem{corollary}{Corollary}
%\newtheorem{conjecture}{Conjecture}
%\newtheorem{construction}{Construction}
%\newtheorem{example}{Example}
%\newtheorem{hint}{Hint}
%\newtheorem{theorem}{Theorem}
%\newtheorem*{lemma*}{Lemma}
%\newtheorem{sublemma}{Lemma}[lemma]
%\newtheorem{myclaim}{Claim}[lemma]

\newcommand\defeq{\mathrel{\overset{\makebox[0pt]{\mbox{\normalfont\tiny\sffamily
def}}}{=}}}
\def\checkmark{\tikz\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) --
  (.25,.15) -- cycle;}

% Submission version
%\newcommand{\workingnotes}[1]{}
%\newcommand{\workingnotes}[1]{\marginpar{\scriptsize{#1}}}
%\newcommand{\workingnotes}[1]{{#1}}

\newcommand{\vcaption}[1]{\vspace{-1ex}\caption{#1}\vspace{-1ex}}
\newcommand{\maxres}{L}
\newcommand{\psk}{\O{psk}}
\newcommand{\afterdeadline}[1]{}
\setuptodonotes{shadow}
\newcommand{\adl}[1]{} %{\todo[color=lightgray]{ADL: #1}}
\newcommand{\cb}[1]{} %{\todo[color=lime]{CB: #1}}
\newcommand{\chris}[1]{} %{\todo[color=lime]{CB: #1}}
\newcommand{\kk}[1]{} %{\todo[color=green!30]{KK: #1}}
\newcommand{\cf}[1]{} %{\todo[color=blue!30]{CF: #1}}
\newcommand{\CF}[1]{} %{\todo[color=blue!30,bordercolor=red]{CF: #1}}
\newcommand{\mk}[1]{\todo[color=red!30]{MK: #1}}
\newcommand{\MK}[1]{\todo[color=red!30,bordercolor=red]{MK: #1}}
\newcommand{\mklight}[1]{}
\renewcommand{\vec}[1]{\ensuremath{\mathbf{#1}}}
\renewcommand\pcthen{:}

\title{Key Exchange to Key Schedule\\Reduction for TLS 1.3}
\author{}\institute{}
%\author{Chris Brzuska\inst{1}, Christoph Egger\inst{2}}
%\institute{
%			 Aalto University, Finland \and FAU Erlangen, Germany
%}

\let\oldprocedure\procedure
\renewcommand\procedure[2][]{\oldprocedure[#1,codesize=\small{}]{\small#2}}


\begin{document}
\maketitle
\vspace{-1.3cm}

\definecolor{kxpink}{RGB}{211,77,122} % D34D7A
\newcommand\pink{\textcolor{kxpink}{pink}}
\definecolor{kxblue}{RGB}{51, 171, 189} % #33abbd
\newcommand\blue{\textcolor{kxblue}{blue}}
\newcommand\gray{\textcolor{gray}{gray}}

\begin{abstract}
The TLS 1.3 Handshake protocol includes features
such as agility, session resumption as well as aggregation of
key material. Due to the complexity which these features introduce
to the key derivations, Brzuska, Delignat-Lavaud, Egger, Fournet, Kohbrok
and Kohlweiss (BDEFKK, ePrint 2021) recently analyzed the TLS 1.3 Key Schedule
using the novel state-separating proof technique (Asiacrypt 2018), capturing
all details of the key schedule. In follow-up work, Brzuska, Cornelissen
and Kohbrok analyzed the MLS key schedule (Security \& Privacy 2022).

Key schedule analysis is appealing, because analyzing a cryptographic
\emph{primitive} is easier than analyzing an interactive protocol. But
does an analysis of the key schedule indeed imply the security of the
overall key exchange protocol?

We answer this question in the affirmative for TLS 1.3. We prove that the 
security of the key exchange reduces to the key schedule via verbose but 
conceptually simple code equivalence steps. As two further conceptual
contributions, we provide a security model for the TLS 1.3 handshake
which supports agility and resumption in a lean way, and we clarify the
properties which the top-level key exchange needs to satisfy, captured
by our class of \emph{TLS-like} key exchange protocols. The concepts
underlying each of the three contributions are applicable to any other
key-schedule based key exchange protocol and thus constitute methodology
that is likely to be useful for the current key exchange design trends.
%
%Naturally, the BDEFKK key schedule analysis begs the question whether key schedule
%security indeed translates into key exchange security of the full protocol. However,
%on paper, such a proof seems infeasible, since capturing all details of TLS 1.3
%seems impossible.%
%
%In this article, we overcome this obstacle by introducing and analysing a class
%of TLS-like key exchange protocols, which, in particular, contain TLS 1.3 as a
%particular instance. We show that the BDEFKK key indistinguishability and key uniqueness
%guarantees carry over to the key exchange, including agility, session resumption
%and aggregation of key material. These features, to date, have not been studied in a
%computational model of security. We sketch how our results compose with
%signature-based authentication and leave composition with ciphersuite negotiation 
%security for further work.
%  Very concrete
\end{abstract}

%\tableofcontents

\input{intro}

\input{technical-overview}

\input{notation}
\input{key-exchange-syntax}
\input{key-schedule-syntax}


\input{theorem-main}
\section{Proof of Main Theorem~\ref{thm:main}}
\label{sec:proof:main}
\begin{proof}
\input{proofofmain}
\end{proof}

\input{theorem-signature}
\input{theorem-datastructure}
\input{theorem-handles}
\newcommand\assertToGlobal\relax
\newcommand\toAssert\relax


\FloatBarrier

\input{theorem-check-intro}
\input{theorem-reduction}


%{\footnotesize
%\bibliography{cryptobib/abbrev3,cryptobib/crypto,misc}{}
\bibliography{abbrev3,cryptobib/crypto,misc}{}
\bibliographystyle{abbrv}
%}
%\clearpage

\begin{center}
\LARGE
---End of submission---\\
---Supplementary material---
\end{center}
%\begin{figure}[htp]
%  \centering
%  \input{prooftree}
%  \caption{Proof Structure}
%  \label{fig:prooftree}
%\end{figure}

\tableofcontents

\clearpage

\appendix

\input{appendix-bilder}
\FloatBarrier
\input{appendix-code}
\FloatBarrier
%\input{appendix-check}
%\input{appendix-properties}
\input{appendix-datastructure}
\input{appendix-handles}
%\input{appendix-modularization}
%\input{appendix-pinkblue}
\input{appendix-checkintro}

%\input{proofofmain}
\input{appendix-key-schedule}

\end{document}
