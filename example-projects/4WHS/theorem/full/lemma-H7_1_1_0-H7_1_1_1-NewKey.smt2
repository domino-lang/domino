

(define-fun <relation-mac-implies-message-H7_1_1_0-H7_1_1_1-NewKey>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (k (Maybe Bits_n))
    )
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H711-return)))
    (let ((game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710)))
      (let ((State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (ReverseMac0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ReverseMac> game-H710)))
        (mac-implies-message ReverseMac0 State0)))))

(define-fun <relation-trivial-equalities-H7_1_1_0-H7_1_1_1-NewKey>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (k (Maybe Bits_n))
    )
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H711-return)))
    (let ((nonces-H710 (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H710))
          (nonces-H711 (<game-H7-<$<!n!>$>-pkgstate-Nonces>  state-H711))
          (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
          (game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
          (game-H710-old (<game-H7-<$<!n!>$>-pkgstate-KX> H710-old))
          (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (game-H711-old (<game-H7-<$<!n!>$>-pkgstate-KX>  H711-old))
          (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H710-old (<game-H7-<$<!n!>$>-pkgstate-PRF> H710-old))
          (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710-old))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
            (First0 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H710))
            (First1 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H711))
            (Second0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H710))
            (Second1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H711))
            (ReverseMac0      (<pkg-state-KX_noprfkey-<$<!n!>$>-ReverseMac> game-H710))
            (ReverseMac1      (<pkg-state-KX_noprfkey-<$<!n!>$>-ReverseMac> game-H711))
            (RevTested0 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710))
            (RevTested0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710-old))
            (RevTested1 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H711))
            (RevTestEval0 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710))
            (RevTestEval0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710-old))
            (RevTestEval1 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711))
            (RevTestEval1-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711-old))
            (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Nonces0 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H710))
            (Nonces1 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H711))
            (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))
            (Values0 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
            (Values1 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
            (kid0     (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid1     (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf0-old (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710-old))
            (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
      (and (= nonces-H710 nonces-H711)
           (= Ltk0 Ltk1)
           (= H0 H1)
           (= kid0 kid1)
           (= ctr0 ctr1)
           (= State0 State1)
           (= RevTested0 RevTested1)
           (= RevTestEval0 RevTestEval1)
           (= Fresh0 Fresh1)
           (= Keys0 Keys1)
           (= Values0 Values1)
           (= First0 First1)
           (= Second0 Second1)
           (= ReverseMac0 ReverseMac1)
           (= Prf0 Prf1))))))


(define-fun <relation-no-overwriting-H7_1_1_0-H7_1_1_1-NewKey>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (k (Maybe Bits_n))
    )
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H711-return)))
    (let ((nonces-H710 (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H710))
          (nonces-H711 (<game-H7-<$<!n!>$>-pkgstate-Nonces>  state-H711))
          (game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
          (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
          (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
            (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Nonces0 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H710))
            (Nonces1 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H711))
            (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))
            (Values0 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
            (Values1 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
            (kid0 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid1 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
        (and (freshness-and-honesty-matches State0 Fresh0 H0)
             (freshness-and-honesty-matches State1 Fresh1 H1)

             (own-nonce-is-unique State0 Nonces0)

             (no-overwriting-prf kid0 Prf0 H0 Keys0 Values0 Ltk0)
             (no-overwriting-prf kid1 Prf1 H1 Keys1 Values1 Ltk1)

             (no-overwriting-game State0 Fresh0 ctr0)
             (no-overwriting-game State1 Fresh1 ctr1))))))


(define-fun <relation-sids-H7_1_1_0-H7_1_1_1-NewKey>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (k (Maybe Bits_n))
    )
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H711-return)))
    (let ((game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
          (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
          (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
            (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))            
            (kid0 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid1 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
        (and (sid-is-wellformed State0 Fresh0 Keys0)
             (sid-matches State0 Fresh0)
             (sids-unique Fresh0 State0)
             )))))

(define-fun <relation-wellformedness-H7_1_1_0-H7_1_1_1-NewKey>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (k (Maybe Bits_n))
    )
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H711-return)))
    (let ((game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
          (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
          (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
            (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))            
            (kid0 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid1 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
        (and (kmac-and-tau-are-computed-correctly State0 H0 Ltk0 Fresh0 Keys0)
             (kmac-and-tau-are-computed-correctly State1 H1 Ltk1 Fresh1 Keys1))))))



(define-fun <relation-time-H7_1_1_0-H7_1_1_1-NewKey>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (k (Maybe Bits_n))
    )
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H711-return)))
    (let ((game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
          (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
          (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
            (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))            
            (kid0 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid1 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
        (and (time-of-acceptance State0)
             (time-of-acceptance State1)

             (stuff-not-initialized-early State0 Fresh0 Keys0))))))



(define-fun <relation-macs-H7_1_1_0-H7_1_1_1-NewKey>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (k (Maybe Bits_n))
    )
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H711-return)))
    (let ((game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
          (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
          (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
            (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))            
            (Values0 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
            (Values1 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
            (kid0 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid1 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
        (and (four-mac-implies-three-mac Values0)
             (three-mac-implies-two-mac Values0)
             (initiator-accepts-with-mac-four-only Values0 Fresh0 State0)
             (responder-accepts-with-mac-three-only Values0 Fresh0 State0)
             (honest-sid-have-tau-in-mac State0 Fresh0 Values0))))))

(define-fun <relation-first-H7_1_1_0-H7_1_1_1-NewKey>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (k (Maybe Bits_n))
    )
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H711-return)))
    (let ((game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
          (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
          (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
            (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (First0 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H710))
            (First1 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H711))
            (Second0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H710))
            (Second1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H711))            
            (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))            
            (Values0 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
            (Values1 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
            (kid0 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid1 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
        (and (sessions-in-first-exist First0 State0)
             (sessions-in-first-exist Second0 State0)

             (second-after-first First0 Second0)
             (first-second-distinct First0 Second0 State0)
             (first-set-by-initiator State0 First0 Fresh0)
             
             (sessions-in-first-second-sufficiently-advanced First0 Fresh0 State0)
             (sessions-in-first-second-sufficiently-advanced Second0 Fresh0 State0))))))

(define-fun <relation-reverse-mac-H7_1_1_0-H7_1_1_1-NewKey>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (k (Maybe Bits_n)))
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H711-return)))
    (let ((game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
          (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
          (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
            (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (First0 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H710))
            (First1 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H711))
            (Second0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H710))
            (Second1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H711))
            (ReverseMac0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ReverseMac> game-H710))
            (ReverseMac1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ReverseMac> game-H711))
            (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))            
            (Values0 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
            (Values1 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
            (kid0 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid1 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
        (and (reverse-mac-matches Values0 ReverseMac0 H0)
             (reverse-mac-state-consistent ReverseMac0 State0))))))
