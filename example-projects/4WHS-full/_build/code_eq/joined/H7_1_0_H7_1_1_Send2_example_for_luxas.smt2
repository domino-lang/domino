; 
; base declarations:
(set-logic ALL)
(declare-sort Bits_m 0)
(declare-sort Bits_n 0)
(declare-sort Bits_256 0)
(declare-datatypes ((Maybe 1)
)
 ((par (T)
 ((mk-some (maybe-get T)
)
 (mk-none)
)
)
)
)
(declare-datatypes ((ReturnValue 1)
)
 ((par (T)
 ((mk-return-value (return-value T)
)
 (mk-abort)
)
)
)
)
(declare-datatypes ((Tuple1 1)
)
 ((par (T1)
 ((mk-tuple1 (el1-1 T1)
)
)
)
)
)
(declare-datatypes ((Tuple2 2)
)
 ((par (T1 T2)
 ((mk-tuple2 (el2-1 T1)
 (el2-2 T2)
)
)
)
)
)
(declare-datatypes ((Tuple3 3)
)
 ((par (T1 T2 T3)
 ((mk-tuple3 (el3-1 T1)
 (el3-2 T2)
 (el3-3 T3)
)
)
)
)
)
(declare-datatypes ((Tuple4 4)
)
 ((par (T1 T2 T3 T4)
 ((mk-tuple4 (el4-1 T1)
 (el4-2 T2)
 (el4-3 T3)
 (el4-4 T4)
)
)
)
)
)
(declare-datatypes ((Tuple5 5)
)
 ((par (T1 T2 T3 T4 T5)
 ((mk-tuple5 (el5-1 T1)
 (el5-2 T2)
 (el5-3 T3)
 (el5-4 T4)
 (el5-5 T5)
)
)
)
)
)
(declare-datatypes ((Tuple6 6)
)
 ((par (T1 T2 T3 T4 T5 T6)
 ((mk-tuple6 (el6-1 T1)
 (el6-2 T2)
 (el6-3 T3)
 (el6-4 T4)
 (el6-5 T5)
 (el6-6 T6)
)
)
)
)
)
(declare-datatypes ((Tuple7 7)
)
 ((par (T1 T2 T3 T4 T5 T6 T7)
 ((mk-tuple7 (el7-1 T1)
 (el7-2 T2)
 (el7-3 T3)
 (el7-4 T4)
 (el7-5 T5)
 (el7-6 T6)
 (el7-7 T7)
)
)
)
)
)
(declare-datatypes ((Tuple8 8)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8)
 ((mk-tuple8 (el8-1 T1)
 (el8-2 T2)
 (el8-3 T3)
 (el8-4 T4)
 (el8-5 T5)
 (el8-6 T6)
 (el8-7 T7)
 (el8-8 T8)
)
)
)
)
)
(declare-datatypes ((Tuple9 9)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9)
 ((mk-tuple9 (el9-1 T1)
 (el9-2 T2)
 (el9-3 T3)
 (el9-4 T4)
 (el9-5 T5)
 (el9-6 T6)
 (el9-7 T7)
 (el9-8 T8)
 (el9-9 T9)
)
)
)
)
)
(declare-datatypes ((Tuple10 10)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10)
 ((mk-tuple10 (el10-1 T1)
 (el10-2 T2)
 (el10-3 T3)
 (el10-4 T4)
 (el10-5 T5)
 (el10-6 T6)
 (el10-7 T7)
 (el10-8 T8)
 (el10-9 T9)
 (el10-10 T10)
)
)
)
)
)
(declare-datatypes ((Tuple11 11)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11)
 ((mk-tuple11 (el11-1 T1)
 (el11-2 T2)
 (el11-3 T3)
 (el11-4 T4)
 (el11-5 T5)
 (el11-6 T6)
 (el11-7 T7)
 (el11-8 T8)
 (el11-9 T9)
 (el11-10 T10)
 (el11-11 T11)
)
)
)
)
)
(declare-datatypes ((Tuple12 12)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12)
 ((mk-tuple12 (el12-1 T1)
 (el12-2 T2)
 (el12-3 T3)
 (el12-4 T4)
 (el12-5 T5)
 (el12-6 T6)
 (el12-7 T7)
 (el12-8 T8)
 (el12-9 T9)
 (el12-10 T10)
 (el12-11 T11)
 (el12-12 T12)
)
)
)
)
)
(declare-datatypes ((Tuple13 13)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13)
 ((mk-tuple13 (el13-1 T1)
 (el13-2 T2)
 (el13-3 T3)
 (el13-4 T4)
 (el13-5 T5)
 (el13-6 T6)
 (el13-7 T7)
 (el13-8 T8)
 (el13-9 T9)
 (el13-10 T10)
 (el13-11 T11)
 (el13-12 T12)
 (el13-13 T13)
)
)
)
)
)
(declare-datatypes ((Tuple14 14)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14)
 ((mk-tuple14 (el14-1 T1)
 (el14-2 T2)
 (el14-3 T3)
 (el14-4 T4)
 (el14-5 T5)
 (el14-6 T6)
 (el14-7 T7)
 (el14-8 T8)
 (el14-9 T9)
 (el14-10 T10)
 (el14-11 T11)
 (el14-12 T12)
 (el14-13 T13)
 (el14-14 T14)
)
)
)
)
)
(declare-datatypes ((Tuple15 15)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15)
 ((mk-tuple15 (el15-1 T1)
 (el15-2 T2)
 (el15-3 T3)
 (el15-4 T4)
 (el15-5 T5)
 (el15-6 T6)
 (el15-7 T7)
 (el15-8 T8)
 (el15-9 T9)
 (el15-10 T10)
 (el15-11 T11)
 (el15-12 T12)
 (el15-13 T13)
 (el15-14 T14)
 (el15-15 T15)
)
)
)
)
)
(declare-datatypes ((Tuple16 16)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16)
 ((mk-tuple16 (el16-1 T1)
 (el16-2 T2)
 (el16-3 T3)
 (el16-4 T4)
 (el16-5 T5)
 (el16-6 T6)
 (el16-7 T7)
 (el16-8 T8)
 (el16-9 T9)
 (el16-10 T10)
 (el16-11 T11)
 (el16-12 T12)
 (el16-13 T13)
 (el16-14 T14)
 (el16-15 T15)
 (el16-16 T16)
)
)
)
)
)
(declare-datatypes ((Tuple17 17)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17)
 ((mk-tuple17 (el17-1 T1)
 (el17-2 T2)
 (el17-3 T3)
 (el17-4 T4)
 (el17-5 T5)
 (el17-6 T6)
 (el17-7 T7)
 (el17-8 T8)
 (el17-9 T9)
 (el17-10 T10)
 (el17-11 T11)
 (el17-12 T12)
 (el17-13 T13)
 (el17-14 T14)
 (el17-15 T15)
 (el17-16 T16)
 (el17-17 T17)
)
)
)
)
)
(declare-datatypes ((Tuple18 18)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18)
 ((mk-tuple18 (el18-1 T1)
 (el18-2 T2)
 (el18-3 T3)
 (el18-4 T4)
 (el18-5 T5)
 (el18-6 T6)
 (el18-7 T7)
 (el18-8 T8)
 (el18-9 T9)
 (el18-10 T10)
 (el18-11 T11)
 (el18-12 T12)
 (el18-13 T13)
 (el18-14 T14)
 (el18-15 T15)
 (el18-16 T16)
 (el18-17 T17)
 (el18-18 T18)
)
)
)
)
)
(declare-datatypes ((Tuple19 19)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19)
 ((mk-tuple19 (el19-1 T1)
 (el19-2 T2)
 (el19-3 T3)
 (el19-4 T4)
 (el19-5 T5)
 (el19-6 T6)
 (el19-7 T7)
 (el19-8 T8)
 (el19-9 T9)
 (el19-10 T10)
 (el19-11 T11)
 (el19-12 T12)
 (el19-13 T13)
 (el19-14 T14)
 (el19-15 T15)
 (el19-16 T16)
 (el19-17 T17)
 (el19-18 T18)
 (el19-19 T19)
)
)
)
)
)
(declare-datatypes ((Tuple20 20)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20)
 ((mk-tuple20 (el20-1 T1)
 (el20-2 T2)
 (el20-3 T3)
 (el20-4 T4)
 (el20-5 T5)
 (el20-6 T6)
 (el20-7 T7)
 (el20-8 T8)
 (el20-9 T9)
 (el20-10 T10)
 (el20-11 T11)
 (el20-12 T12)
 (el20-13 T13)
 (el20-14 T14)
 (el20-15 T15)
 (el20-16 T16)
 (el20-17 T17)
 (el20-18 T18)
 (el20-19 T19)
 (el20-20 T20)
)
)
)
)
)
(declare-datatypes ((Tuple21 21)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20 T21)
 ((mk-tuple21 (el21-1 T1)
 (el21-2 T2)
 (el21-3 T3)
 (el21-4 T4)
 (el21-5 T5)
 (el21-6 T6)
 (el21-7 T7)
 (el21-8 T8)
 (el21-9 T9)
 (el21-10 T10)
 (el21-11 T11)
 (el21-12 T12)
 (el21-13 T13)
 (el21-14 T14)
 (el21-15 T15)
 (el21-16 T16)
 (el21-17 T17)
 (el21-18 T18)
 (el21-19 T19)
 (el21-20 T20)
 (el21-21 T21)
)
)
)
)
)
(declare-datatypes ((Tuple22 22)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20 T21 T22)
 ((mk-tuple22 (el22-1 T1)
 (el22-2 T2)
 (el22-3 T3)
 (el22-4 T4)
 (el22-5 T5)
 (el22-6 T6)
 (el22-7 T7)
 (el22-8 T8)
 (el22-9 T9)
 (el22-10 T10)
 (el22-11 T11)
 (el22-12 T12)
 (el22-13 T13)
 (el22-14 T14)
 (el22-15 T15)
 (el22-16 T16)
 (el22-17 T17)
 (el22-18 T18)
 (el22-19 T19)
 (el22-20 T20)
 (el22-21 T21)
 (el22-22 T22)
)
)
)
)
)
(declare-datatypes ((Tuple23 23)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20 T21 T22 T23)
 ((mk-tuple23 (el23-1 T1)
 (el23-2 T2)
 (el23-3 T3)
 (el23-4 T4)
 (el23-5 T5)
 (el23-6 T6)
 (el23-7 T7)
 (el23-8 T8)
 (el23-9 T9)
 (el23-10 T10)
 (el23-11 T11)
 (el23-12 T12)
 (el23-13 T13)
 (el23-14 T14)
 (el23-15 T15)
 (el23-16 T16)
 (el23-17 T17)
 (el23-18 T18)
 (el23-19 T19)
 (el23-20 T20)
 (el23-21 T21)
 (el23-22 T22)
 (el23-23 T23)
)
)
)
)
)
(declare-datatypes ((Tuple24 24)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20 T21 T22 T23 T24)
 ((mk-tuple24 (el24-1 T1)
 (el24-2 T2)
 (el24-3 T3)
 (el24-4 T4)
 (el24-5 T5)
 (el24-6 T6)
 (el24-7 T7)
 (el24-8 T8)
 (el24-9 T9)
 (el24-10 T10)
 (el24-11 T11)
 (el24-12 T12)
 (el24-13 T13)
 (el24-14 T14)
 (el24-15 T15)
 (el24-16 T16)
 (el24-17 T17)
 (el24-18 T18)
 (el24-19 T19)
 (el24-20 T20)
 (el24-21 T21)
 (el24-22 T22)
 (el24-23 T23)
 (el24-24 T24)
)
)
)
)
)
(declare-datatypes ((Tuple25 25)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20 T21 T22 T23 T24 T25)
 ((mk-tuple25 (el25-1 T1)
 (el25-2 T2)
 (el25-3 T3)
 (el25-4 T4)
 (el25-5 T5)
 (el25-6 T6)
 (el25-7 T7)
 (el25-8 T8)
 (el25-9 T9)
 (el25-10 T10)
 (el25-11 T11)
 (el25-12 T12)
 (el25-13 T13)
 (el25-14 T14)
 (el25-15 T15)
 (el25-16 T16)
 (el25-17 T17)
 (el25-18 T18)
 (el25-19 T19)
 (el25-20 T20)
 (el25-21 T21)
 (el25-22 T22)
 (el25-23 T23)
 (el25-24 T24)
 (el25-25 T25)
)
)
)
)
)
(declare-datatypes ((Tuple26 26)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20 T21 T22 T23 T24 T25 T26)
 ((mk-tuple26 (el26-1 T1)
 (el26-2 T2)
 (el26-3 T3)
 (el26-4 T4)
 (el26-5 T5)
 (el26-6 T6)
 (el26-7 T7)
 (el26-8 T8)
 (el26-9 T9)
 (el26-10 T10)
 (el26-11 T11)
 (el26-12 T12)
 (el26-13 T13)
 (el26-14 T14)
 (el26-15 T15)
 (el26-16 T16)
 (el26-17 T17)
 (el26-18 T18)
 (el26-19 T19)
 (el26-20 T20)
 (el26-21 T21)
 (el26-22 T22)
 (el26-23 T23)
 (el26-24 T24)
 (el26-25 T25)
 (el26-26 T26)
)
)
)
)
)
(declare-datatypes ((Tuple27 27)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20 T21 T22 T23 T24 T25 T26 T27)
 ((mk-tuple27 (el27-1 T1)
 (el27-2 T2)
 (el27-3 T3)
 (el27-4 T4)
 (el27-5 T5)
 (el27-6 T6)
 (el27-7 T7)
 (el27-8 T8)
 (el27-9 T9)
 (el27-10 T10)
 (el27-11 T11)
 (el27-12 T12)
 (el27-13 T13)
 (el27-14 T14)
 (el27-15 T15)
 (el27-16 T16)
 (el27-17 T17)
 (el27-18 T18)
 (el27-19 T19)
 (el27-20 T20)
 (el27-21 T21)
 (el27-22 T22)
 (el27-23 T23)
 (el27-24 T24)
 (el27-25 T25)
 (el27-26 T26)
 (el27-27 T27)
)
)
)
)
)
(declare-datatypes ((Tuple28 28)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20 T21 T22 T23 T24 T25 T26 T27 T28)
 ((mk-tuple28 (el28-1 T1)
 (el28-2 T2)
 (el28-3 T3)
 (el28-4 T4)
 (el28-5 T5)
 (el28-6 T6)
 (el28-7 T7)
 (el28-8 T8)
 (el28-9 T9)
 (el28-10 T10)
 (el28-11 T11)
 (el28-12 T12)
 (el28-13 T13)
 (el28-14 T14)
 (el28-15 T15)
 (el28-16 T16)
 (el28-17 T17)
 (el28-18 T18)
 (el28-19 T19)
 (el28-20 T20)
 (el28-21 T21)
 (el28-22 T22)
 (el28-23 T23)
 (el28-24 T24)
 (el28-25 T25)
 (el28-26 T26)
 (el28-27 T27)
 (el28-28 T28)
)
)
)
)
)
(declare-datatypes ((Tuple29 29)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20 T21 T22 T23 T24 T25 T26 T27 T28 T29)
 ((mk-tuple29 (el29-1 T1)
 (el29-2 T2)
 (el29-3 T3)
 (el29-4 T4)
 (el29-5 T5)
 (el29-6 T6)
 (el29-7 T7)
 (el29-8 T8)
 (el29-9 T9)
 (el29-10 T10)
 (el29-11 T11)
 (el29-12 T12)
 (el29-13 T13)
 (el29-14 T14)
 (el29-15 T15)
 (el29-16 T16)
 (el29-17 T17)
 (el29-18 T18)
 (el29-19 T19)
 (el29-20 T20)
 (el29-21 T21)
 (el29-22 T22)
 (el29-23 T23)
 (el29-24 T24)
 (el29-25 T25)
 (el29-26 T26)
 (el29-27 T27)
 (el29-28 T28)
 (el29-29 T29)
)
)
)
)
)
(declare-datatypes ((Tuple30 30)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20 T21 T22 T23 T24 T25 T26 T27 T28 T29 T30)
 ((mk-tuple30 (el30-1 T1)
 (el30-2 T2)
 (el30-3 T3)
 (el30-4 T4)
 (el30-5 T5)
 (el30-6 T6)
 (el30-7 T7)
 (el30-8 T8)
 (el30-9 T9)
 (el30-10 T10)
 (el30-11 T11)
 (el30-12 T12)
 (el30-13 T13)
 (el30-14 T14)
 (el30-15 T15)
 (el30-16 T16)
 (el30-17 T17)
 (el30-18 T18)
 (el30-19 T19)
 (el30-20 T20)
 (el30-21 T21)
 (el30-22 T22)
 (el30-23 T23)
 (el30-24 T24)
 (el30-25 T25)
 (el30-26 T26)
 (el30-27 T27)
 (el30-28 T28)
 (el30-29 T29)
 (el30-30 T30)
)
)
)
)
)
(declare-datatypes ((Tuple31 31)
)
 ((par (T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 T16 T17 T18 T19 T20 T21 T22 T23 T24 T25 T26 T27 T28 T29 T30 T31)
 ((mk-tuple31 (el31-1 T1)
 (el31-2 T2)
 (el31-3 T3)
 (el31-4 T4)
 (el31-5 T5)
 (el31-6 T6)
 (el31-7 T7)
 (el31-8 T8)
 (el31-9 T9)
 (el31-10 T10)
 (el31-11 T11)
 (el31-12 T12)
 (el31-13 T13)
 (el31-14 T14)
 (el31-15 T15)
 (el31-16 T16)
 (el31-17 T17)
 (el31-18 T18)
 (el31-19 T19)
 (el31-20 T20)
 (el31-21 T21)
 (el31-22 T22)
 (el31-23 T23)
 (el31-24 T24)
 (el31-25 T25)
 (el31-26 T26)
 (el31-27 T27)
 (el31-28 T28)
 (el31-29 T29)
 (el31-30 T30)
 (el31-31 T31)
)
)
)
)
)
(declare-datatype Empty ((mk-empty)
)
)
(declare-datatype SampleId ((sample-id (sample-pkg-name String)
 (sample-oracle-name String)
 (sample-name String)
)
)
)
; 
; theorem param funcs:
(declare-fun <<func-mac>> (Bits_256 Bits_256 Int)
 Bits_256)
(declare-fun <<func-prf>> (Bits_256 Int Int Bits_256 Bits_256 Bool)
 Bits_256)
; 
; game definitions:
(declare-fun __sample-rand-H7_1_0-Bits_256 (SampleId Int)
 Bits_256)
(declare-fun __sample-rand-H7_1_1-Bits_256 (SampleId Int)
 Bits_256)
(declare-datatype <PackageConsts_PRF> ((<mk-pkg-consts-PRF> (<pkg-consts-PRF-n> Int)
 (<pkg-consts-PRF-b> Bool)
)
)
)
(declare-datatype <PackageConsts_MAC> ((<mk-pkg-consts-MAC> (<pkg-consts-MAC-n> Int)
 (<pkg-consts-MAC-b> Bool)
)
)
)
(declare-datatype <PackageConsts_Nonces> ((<mk-pkg-consts-Nonces> (<pkg-consts-Nonces-n> Int)
 (<pkg-consts-Nonces-b> Bool)
)
)
)
(declare-datatype <PackageConsts_ReductionMac> ((<mk-pkg-consts-ReductionMac> (<pkg-consts-ReductionMac-n> Int)
 (<pkg-consts-ReductionMac-zeron> Bits_256)
)
)
)
(declare-datatype <PackageConsts_KX_noprfkey> ((<mk-pkg-consts-KX_noprfkey> (<pkg-consts-KX_noprfkey-b> Bool)
 (<pkg-consts-KX_noprfkey-n> Int)
 (<pkg-consts-KX_noprfkey-zeron> Bits_256)
)
)
)
(declare-datatype <PackageState_PRF_<$<!n!>$>> ((<mk-pkg-state-PRF-<$<!n!>$>> (<pkg-state-PRF-<$<!n!>$>-LTK> (Array Int (Maybe Bits_256)
)
)
 (<pkg-state-PRF-<$<!n!>$>-H> (Array Int (Maybe Bool)
)
)
 (<pkg-state-PRF-<$<!n!>$>-PRF> (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool)
 (Maybe Bits_256)
)
)
 (<pkg-state-PRF-<$<!n!>$>-kid_> Int)
)
)
)
(declare-datatype <PackageState_MAC_<$<!n!>$>> ((<mk-pkg-state-MAC-<$<!n!>$>> (<pkg-state-MAC-<$<!n!>$>-Keys> (Array (Tuple5 Int Int Int Bits_256 Bits_256)
 (Maybe Bits_256)
)
)
 (<pkg-state-MAC-<$<!n!>$>-Values> (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256)
 (Tuple2 Bits_256 Int)
)
 (Maybe Bits_256)
)
)
)
)
)
(declare-datatype <PackageState_Nonces_<$<!n!>$>> ((<mk-pkg-state-Nonces-<$<!n!>$>> (<pkg-state-Nonces-<$<!n!>$>-Nonces> (Array Bits_256 (Maybe Bool)
)
)
)
)
)
(declare-datatype <PackageState_ReductionMac_<$<!n!>$>> ((<mk-pkg-state-ReductionMac-<$<!n!>$>>)
)
)
(declare-datatype <PackageState_KX_noprfkey_<$<!n!>$>> ((<mk-pkg-state-KX_noprfkey-<$<!n!>$>> (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> Int)
 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
 (Maybe Bool)
)
)
 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (Array Int (Maybe Bool)
)
)
 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (Array (Tuple5 Int Int Int Bits_256 Bits_256)
 (Maybe Int)
)
)
 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
 (Maybe Int)
)
)
 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
 (Maybe Int)
)
)
 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
)
)
)
(declare-datatype <TheoremConsts_WHSProto> ((<mk-theorem-consts-WHSProto> (<theorem-consts-WHSProto-b> Bool)
 (<theorem-consts-WHSProto-m> Int)
 (<theorem-consts-WHSProto-n> Int)
 (<theorem-consts-WHSProto-zeron> Bits_256)
)
)
)
(declare-datatype <GameConsts_H7> ((<mk-game-consts-H7> (<game-consts-H7-b> Bool)
 (<game-consts-H7-bmac> Bool)
 (<game-consts-H7-n> Int)
 (<game-consts-H7-zeron> Bits_256)
)
)
)
(declare-datatype <GameState_H7_<$<!n!>$>> ((<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <PackageState_PRF_<$<!n!>$>>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <PackageState_MAC_<$<!n!>$>>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <PackageState_Nonces_<$<!n!>$>>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <PackageState_ReductionMac_<$<!n!>$>>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <PackageState_KX_noprfkey_<$<!n!>$>>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> Int)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> Int)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> Int)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> Int)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> Int)
)
)
)
(define-fun <gameconsts-WHSProto-H7_1_0> ((<theorem-consts> <TheoremConsts_WHSProto>)
)
 <GameConsts_H7> (let ((b (<theorem-consts-WHSProto-b> <theorem-consts>)
)
 (m (<theorem-consts-WHSProto-m> <theorem-consts>)
)
 (n (<theorem-consts-WHSProto-n> <theorem-consts>)
)
 (zeron (<theorem-consts-WHSProto-zeron> <theorem-consts>)
)
)
 (<mk-game-consts-H7> false true n zeron)
)
)
(define-fun <gameconsts-WHSProto-H7_1_1> ((<theorem-consts> <TheoremConsts_WHSProto>)
)
 <GameConsts_H7> (let ((b (<theorem-consts-WHSProto-b> <theorem-consts>)
)
 (m (<theorem-consts-WHSProto-m> <theorem-consts>)
)
 (n (<theorem-consts-WHSProto-n> <theorem-consts>)
)
 (zeron (<theorem-consts-WHSProto-zeron> <theorem-consts>)
)
)
 (<mk-game-consts-H7> true true n zeron)
)
)
(define-fun <pkgconsts-H7-PRF> ((<game-consts> <GameConsts_H7>)
)
 <PackageConsts_PRF> (let ((b (<game-consts-H7-b> <game-consts>)
)
 (bmac (<game-consts-H7-bmac> <game-consts>)
)
 (n (<game-consts-H7-n> <game-consts>)
)
 (zeron (<game-consts-H7-zeron> <game-consts>)
)
)
 (<mk-pkg-consts-PRF> n true)
)
)
(define-fun <pkgconsts-H7-MAC> ((<game-consts> <GameConsts_H7>)
)
 <PackageConsts_MAC> (let ((b (<game-consts-H7-b> <game-consts>)
)
 (bmac (<game-consts-H7-bmac> <game-consts>)
)
 (n (<game-consts-H7-n> <game-consts>)
)
 (zeron (<game-consts-H7-zeron> <game-consts>)
)
)
 (<mk-pkg-consts-MAC> n bmac)
)
)
(define-fun <pkgconsts-H7-Nonces> ((<game-consts> <GameConsts_H7>)
)
 <PackageConsts_Nonces> (let ((b (<game-consts-H7-b> <game-consts>)
)
 (bmac (<game-consts-H7-bmac> <game-consts>)
)
 (n (<game-consts-H7-n> <game-consts>)
)
 (zeron (<game-consts-H7-zeron> <game-consts>)
)
)
 (<mk-pkg-consts-Nonces> n true)
)
)
(define-fun <pkgconsts-H7-Prot> ((<game-consts> <GameConsts_H7>)
)
 <PackageConsts_ReductionMac> (let ((b (<game-consts-H7-b> <game-consts>)
)
 (bmac (<game-consts-H7-bmac> <game-consts>)
)
 (n (<game-consts-H7-n> <game-consts>)
)
 (zeron (<game-consts-H7-zeron> <game-consts>)
)
)
 (<mk-pkg-consts-ReductionMac> n zeron)
)
)
(define-fun <pkgconsts-H7-KX> ((<game-consts> <GameConsts_H7>)
)
 <PackageConsts_KX_noprfkey> (let ((b (<game-consts-H7-b> <game-consts>)
)
 (bmac (<game-consts-H7-bmac> <game-consts>)
)
 (n (<game-consts-H7-n> <game-consts>)
)
 (zeron (<game-consts-H7-zeron> <game-consts>)
)
)
 (<mk-pkg-consts-KX_noprfkey> b n zeron)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey> ((<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> (ReturnValue Int)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_Eval> ((<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> (ReturnValue Bits_256)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_Hon> ((<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> (ReturnValue Bool)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_MAC_<$<!n!>$>_Init> ((<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-return-value-or-abort> (ReturnValue Empty)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_MAC_<$<!n!>$>_Mac> ((<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> (ReturnValue Bits_256)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_MAC_<$<!n!>$>_Verify> ((<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> (ReturnValue Bool)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_Nonces_<$<!n!>$>_Sample> ((<mk-oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample> (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-return-value-or-abort> (ReturnValue Bits_256)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run1> ((<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1-return-value-or-abort> (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run2> ((<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2-return-value-or-abort> (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run3> ((<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3-return-value-or-abort> (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run4> ((<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4-return-value-or-abort> (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run5> ((<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5-return-value-or-abort> (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_NewSession> ((<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-NewSession> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-NewSession-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-NewSession-return-value-or-abort> (ReturnValue Int)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send1> ((<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1-return-value-or-abort> (ReturnValue (Tuple1 Bits_256)
)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2> ((<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send3> ((<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3-return-value-or-abort> (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send4> ((<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4-return-value-or-abort> (ReturnValue (Tuple1 Bits_256)
)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send5> ((<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5-return-value-or-abort> (ReturnValue (Tuple1 Bool)
)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Reveal> ((<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal-return-value-or-abort> (ReturnValue Bits_256)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Test> ((<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test-return-value-or-abort> (ReturnValue Bits_256)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_SameKey> ((<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey-return-value-or-abort> (ReturnValue Bool)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtMost> ((<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost-return-value-or-abort> (ReturnValue Bool)
)
)
)
)
(declare-datatype <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtLeast> ((<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast-game-state> <GameState_H7_<$<!n!>$>>)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast-return-value-or-abort> (ReturnValue Bool)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-NewKey> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ltk (Maybe Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey> (let ((LTK (<pkg-state-PRF-<$<!n!>$>-LTK> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (H (<pkg-state-PRF-<$<!n!>$>-H> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (PRF (<pkg-state-PRF-<$<!n!>$>-PRF> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (kid_ (<pkg-state-PRF-<$<!n!>$>-kid_> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
)
 (let ((n (<pkg-consts-PRF-n> (<pkgconsts-H7-PRF> <game-consts>)
)
)
 (b (<pkg-consts-PRF-b> (<pkgconsts-H7-PRF> <game-consts>)
)
)
)
 (let ((kid_ (+ kid_ 1)
)
)
 (ite (= ltk (as mk-none (Maybe Bits_256)
)
)
 (let ((ltk_ (__sample-rand-H7_1_0-Bits_256 (sample-id "PRF" "NewKey" "1")
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (+ 1 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (let ((LTK (store LTK kid_ (mk-some ltk_)
)
)
)
 (let ((H (store H kid_ (mk-some true)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value kid_)
)
)
)
)
)
 (let ((LTK (store LTK kid_ ltk)
)
)
 (let ((H (store H kid_ (mk-some false)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value kid_)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-Eval> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (kid Int)
 (U Int)
 (V Int)
 (ni Bits_256)
 (nr Bits_256)
 (bit Bool)
)
 <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_Eval> (let ((LTK (<pkg-state-PRF-<$<!n!>$>-LTK> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (H (<pkg-state-PRF-<$<!n!>$>-H> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (PRF (<pkg-state-PRF-<$<!n!>$>-PRF> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (kid_ (<pkg-state-PRF-<$<!n!>$>-kid_> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
)
 (let ((n (<pkg-consts-PRF-n> (<pkgconsts-H7-PRF> <game-consts>)
)
)
 (b (<pkg-consts-PRF-b> (<pkgconsts-H7-PRF> <game-consts>)
)
)
)
 (ite (not (= (select LTK kid)
 (as mk-none (Maybe Bits_256)
)
)
)
 (ite (or (= (select H kid)
 (mk-some false)
)
 (not b)
)
 (ite (= (select LTK kid)
 (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-1> (maybe-get (select LTK kid)
)
)
)
 (let ((k <unwrap-1>)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (<<func-prf>> k U V ni nr bit)
)
)
)
)
)
 (ite (= (select PRF (mk-tuple6 kid U V ni nr bit)
)
 (as mk-none (Maybe Bits_256)
)
)
 (let ((temp (__sample-rand-H7_1_0-Bits_256 (sample-id "PRF" "Eval" "1")
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (+ 1 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (let ((PRF (store PRF (mk-tuple6 kid U V ni nr bit)
 (mk-some temp)
)
)
)
 (let ((y (select PRF (mk-tuple6 kid U V ni nr bit)
)
)
)
 (ite (= y (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-2> (maybe-get y)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value <unwrap-2>)
)
)
)
)
)
)
)
 (let ((y (select PRF (mk-tuple6 kid U V ni nr bit)
)
)
)
 (ite (= y (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-2> (maybe-get y)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value <unwrap-2>)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-Hon> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (kid Int)
)
 <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_Hon> (let ((LTK (<pkg-state-PRF-<$<!n!>$>-LTK> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (H (<pkg-state-PRF-<$<!n!>$>-H> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (PRF (<pkg-state-PRF-<$<!n!>$>-PRF> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (kid_ (<pkg-state-PRF-<$<!n!>$>-kid_> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
)
 (let ((n (<pkg-consts-PRF-n> (<pkgconsts-H7-PRF> <game-consts>)
)
)
 (b (<pkg-consts-PRF-b> (<pkgconsts-H7-PRF> <game-consts>)
)
)
)
 (ite (not (= (select H kid)
 (as mk-none (Maybe Bool)
)
)
)
 (ite (= (select H kid)
 (as mk-none (Maybe Bool)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-1> (maybe-get (select H kid)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value <unwrap-1>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon> <game-state> (as mk-abort (ReturnValue Bool)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Init> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (handle (Tuple5 Int Int Int Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_MAC_<$<!n!>$>_Init> (let ((Keys (<pkg-state-MAC-<$<!n!>$>-Keys> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
 (Values (<pkg-state-MAC-<$<!n!>$>-Values> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
)
 (let ((n (<pkg-consts-MAC-n> (<pkgconsts-H7-MAC> <game-consts>)
)
)
 (b (<pkg-consts-MAC-b> (<pkgconsts-H7-MAC> <game-consts>)
)
)
)
 (ite (= (select Keys handle)
 (as mk-none (Maybe Bits_256)
)
)
 (let ((key (__sample-rand-H7_1_0-Bits_256 (sample-id "MAC" "Init" "1")
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (+ 1 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (let ((Keys (store Keys handle (mk-some key)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value mk-empty)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value mk-empty)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Mac> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (handle (Tuple5 Int Int Int Bits_256 Bits_256)
)
 (value (Tuple2 Bits_256 Int)
)
)
 <OracleReturn_H7_<$<!n!>$>_MAC_<$<!n!>$>_Mac> (let ((Keys (<pkg-state-MAC-<$<!n!>$>-Keys> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
 (Values (<pkg-state-MAC-<$<!n!>$>-Values> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
)
 (let ((n (<pkg-consts-MAC-n> (<pkgconsts-H7-MAC> <game-consts>)
)
)
 (b (<pkg-consts-MAC-b> (<pkgconsts-H7-MAC> <game-consts>)
)
)
)
 (let ((key (select Keys handle)
)
)
 (ite (not (= key (as mk-none (Maybe Bits_256)
)
)
)
 (let ((val1 (el2-1 value)
)
 (val2 (el2-2 value)
)
)
 (ite (= key (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-1> (maybe-get key)
)
)
 (let ((tag (<<func-mac>> <unwrap-1> val1 val2)
)
)
 (let ((Values (store Values (mk-tuple2 handle value)
 (mk-some tag)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value tag)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Verify> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (handle (Tuple5 Int Int Int Bits_256 Bits_256)
)
 (value (Tuple2 Bits_256 Int)
)
 (tag Bits_256)
)
 <OracleReturn_H7_<$<!n!>$>_MAC_<$<!n!>$>_Verify> (let ((Keys (<pkg-state-MAC-<$<!n!>$>-Keys> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
 (Values (<pkg-state-MAC-<$<!n!>$>-Values> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
)
 (let ((n (<pkg-consts-MAC-n> (<pkgconsts-H7-MAC> <game-consts>)
)
)
 (b (<pkg-consts-MAC-b> (<pkgconsts-H7-MAC> <game-consts>)
)
)
)
 (let ((key (select Keys handle)
)
)
 (ite (not (= key (as mk-none (Maybe Bits_256)
)
)
)
 (ite b (let ((entry (select Values (mk-tuple2 handle value)
)
)
)
 (ite (= entry (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
 (ite (= entry (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-1> (maybe-get entry)
)
)
 (ite (not (= <unwrap-1> tag)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value true)
)
)
)
)
)
)
 (let ((val1 (el2-1 value)
)
 (val2 (el2-2 value)
)
)
 (ite (= key (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-2> (maybe-get key)
)
)
 (let ((tag_ (<<func-mac>> <unwrap-2> val1 val2)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (= tag tag_)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> <game-state> (as mk-abort (ReturnValue Bool)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-Nonces-Nonces-<$<!n!>$>-Sample> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
)
 <OracleReturn_H7_<$<!n!>$>_Nonces_<$<!n!>$>_Sample> (let ((Nonces (<pkg-state-Nonces-<$<!n!>$>-Nonces> (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
)
)
)
 (let ((n (<pkg-consts-Nonces-n> (<pkgconsts-H7-Nonces> <game-consts>)
)
)
 (b (<pkg-consts-Nonces-b> (<pkgconsts-H7-Nonces> <game-consts>)
)
)
)
 (let ((ni (__sample-rand-H7_1_0-Bits_256 (sample-id "Nonces" "Sample" "1")
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (+ 1 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (ite b (ite (= (select Nonces ni)
 (as mk-none (Maybe Bool)
)
)
 (let ((Nonces (store Nonces ni (mk-some true)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<mk-pkg-state-Nonces-<$<!n!>$>> Nonces)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value ni)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<mk-pkg-state-Nonces-<$<!n!>$>> Nonces)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<mk-pkg-state-Nonces-<$<!n!>$>> Nonces)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value ni)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run1> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (state (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
 <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run1> (let ((n (<pkg-consts-ReductionMac-n> (<pkgconsts-H7-Prot> <game-consts>)
)
)
 (zeron (<pkg-consts-ReductionMac-zeron> (<pkgconsts-H7-Prot> <game-consts>)
)
)
)
 (let ((U (el11-1 state)
)
 (u (el11-2 state)
)
 (V (el11-3 state)
)
 (kid (el11-4 state)
)
 (acc (el11-5 state)
)
 (k (el11-6 state)
)
 (ni_ (el11-7 state)
)
 (nr (el11-8 state)
)
 (kmac (el11-9 state)
)
 (sid (el11-10 state)
)
 (mess (el11-11 state)
)
)
 (ite (= acc (as mk-none (Maybe Bool)
)
)
 (ite (= mess 0)
 (ite (= u false)
 (let ((__ret (<oracle-H7-H7_1_0-Nonces-Nonces-<$<!n!>$>-Sample> <game-state> <game-consts>)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-game-state> __ret)
)
 (ni (return-value (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-return-value-or-abort> __ret)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 k (mk-some ni)
 nr kmac sid 1)
 (mk-tuple1 ni)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run2> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (state (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
 (ni Bits_256)
)
 <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run2> (let ((n (<pkg-consts-ReductionMac-n> (<pkgconsts-H7-Prot> <game-consts>)
)
)
 (zeron (<pkg-consts-ReductionMac-zeron> (<pkgconsts-H7-Prot> <game-consts>)
)
)
)
 (let ((U (el11-1 state)
)
 (v (el11-2 state)
)
 (V (el11-3 state)
)
 (kid (el11-4 state)
)
 (acc (el11-5 state)
)
 (k_ (el11-6 state)
)
 (ni_ (el11-7 state)
)
 (nr_ (el11-8 state)
)
 (kmac__ (el11-9 state)
)
 (sid_ (el11-10 state)
)
 (mess (el11-11 state)
)
)
 (ite (= acc (as mk-none (Maybe Bool)
)
)
 (ite (= mess 0)
 (ite (= v true)
 (let ((__ret (<oracle-H7-H7_1_0-Nonces-Nonces-<$<!n!>$>-Sample> <game-state> <game-consts>)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-game-state> __ret)
)
 (nr (return-value (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-return-value-or-abort> __ret)
)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-Hon> <game-state> <game-consts> kid)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
 (hon (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
)
)
)
 (ite hon (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Init> <game-state> <game-consts> (mk-tuple5 kid U V ni nr)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Empty)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-game-state> __ret)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V ni nr)
 (mk-tuple2 nr 2)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (let ((kmac (as mk-none (Maybe Bits_256)
)
)
)
 (let ((sid (mk-tuple5 U V ni nr tau)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 (mk-some ni)
 (mk-some nr)
 kmac (mk-some sid)
 1)
 (mk-tuple2 nr tau)
)
)
)
)
)
)
)
)
)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-Eval> <game-state> <game-consts> kid U V ni nr false)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
 (kmac_ (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
)
)
)
 (let ((tau (<<func-mac>> kmac_ nr 2)
)
)
 (let ((kmac (mk-some kmac_)
)
)
 (let ((sid (mk-tuple5 U V ni nr tau)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 (mk-some ni)
 (mk-some nr)
 kmac (mk-some sid)
 1)
 (mk-tuple2 nr tau)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run3> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (state (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
 (msg (Tuple2 Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run3> (let ((n (<pkg-consts-ReductionMac-n> (<pkgconsts-H7-Prot> <game-consts>)
)
)
 (zeron (<pkg-consts-ReductionMac-zeron> (<pkgconsts-H7-Prot> <game-consts>)
)
)
)
 (let ((U (el11-1 state)
)
 (u (el11-2 state)
)
 (V (el11-3 state)
)
 (kid (el11-4 state)
)
 (acc (el11-5 state)
)
 (k_ (el11-6 state)
)
 (ni (el11-7 state)
)
 (nr_ (el11-8 state)
)
 (kmac__ (el11-9 state)
)
 (sid_ (el11-10 state)
)
 (mess (el11-11 state)
)
)
 (ite (= mess 1)
 (ite (= acc (as mk-none (Maybe Bool)
)
)
 (ite (= u false)
 (let ((nr (el2-1 msg)
)
 (tau (el2-2 msg)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-Hon> <game-state> <game-consts> kid)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
 (hon (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
)
)
)
 (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-1> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Init> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-1> nr)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Empty)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-game-state> __ret)
)
)
 (let ((kmac (as mk-none (Maybe Bits_256)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-3> (maybe-get ni)
)
)
 (let ((sid (mk-tuple5 U V <unwrap-3> nr tau)
)
)
 (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-4> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Verify> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-4> nr)
 (mk-tuple2 nr 2)
 tau)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
 (verified (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
)
)
)
 (ite verified (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get ni)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-6> nr)
 (mk-tuple2 <unwrap-7> 3)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-8> (maybe-get kmac)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-9> (maybe-get ni)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-8> <unwrap-9> 3)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple2 zeron zeron)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-5> (maybe-get kmac)
)
)
 (let ((verified (= (<<func-mac>> <unwrap-5> nr 2)
 tau)
)
)
 (ite verified (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get ni)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-6> nr)
 (mk-tuple2 <unwrap-7> 3)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-8> (maybe-get kmac)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-9> (maybe-get ni)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-8> <unwrap-9> 3)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple2 zeron zeron)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-2> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-Eval> <game-state> <game-consts> kid U V <unwrap-2> nr false)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
 (kmac_ (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
)
)
)
 (let ((kmac (mk-some kmac_)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-3> (maybe-get ni)
)
)
 (let ((sid (mk-tuple5 U V <unwrap-3> nr tau)
)
)
 (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-4> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Verify> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-4> nr)
 (mk-tuple2 nr 2)
 tau)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
 (verified (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
)
)
)
 (ite verified (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get ni)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-6> nr)
 (mk-tuple2 <unwrap-7> 3)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-8> (maybe-get kmac)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-9> (maybe-get ni)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-8> <unwrap-9> 3)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple2 zeron zeron)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-5> (maybe-get kmac)
)
)
 (let ((verified (= (<<func-mac>> <unwrap-5> nr 2)
 tau)
)
)
 (ite verified (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get ni)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-6> nr)
 (mk-tuple2 <unwrap-7> 3)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-8> (maybe-get kmac)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-9> (maybe-get ni)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-8> <unwrap-9> 3)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple2 zeron zeron)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run4> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (state (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
 (msg (Tuple2 Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run4> (let ((n (<pkg-consts-ReductionMac-n> (<pkgconsts-H7-Prot> <game-consts>)
)
)
 (zeron (<pkg-consts-ReductionMac-zeron> (<pkgconsts-H7-Prot> <game-consts>)
)
)
)
 (let ((U (el11-1 state)
)
 (v (el11-2 state)
)
 (V (el11-3 state)
)
 (kid (el11-4 state)
)
 (acc (el11-5 state)
)
 (k (el11-6 state)
)
 (ni_ (el11-7 state)
)
 (nr (el11-8 state)
)
 (kmac (el11-9 state)
)
 (sid (el11-10 state)
)
 (mess (el11-11 state)
)
)
 (ite (= acc (as mk-none (Maybe Bool)
)
)
 (ite (= mess 1)
 (ite (= v true)
 (let ((ni (el2-1 msg)
)
 (tau (el2-2 msg)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-Hon> <game-state> <game-consts> kid)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
 (hon (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
)
)
)
 (ite hon (ite (= ni_ (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-1> (maybe-get ni_)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-2> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Verify> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-1> <unwrap-2>)
 (mk-tuple2 ni 3)
 tau)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
 (verified (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
)
)
)
 (ite (= ni_ (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-4> (maybe-get ni_)
)
)
 (ite (and verified (= ni <unwrap-4>)
)
 (let ((acc (mk-some true)
)
)
 (ite hon (ite (= ni_ (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-5> (maybe-get ni_)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-5> <unwrap-6>)
 (mk-tuple2 zeron 4)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 tau_new)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get kmac)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-7> zeron 4)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 tau_new)
)
)
)
)
)
)
)
)
 (let ((acc (mk-some false)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 zeron)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-3> (maybe-get kmac)
)
)
 (let ((verified (= (<<func-mac>> <unwrap-3> ni 3)
 tau)
)
)
 (ite (= ni_ (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-4> (maybe-get ni_)
)
)
 (ite (and verified (= ni <unwrap-4>)
)
 (let ((acc (mk-some true)
)
)
 (ite hon (ite (= ni_ (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-5> (maybe-get ni_)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-5> <unwrap-6>)
 (mk-tuple2 zeron 4)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 tau_new)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get kmac)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-7> zeron 4)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 tau_new)
)
)
)
)
)
)
)
)
 (let ((acc (mk-some false)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 zeron)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run5> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (state (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
 (tau Bits_256)
)
 <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run5> (let ((n (<pkg-consts-ReductionMac-n> (<pkgconsts-H7-Prot> <game-consts>)
)
)
 (zeron (<pkg-consts-ReductionMac-zeron> (<pkgconsts-H7-Prot> <game-consts>)
)
)
)
 (let ((U (el11-1 state)
)
 (u (el11-2 state)
)
 (V (el11-3 state)
)
 (kid (el11-4 state)
)
 (acc (el11-5 state)
)
 (k (el11-6 state)
)
 (ni (el11-7 state)
)
 (nr (el11-8 state)
)
 (kmac (el11-9 state)
)
 (sid (el11-10 state)
)
 (mess (el11-11 state)
)
)
 (ite (= acc (as mk-none (Maybe Bool)
)
)
 (ite (= mess 2)
 (ite (= u false)
 (let ((__ret (<oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-Hon> <game-state> <game-consts> kid)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
 (hon (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
)
)
)
 (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
 (let ((<unwrap-1> (maybe-get ni)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
 (let ((<unwrap-2> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-MAC-MAC-<$<!mac!><!n!>$>-Verify> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-1> <unwrap-2>)
 (mk-tuple2 zeron 4)
 tau)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
 (verified (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
)
)
)
 (ite verified (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (mk-some true)
 k ni nr kmac sid 3)
 (mk-tuple1 true)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple1 false)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
 (let ((<unwrap-3> (maybe-get kmac)
)
)
 (let ((verified (= (<<func-mac>> <unwrap-3> zeron 4)
 tau)
)
)
 (ite verified (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (mk-some true)
 k ni nr kmac sid 3)
 (mk-tuple1 true)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple1 false)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-NewSession> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (U Int)
 (u Bool)
 (V Int)
 (kid Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_NewSession> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (let ((ctr_ (+ ctr_ 1)
)
)
 (let ((State (store State ctr_ (mk-some (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 (as mk-none (Maybe Bits_256)
)
 (as mk-none (Maybe Bits_256)
)
 (as mk-none (Maybe Bits_256)
)
 (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
 0)
)
)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-Hon> <game-state> <game-consts> kid)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-NewSession> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue Int)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
 (hon (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
)
)
)
 (let ((Fresh (store Fresh ctr_ (mk-some hon)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-NewSession> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value ctr_)
)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send1> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send1> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (not (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((state <unwrap-1>)
)
 (let ((__ret (<oracle-H7-H7_1_0-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run1> <game-state> <game-consts> state)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1-game-state> __ret)
)
 (return (return-value (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1-return-value-or-abort> __ret)
)
)
)
 (let ((state (el2-1 return)
)
 (msg (el2-2 return)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send2> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
 (msg Bits_256)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (not (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((state <unwrap-1>)
)
 (let ((__ret (<oracle-H7-H7_1_0-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run2> <game-state> <game-consts> state msg)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2-game-state> __ret)
)
 (return (return-value (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2-return-value-or-abort> __ret)
)
)
)
 (let ((state (el2-1 return)
)
 (msg_ (el2-2 return)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send3> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
 (msg (Tuple2 Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send3> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (not (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((state <unwrap-1>)
)
 (let ((__ret (<oracle-H7-H7_1_0-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run3> <game-state> <game-consts> state msg)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3-game-state> __ret)
)
 (return (return-value (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3-return-value-or-abort> __ret)
)
)
)
 (let ((state (el2-1 return)
)
 (msg_ (el2-2 return)
)
)
 (let ((_U (el11-1 state)
)
 (_u (el11-2 state)
)
 (_V (el11-3 state)
)
 (_kid (el11-4 state)
)
 (_acc (el11-5 state)
)
 (_k (el11-6 state)
)
 (_ni (el11-7 state)
)
 (_nr (el11-8 state)
)
 (_kmac (el11-9 state)
)
 (sid (el11-10 state)
)
 (_mess (el11-11 state)
)
)
 (ite (= _mess 2)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-2> (maybe-get sid)
)
)
 (ite (= (select First <unwrap-2>)
 (as mk-none (Maybe Int)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-3> (maybe-get sid)
)
)
 (let ((First (store First <unwrap-3> (mk-some ctr)
)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-4> (maybe-get sid)
)
)
 (ite (= (select Second <unwrap-4>)
 (as mk-none (Maybe Int)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-5> (maybe-get sid)
)
)
 (let ((Second (store Second <unwrap-5> (mk-some ctr)
)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send4> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
 (msg (Tuple2 Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send4> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (not (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((state <unwrap-1>)
)
 (let ((__ret (<oracle-H7-H7_1_0-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run4> <game-state> <game-consts> state msg)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4-game-state> __ret)
)
 (return (return-value (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4-return-value-or-abort> __ret)
)
)
)
 (let ((state (el2-1 return)
)
 (msg_ (el2-2 return)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (let ((_U (el11-1 state)
)
 (_u (el11-2 state)
)
 (_V (el11-3 state)
)
 (_kid (el11-4 state)
)
 (_acc (el11-5 state)
)
 (_k (el11-6 state)
)
 (_ni (el11-7 state)
)
 (_nr (el11-8 state)
)
 (_kmac (el11-9 state)
)
 (sid (el11-10 state)
)
 (_mess (el11-11 state)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-2> (maybe-get sid)
)
)
 (ite (= (select First <unwrap-2>)
 (as mk-none (Maybe Int)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-3> (maybe-get sid)
)
)
 (let ((First (store First <unwrap-3> (mk-some ctr)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-4> (maybe-get sid)
)
)
 (ite (= (select Second <unwrap-4>)
 (as mk-none (Maybe Int)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-5> (maybe-get sid)
)
)
 (let ((Second (store Second <unwrap-5> (mk-some ctr)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send5> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
 (msg Bits_256)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send5> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (not (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5> <game-state> (as mk-abort (ReturnValue (Tuple1 Bool)
)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((state <unwrap-1>)
)
 (let ((__ret (<oracle-H7-H7_1_0-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run5> <game-state> <game-consts> state msg)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple1 Bool)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5-game-state> __ret)
)
 (return (return-value (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5-return-value-or-abort> __ret)
)
)
)
 (let ((state (el2-1 return)
)
 (stop (el2-2 return)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value stop)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5> <game-state> (as mk-abort (ReturnValue (Tuple1 Bool)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Reveal> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Reveal> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((U (el11-1 <unwrap-1>)
)
 (u (el11-2 <unwrap-1>)
)
 (V (el11-3 <unwrap-1>)
)
 (kid (el11-4 <unwrap-1>)
)
 (acc (el11-5 <unwrap-1>)
)
 (_k (el11-6 <unwrap-1>)
)
 (ni (el11-7 <unwrap-1>)
)
 (nr (el11-8 <unwrap-1>)
)
 (kmac (el11-9 <unwrap-1>)
)
 (sid (el11-10 <unwrap-1>)
)
 (mess (el11-11 <unwrap-1>)
)
)
 (ite (= acc (mk-some true)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-2> (maybe-get sid)
)
)
 (ite (= (select RevTested <unwrap-2>)
 (as mk-none (Maybe Bool)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-3> (maybe-get sid)
)
)
 (let ((RevTested (store RevTested <unwrap-3> (mk-some false)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-4> (maybe-get ni)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-5> (maybe-get nr)
)
)
 (let ((RevTestEval (store RevTestEval (mk-tuple5 kid U V <unwrap-4> <unwrap-5>)
 (mk-some ctr)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-6> (maybe-get ni)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-7> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-Eval> <game-state> <game-consts> kid U V <unwrap-6> <unwrap-7> true)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue Bits_256)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
 (k (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value k)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Test> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Test> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((U (el11-1 <unwrap-1>)
)
 (u (el11-2 <unwrap-1>)
)
 (V (el11-3 <unwrap-1>)
)
 (kid (el11-4 <unwrap-1>)
)
 (acc (el11-5 <unwrap-1>)
)
 (_k (el11-6 <unwrap-1>)
)
 (ni (el11-7 <unwrap-1>)
)
 (nr (el11-8 <unwrap-1>)
)
 (kmac (el11-9 <unwrap-1>)
)
 (sid (el11-10 <unwrap-1>)
)
 (mess (el11-11 <unwrap-1>)
)
)
 (ite (= acc (mk-some true)
)
 (ite (= (select Fresh ctr)
 (as mk-none (Maybe Bool)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-2> (maybe-get (select Fresh ctr)
)
)
)
 (ite <unwrap-2> (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-3> (maybe-get sid)
)
)
 (ite (= (select RevTested <unwrap-3>)
 (as mk-none (Maybe Bool)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-4> (maybe-get sid)
)
)
 (let ((RevTested (store RevTested <unwrap-4> (mk-some true)
)
)
)
 (ite b (let ((k (__sample-rand-H7_1_0-Bits_256 (sample-id "KX" "Test" "1")
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (+ 1 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value k)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-5> (maybe-get ni)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-6> (maybe-get nr)
)
)
 (let ((RevTestEval (store RevTestEval (mk-tuple5 kid U V <unwrap-5> <unwrap-6>)
 (mk-some ctr)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-7> (maybe-get ni)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-8> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-Eval> <game-state> <game-consts> kid U V <unwrap-7> <unwrap-8> true)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue Bits_256)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
 (k (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value k)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-SameKey> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr1 Int)
 (ctr2 Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_SameKey> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (= (select State ctr1)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr1)
)
)
)
 (let ((_U (el11-1 <unwrap-1>)
)
 (_u (el11-2 <unwrap-1>)
)
 (_V (el11-3 <unwrap-1>)
)
 (_kid (el11-4 <unwrap-1>)
)
 (acc1 (el11-5 <unwrap-1>)
)
 (k1 (el11-6 <unwrap-1>)
)
 (_ni (el11-7 <unwrap-1>)
)
 (_nr (el11-8 <unwrap-1>)
)
 (_kmac (el11-9 <unwrap-1>)
)
 (sid1 (el11-10 <unwrap-1>)
)
 (_mess (el11-11 <unwrap-1>)
)
)
 (ite (= (select State ctr2)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-2> (maybe-get (select State ctr2)
)
)
)
 (let ((_U (el11-1 <unwrap-2>)
)
 (_u (el11-2 <unwrap-2>)
)
 (_V (el11-3 <unwrap-2>)
)
 (_kid (el11-4 <unwrap-2>)
)
 (acc2 (el11-5 <unwrap-2>)
)
 (k2 (el11-6 <unwrap-2>)
)
 (_ni (el11-7 <unwrap-2>)
)
 (_nr (el11-8 <unwrap-2>)
)
 (_kmac (el11-9 <unwrap-2>)
)
 (sid2 (el11-10 <unwrap-2>)
)
 (_mess (el11-11 <unwrap-2>)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-AtMost> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr1 Int)
 (ctr2 Int)
 (ctr3 Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtMost> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (= (select State ctr1)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr1)
)
)
)
 (let ((_U (el11-1 <unwrap-1>)
)
 (_u (el11-2 <unwrap-1>)
)
 (_V (el11-3 <unwrap-1>)
)
 (_kid (el11-4 <unwrap-1>)
)
 (acc1 (el11-5 <unwrap-1>)
)
 (_k (el11-6 <unwrap-1>)
)
 (_ni (el11-7 <unwrap-1>)
)
 (_nr (el11-8 <unwrap-1>)
)
 (_kmac (el11-9 <unwrap-1>)
)
 (sid1 (el11-10 <unwrap-1>)
)
 (_mess (el11-11 <unwrap-1>)
)
)
 (ite (= (select State ctr2)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-2> (maybe-get (select State ctr2)
)
)
)
 (let ((_U (el11-1 <unwrap-2>)
)
 (_u (el11-2 <unwrap-2>)
)
 (_V (el11-3 <unwrap-2>)
)
 (_kid (el11-4 <unwrap-2>)
)
 (acc2 (el11-5 <unwrap-2>)
)
 (_k (el11-6 <unwrap-2>)
)
 (_ni (el11-7 <unwrap-2>)
)
 (_nr (el11-8 <unwrap-2>)
)
 (_kmac (el11-9 <unwrap-2>)
)
 (sid2 (el11-10 <unwrap-2>)
)
 (_mess (el11-11 <unwrap-2>)
)
)
 (ite (= (select State ctr3)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-3> (maybe-get (select State ctr3)
)
)
)
 (let ((_U (el11-1 <unwrap-3>)
)
 (_u (el11-2 <unwrap-3>)
)
 (_V (el11-3 <unwrap-3>)
)
 (_kid (el11-4 <unwrap-3>)
)
 (acc3 (el11-5 <unwrap-3>)
)
 (_k (el11-6 <unwrap-3>)
)
 (_ni (el11-7 <unwrap-3>)
)
 (_nr (el11-8 <unwrap-3>)
)
 (_kmac (el11-9 <unwrap-3>)
)
 (sid3 (el11-10 <unwrap-3>)
)
 (_mess (el11-11 <unwrap-3>)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
)
)
)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-AtLeast> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (sid (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtLeast> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (and (= b false)
 (not (= (select First sid)
 (as mk-none (Maybe Int)
)
)
)
 (= (select Second sid)
 (as mk-none (Maybe Int)
)
)
)
 (ite (= (select First sid)
 (as mk-none (Maybe Int)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-1> (maybe-get (select First sid)
)
)
)
 (ite (= (select State <unwrap-1>)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-2> (maybe-get (select State <unwrap-1>)
)
)
)
 (let ((_U (el11-1 <unwrap-2>)
)
 (_u (el11-2 <unwrap-2>)
)
 (_V (el11-3 <unwrap-2>)
)
 (_kid (el11-4 <unwrap-2>)
)
 (acc1 (el11-5 <unwrap-2>)
)
 (_k (el11-6 <unwrap-2>)
)
 (_ni (el11-7 <unwrap-2>)
)
 (_nr (el11-8 <unwrap-2>)
)
 (_kmac (el11-9 <unwrap-2>)
)
 (_sid (el11-10 <unwrap-2>)
)
 (_mess (el11-11 <unwrap-2>)
)
)
 (ite (= (select First sid)
 (as mk-none (Maybe Int)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-3> (maybe-get (select First sid)
)
)
)
 (ite (and (= acc1 (mk-some true)
)
 (= (select Fresh <unwrap-3>)
 (mk-some true)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value true)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
)
)
)
)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-NewKey> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ltk (Maybe Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey> (let ((LTK (<pkg-state-PRF-<$<!n!>$>-LTK> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (H (<pkg-state-PRF-<$<!n!>$>-H> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (PRF (<pkg-state-PRF-<$<!n!>$>-PRF> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (kid_ (<pkg-state-PRF-<$<!n!>$>-kid_> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
)
 (let ((n (<pkg-consts-PRF-n> (<pkgconsts-H7-PRF> <game-consts>)
)
)
 (b (<pkg-consts-PRF-b> (<pkgconsts-H7-PRF> <game-consts>)
)
)
)
 (let ((kid_ (+ kid_ 1)
)
)
 (ite (= ltk (as mk-none (Maybe Bits_256)
)
)
 (let ((ltk_ (__sample-rand-H7_1_1-Bits_256 (sample-id "PRF" "NewKey" "1")
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (+ 1 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (let ((LTK (store LTK kid_ (mk-some ltk_)
)
)
)
 (let ((H (store H kid_ (mk-some true)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value kid_)
)
)
)
)
)
 (let ((LTK (store LTK kid_ ltk)
)
)
 (let ((H (store H kid_ (mk-some false)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value kid_)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-Eval> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (kid Int)
 (U Int)
 (V Int)
 (ni Bits_256)
 (nr Bits_256)
 (bit Bool)
)
 <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_Eval> (let ((LTK (<pkg-state-PRF-<$<!n!>$>-LTK> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (H (<pkg-state-PRF-<$<!n!>$>-H> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (PRF (<pkg-state-PRF-<$<!n!>$>-PRF> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (kid_ (<pkg-state-PRF-<$<!n!>$>-kid_> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
)
 (let ((n (<pkg-consts-PRF-n> (<pkgconsts-H7-PRF> <game-consts>)
)
)
 (b (<pkg-consts-PRF-b> (<pkgconsts-H7-PRF> <game-consts>)
)
)
)
 (ite (not (= (select LTK kid)
 (as mk-none (Maybe Bits_256)
)
)
)
 (ite (or (= (select H kid)
 (mk-some false)
)
 (not b)
)
 (ite (= (select LTK kid)
 (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-1> (maybe-get (select LTK kid)
)
)
)
 (let ((k <unwrap-1>)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (<<func-prf>> k U V ni nr bit)
)
)
)
)
)
 (ite (= (select PRF (mk-tuple6 kid U V ni nr bit)
)
 (as mk-none (Maybe Bits_256)
)
)
 (let ((temp (__sample-rand-H7_1_1-Bits_256 (sample-id "PRF" "Eval" "1")
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (+ 1 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (let ((PRF (store PRF (mk-tuple6 kid U V ni nr bit)
 (mk-some temp)
)
)
)
 (let ((y (select PRF (mk-tuple6 kid U V ni nr bit)
)
)
)
 (ite (= y (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-2> (maybe-get y)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value <unwrap-2>)
)
)
)
)
)
)
)
 (let ((y (select PRF (mk-tuple6 kid U V ni nr bit)
)
)
)
 (ite (= y (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-2> (maybe-get y)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value <unwrap-2>)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-Hon> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (kid Int)
)
 <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_Hon> (let ((LTK (<pkg-state-PRF-<$<!n!>$>-LTK> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (H (<pkg-state-PRF-<$<!n!>$>-H> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (PRF (<pkg-state-PRF-<$<!n!>$>-PRF> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
 (kid_ (<pkg-state-PRF-<$<!n!>$>-kid_> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
)
)
)
 (let ((n (<pkg-consts-PRF-n> (<pkgconsts-H7-PRF> <game-consts>)
)
)
 (b (<pkg-consts-PRF-b> (<pkgconsts-H7-PRF> <game-consts>)
)
)
)
 (ite (not (= (select H kid)
 (as mk-none (Maybe Bool)
)
)
)
 (ite (= (select H kid)
 (as mk-none (Maybe Bool)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-1> (maybe-get (select H kid)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value <unwrap-1>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<mk-pkg-state-PRF-<$<!n!>$>> LTK H PRF kid_)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon> <game-state> (as mk-abort (ReturnValue Bool)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Init> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (handle (Tuple5 Int Int Int Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_MAC_<$<!n!>$>_Init> (let ((Keys (<pkg-state-MAC-<$<!n!>$>-Keys> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
 (Values (<pkg-state-MAC-<$<!n!>$>-Values> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
)
 (let ((n (<pkg-consts-MAC-n> (<pkgconsts-H7-MAC> <game-consts>)
)
)
 (b (<pkg-consts-MAC-b> (<pkgconsts-H7-MAC> <game-consts>)
)
)
)
 (ite (= (select Keys handle)
 (as mk-none (Maybe Bits_256)
)
)
 (let ((key (__sample-rand-H7_1_1-Bits_256 (sample-id "MAC" "Init" "1")
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (+ 1 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (let ((Keys (store Keys handle (mk-some key)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value mk-empty)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value mk-empty)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Mac> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (handle (Tuple5 Int Int Int Bits_256 Bits_256)
)
 (value (Tuple2 Bits_256 Int)
)
)
 <OracleReturn_H7_<$<!n!>$>_MAC_<$<!n!>$>_Mac> (let ((Keys (<pkg-state-MAC-<$<!n!>$>-Keys> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
 (Values (<pkg-state-MAC-<$<!n!>$>-Values> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
)
 (let ((n (<pkg-consts-MAC-n> (<pkgconsts-H7-MAC> <game-consts>)
)
)
 (b (<pkg-consts-MAC-b> (<pkgconsts-H7-MAC> <game-consts>)
)
)
)
 (let ((key (select Keys handle)
)
)
 (ite (not (= key (as mk-none (Maybe Bits_256)
)
)
)
 (let ((val1 (el2-1 value)
)
 (val2 (el2-2 value)
)
)
 (ite (= key (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-1> (maybe-get key)
)
)
 (let ((tag (<<func-mac>> <unwrap-1> val1 val2)
)
)
 (let ((Values (store Values (mk-tuple2 handle value)
 (mk-some tag)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value tag)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Verify> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (handle (Tuple5 Int Int Int Bits_256 Bits_256)
)
 (value (Tuple2 Bits_256 Int)
)
 (tag Bits_256)
)
 <OracleReturn_H7_<$<!n!>$>_MAC_<$<!n!>$>_Verify> (let ((Keys (<pkg-state-MAC-<$<!n!>$>-Keys> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
 (Values (<pkg-state-MAC-<$<!n!>$>-Values> (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
)
)
)
 (let ((n (<pkg-consts-MAC-n> (<pkgconsts-H7-MAC> <game-consts>)
)
)
 (b (<pkg-consts-MAC-b> (<pkgconsts-H7-MAC> <game-consts>)
)
)
)
 (let ((key (select Keys handle)
)
)
 (ite (not (= key (as mk-none (Maybe Bits_256)
)
)
)
 (ite b (let ((entry (select Values (mk-tuple2 handle value)
)
)
)
 (ite (= entry (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
 (ite (= entry (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-1> (maybe-get entry)
)
)
 (ite (not (= <unwrap-1> tag)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value true)
)
)
)
)
)
)
 (let ((val1 (el2-1 value)
)
 (val2 (el2-2 value)
)
)
 (ite (= key (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-2> (maybe-get key)
)
)
 (let ((tag_ (<<func-mac>> <unwrap-2> val1 val2)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (= tag tag_)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<mk-pkg-state-MAC-<$<!n!>$>> Keys Values)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify> <game-state> (as mk-abort (ReturnValue Bool)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-Nonces-Nonces-<$<!n!>$>-Sample> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
)
 <OracleReturn_H7_<$<!n!>$>_Nonces_<$<!n!>$>_Sample> (let ((Nonces (<pkg-state-Nonces-<$<!n!>$>-Nonces> (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
)
)
)
 (let ((n (<pkg-consts-Nonces-n> (<pkgconsts-H7-Nonces> <game-consts>)
)
)
 (b (<pkg-consts-Nonces-b> (<pkgconsts-H7-Nonces> <game-consts>)
)
)
)
 (let ((ni (__sample-rand-H7_1_1-Bits_256 (sample-id "Nonces" "Sample" "1")
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (+ 1 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (ite b (ite (= (select Nonces ni)
 (as mk-none (Maybe Bool)
)
)
 (let ((Nonces (store Nonces ni (mk-some true)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<mk-pkg-state-Nonces-<$<!n!>$>> Nonces)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value ni)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<mk-pkg-state-Nonces-<$<!n!>$>> Nonces)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<mk-pkg-state-Nonces-<$<!n!>$>> Nonces)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value ni)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run1> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (state (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
 <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run1> (let ((n (<pkg-consts-ReductionMac-n> (<pkgconsts-H7-Prot> <game-consts>)
)
)
 (zeron (<pkg-consts-ReductionMac-zeron> (<pkgconsts-H7-Prot> <game-consts>)
)
)
)
 (let ((U (el11-1 state)
)
 (u (el11-2 state)
)
 (V (el11-3 state)
)
 (kid (el11-4 state)
)
 (acc (el11-5 state)
)
 (k (el11-6 state)
)
 (ni_ (el11-7 state)
)
 (nr (el11-8 state)
)
 (kmac (el11-9 state)
)
 (sid (el11-10 state)
)
 (mess (el11-11 state)
)
)
 (ite (= acc (as mk-none (Maybe Bool)
)
)
 (ite (= mess 0)
 (ite (= u false)
 (let ((__ret (<oracle-H7-H7_1_1-Nonces-Nonces-<$<!n!>$>-Sample> <game-state> <game-consts>)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-game-state> __ret)
)
 (ni (return-value (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-return-value-or-abort> __ret)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 k (mk-some ni)
 nr kmac sid 1)
 (mk-tuple1 ni)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run2> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (state (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
 (ni Bits_256)
)
 <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run2> (let ((n (<pkg-consts-ReductionMac-n> (<pkgconsts-H7-Prot> <game-consts>)
)
)
 (zeron (<pkg-consts-ReductionMac-zeron> (<pkgconsts-H7-Prot> <game-consts>)
)
)
)
 (let ((U (el11-1 state)
)
 (v (el11-2 state)
)
 (V (el11-3 state)
)
 (kid (el11-4 state)
)
 (acc (el11-5 state)
)
 (k_ (el11-6 state)
)
 (ni_ (el11-7 state)
)
 (nr_ (el11-8 state)
)
 (kmac__ (el11-9 state)
)
 (sid_ (el11-10 state)
)
 (mess (el11-11 state)
)
)
 (ite (= acc (as mk-none (Maybe Bool)
)
)
 (ite (= mess 0)
 (ite (= v true)
 (let ((__ret (<oracle-H7-H7_1_1-Nonces-Nonces-<$<!n!>$>-Sample> <game-state> <game-consts>)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-game-state> __ret)
)
 (nr (return-value (<oracle-return-H7-<$<!n!>$>-Nonces-<$<!n!>$>-Sample-return-value-or-abort> __ret)
)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-Hon> <game-state> <game-consts> kid)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
 (hon (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
)
)
)
 (ite hon (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Init> <game-state> <game-consts> (mk-tuple5 kid U V ni nr)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Empty)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-game-state> __ret)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V ni nr)
 (mk-tuple2 nr 2)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (let ((kmac (as mk-none (Maybe Bits_256)
)
)
)
 (let ((sid (mk-tuple5 U V ni nr tau)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 (mk-some ni)
 (mk-some nr)
 kmac (mk-some sid)
 1)
 (mk-tuple2 nr tau)
)
)
)
)
)
)
)
)
)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-Eval> <game-state> <game-consts> kid U V ni nr false)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
 (kmac_ (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
)
)
)
 (let ((tau (<<func-mac>> kmac_ nr 2)
)
)
 (let ((kmac (mk-some kmac_)
)
)
 (let ((sid (mk-tuple5 U V ni nr tau)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 (mk-some ni)
 (mk-some nr)
 kmac (mk-some sid)
 1)
 (mk-tuple2 nr tau)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run3> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (state (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
 (msg (Tuple2 Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run3> (let ((n (<pkg-consts-ReductionMac-n> (<pkgconsts-H7-Prot> <game-consts>)
)
)
 (zeron (<pkg-consts-ReductionMac-zeron> (<pkgconsts-H7-Prot> <game-consts>)
)
)
)
 (let ((U (el11-1 state)
)
 (u (el11-2 state)
)
 (V (el11-3 state)
)
 (kid (el11-4 state)
)
 (acc (el11-5 state)
)
 (k_ (el11-6 state)
)
 (ni (el11-7 state)
)
 (nr_ (el11-8 state)
)
 (kmac__ (el11-9 state)
)
 (sid_ (el11-10 state)
)
 (mess (el11-11 state)
)
)
 (ite (= mess 1)
 (ite (= acc (as mk-none (Maybe Bool)
)
)
 (ite (= u false)
 (let ((nr (el2-1 msg)
)
 (tau (el2-2 msg)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-Hon> <game-state> <game-consts> kid)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
 (hon (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
)
)
)
 (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-1> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Init> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-1> nr)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Empty)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Init-game-state> __ret)
)
)
 (let ((kmac (as mk-none (Maybe Bits_256)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-3> (maybe-get ni)
)
)
 (let ((sid (mk-tuple5 U V <unwrap-3> nr tau)
)
)
 (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-4> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Verify> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-4> nr)
 (mk-tuple2 nr 2)
 tau)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
 (verified (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
)
)
)
 (ite verified (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get ni)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-6> nr)
 (mk-tuple2 <unwrap-7> 3)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-8> (maybe-get kmac)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-9> (maybe-get ni)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-8> <unwrap-9> 3)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple2 zeron zeron)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-5> (maybe-get kmac)
)
)
 (let ((verified (= (<<func-mac>> <unwrap-5> nr 2)
 tau)
)
)
 (ite verified (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get ni)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-6> nr)
 (mk-tuple2 <unwrap-7> 3)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-8> (maybe-get kmac)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-9> (maybe-get ni)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-8> <unwrap-9> 3)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple2 zeron zeron)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-2> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-Eval> <game-state> <game-consts> kid U V <unwrap-2> nr false)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
 (kmac_ (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
)
)
)
 (let ((kmac (mk-some kmac_)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-3> (maybe-get ni)
)
)
 (let ((sid (mk-tuple5 U V <unwrap-3> nr tau)
)
)
 (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-4> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Verify> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-4> nr)
 (mk-tuple2 nr 2)
 tau)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
 (verified (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
)
)
)
 (ite verified (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get ni)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-6> nr)
 (mk-tuple2 <unwrap-7> 3)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-8> (maybe-get kmac)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-9> (maybe-get ni)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-8> <unwrap-9> 3)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple2 zeron zeron)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-5> (maybe-get kmac)
)
)
 (let ((verified (= (<<func-mac>> <unwrap-5> nr 2)
 tau)
)
)
 (ite verified (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get ni)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get ni)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-6> nr)
 (mk-tuple2 <unwrap-7> 3)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-8> (maybe-get kmac)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-9> (maybe-get ni)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-8> <unwrap-9> 3)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<unwrap-10> (maybe-get ni)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 ni (mk-some nr)
 kmac (mk-some sid)
 2)
 (mk-tuple2 <unwrap-10> tau_new)
)
)
)
)
)
)
)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple2 zeron zeron)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run4> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (state (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
 (msg (Tuple2 Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run4> (let ((n (<pkg-consts-ReductionMac-n> (<pkgconsts-H7-Prot> <game-consts>)
)
)
 (zeron (<pkg-consts-ReductionMac-zeron> (<pkgconsts-H7-Prot> <game-consts>)
)
)
)
 (let ((U (el11-1 state)
)
 (v (el11-2 state)
)
 (V (el11-3 state)
)
 (kid (el11-4 state)
)
 (acc (el11-5 state)
)
 (k (el11-6 state)
)
 (ni_ (el11-7 state)
)
 (nr (el11-8 state)
)
 (kmac (el11-9 state)
)
 (sid (el11-10 state)
)
 (mess (el11-11 state)
)
)
 (ite (= acc (as mk-none (Maybe Bool)
)
)
 (ite (= mess 1)
 (ite (= v true)
 (let ((ni (el2-1 msg)
)
 (tau (el2-2 msg)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-Hon> <game-state> <game-consts> kid)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
 (hon (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
)
)
)
 (ite hon (ite (= ni_ (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-1> (maybe-get ni_)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-2> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Verify> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-1> <unwrap-2>)
 (mk-tuple2 ni 3)
 tau)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
 (verified (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
)
)
)
 (ite (= ni_ (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-4> (maybe-get ni_)
)
)
 (ite (and verified (= ni <unwrap-4>)
)
 (let ((acc (mk-some true)
)
)
 (ite hon (ite (= ni_ (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-5> (maybe-get ni_)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-5> <unwrap-6>)
 (mk-tuple2 zeron 4)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 tau_new)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get kmac)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-7> zeron 4)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 tau_new)
)
)
)
)
)
)
)
)
 (let ((acc (mk-some false)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 zeron)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-3> (maybe-get kmac)
)
)
 (let ((verified (= (<<func-mac>> <unwrap-3> ni 3)
 tau)
)
)
 (ite (= ni_ (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-4> (maybe-get ni_)
)
)
 (ite (and verified (= ni <unwrap-4>)
)
 (let ((acc (mk-some true)
)
)
 (ite hon (ite (= ni_ (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-5> (maybe-get ni_)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-6> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Mac> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-5> <unwrap-6>)
 (mk-tuple2 zeron 4)
)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-game-state> __ret)
)
 (tau_new (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Mac-return-value-or-abort> __ret)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 tau_new)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<unwrap-7> (maybe-get kmac)
)
)
 (let ((tau_new (<<func-mac>> <unwrap-7> zeron 4)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 tau_new)
)
)
)
)
)
)
)
)
 (let ((acc (mk-some false)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U v V kid acc k ni_ nr kmac sid 2)
 (mk-tuple1 zeron)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run5> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (state (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
 (tau Bits_256)
)
 <OracleReturn_H7_<$<!n!>$>_ReductionMac_<$<!n!>$>_Run5> (let ((n (<pkg-consts-ReductionMac-n> (<pkgconsts-H7-Prot> <game-consts>)
)
)
 (zeron (<pkg-consts-ReductionMac-zeron> (<pkgconsts-H7-Prot> <game-consts>)
)
)
)
 (let ((U (el11-1 state)
)
 (u (el11-2 state)
)
 (V (el11-3 state)
)
 (kid (el11-4 state)
)
 (acc (el11-5 state)
)
 (k (el11-6 state)
)
 (ni (el11-7 state)
)
 (nr (el11-8 state)
)
 (kmac (el11-9 state)
)
 (sid (el11-10 state)
)
 (mess (el11-11 state)
)
)
 (ite (= acc (as mk-none (Maybe Bool)
)
)
 (ite (= mess 2)
 (ite (= u false)
 (let ((__ret (<oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-Hon> <game-state> <game-consts> kid)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
 (hon (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
)
)
)
 (ite hon (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
 (let ((<unwrap-1> (maybe-get ni)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
 (let ((<unwrap-2> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-MAC-MAC-<$<!mac!><!n!>$>-Verify> <game-state> <game-consts> (mk-tuple5 kid U V <unwrap-1> <unwrap-2>)
 (mk-tuple2 zeron 4)
 tau)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-game-state> __ret)
)
 (verified (return-value (<oracle-return-H7-<$<!n!>$>-MAC-<$<!n!>$>-Verify-return-value-or-abort> __ret)
)
)
)
 (ite verified (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (mk-some true)
 k ni nr kmac sid 3)
 (mk-tuple1 true)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple1 false)
)
)
)
)
)
)
)
)
)
)
)
 (ite (= kmac (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
 (let ((<unwrap-3> (maybe-get kmac)
)
)
 (let ((verified (= (<<func-mac>> <unwrap-3> zeron 4)
 tau)
)
)
 (ite verified (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 (mk-tuple11 U u V kid (mk-some true)
 k ni nr kmac sid 3)
 (mk-tuple1 true)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value (mk-tuple2 state (mk-tuple1 false)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 <mk-pkg-state-ReductionMac-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5> <game-state> (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-NewSession> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (U Int)
 (u Bool)
 (V Int)
 (kid Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_NewSession> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (let ((ctr_ (+ ctr_ 1)
)
)
 (let ((State (store State ctr_ (mk-some (mk-tuple11 U u V kid (as mk-none (Maybe Bool)
)
 (as mk-none (Maybe Bits_256)
)
 (as mk-none (Maybe Bits_256)
)
 (as mk-none (Maybe Bits_256)
)
 (as mk-none (Maybe Bits_256)
)
 (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
 0)
)
)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-Hon> <game-state> <game-consts> kid)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bool)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-NewSession> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue Int)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-game-state> __ret)
)
 (hon (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Hon-return-value-or-abort> __ret)
)
)
)
 (let ((Fresh (store Fresh ctr_ (mk-some hon)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-NewSession> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value ctr_)
)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send1> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send1> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (not (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((state <unwrap-1>)
)
 (let ((__ret (<oracle-H7-H7_1_1-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run1> <game-state> <game-consts> state)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1-game-state> __ret)
)
 (return (return-value (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run1-return-value-or-abort> __ret)
)
)
)
 (let ((state (el2-1 return)
)
 (msg (el2-2 return)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send2> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
 (msg Bits_256)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (not (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((state <unwrap-1>)
)
 (let ((__ret (<oracle-H7-H7_1_1-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run2> <game-state> <game-consts> state msg)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2-game-state> __ret)
)
 (return (return-value (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run2-return-value-or-abort> __ret)
)
)
)
 (let ((state (el2-1 return)
)
 (msg_ (el2-2 return)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send3> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
 (msg (Tuple2 Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send3> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (not (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((state <unwrap-1>)
)
 (let ((__ret (<oracle-H7-H7_1_1-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run3> <game-state> <game-consts> state msg)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3-game-state> __ret)
)
 (return (return-value (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run3-return-value-or-abort> __ret)
)
)
)
 (let ((state (el2-1 return)
)
 (msg_ (el2-2 return)
)
)
 (let ((_U (el11-1 state)
)
 (_u (el11-2 state)
)
 (_V (el11-3 state)
)
 (_kid (el11-4 state)
)
 (_acc (el11-5 state)
)
 (_k (el11-6 state)
)
 (_ni (el11-7 state)
)
 (_nr (el11-8 state)
)
 (_kmac (el11-9 state)
)
 (sid (el11-10 state)
)
 (_mess (el11-11 state)
)
)
 (ite (= _mess 2)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-2> (maybe-get sid)
)
)
 (ite (= (select First <unwrap-2>)
 (as mk-none (Maybe Int)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-3> (maybe-get sid)
)
)
 (let ((First (store First <unwrap-3> (mk-some ctr)
)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-4> (maybe-get sid)
)
)
 (ite (= (select Second <unwrap-4>)
 (as mk-none (Maybe Int)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
 (let ((<unwrap-5> (maybe-get sid)
)
)
 (let ((Second (store Second <unwrap-5> (mk-some ctr)
)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3> <game-state> (as mk-abort (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send4> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
 (msg (Tuple2 Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send4> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (not (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((state <unwrap-1>)
)
 (let ((__ret (<oracle-H7-H7_1_1-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run4> <game-state> <game-consts> state msg)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4-game-state> __ret)
)
 (return (return-value (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run4-return-value-or-abort> __ret)
)
)
)
 (let ((state (el2-1 return)
)
 (msg_ (el2-2 return)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (let ((_U (el11-1 state)
)
 (_u (el11-2 state)
)
 (_V (el11-3 state)
)
 (_kid (el11-4 state)
)
 (_acc (el11-5 state)
)
 (_k (el11-6 state)
)
 (_ni (el11-7 state)
)
 (_nr (el11-8 state)
)
 (_kmac (el11-9 state)
)
 (sid (el11-10 state)
)
 (_mess (el11-11 state)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-2> (maybe-get sid)
)
)
 (ite (= (select First <unwrap-2>)
 (as mk-none (Maybe Int)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-3> (maybe-get sid)
)
)
 (let ((First (store First <unwrap-3> (mk-some ctr)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-4> (maybe-get sid)
)
)
 (ite (= (select Second <unwrap-4>)
 (as mk-none (Maybe Int)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
 (let ((<unwrap-5> (maybe-get sid)
)
)
 (let ((Second (store Second <unwrap-5> (mk-some ctr)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value msg_)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4> <game-state> (as mk-abort (ReturnValue (Tuple1 Bits_256)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send5> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
 (msg Bits_256)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send5> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (not (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5> <game-state> (as mk-abort (ReturnValue (Tuple1 Bool)
)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((state <unwrap-1>)
)
 (let ((__ret (<oracle-H7-H7_1_1-ReductionMac-Prot-<$<!mac!><!n!><!prf!>$>-Run5> <game-state> <game-consts> state msg)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue (Tuple2 (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
 (Tuple1 Bool)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue (Tuple1 Bool)
)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5-game-state> __ret)
)
 (return (return-value (<oracle-return-H7-<$<!n!>$>-ReductionMac-<$<!n!>$>-Run5-return-value-or-abort> __ret)
)
)
)
 (let ((state (el2-1 return)
)
 (stop (el2-2 return)
)
)
 (let ((State (store State ctr (mk-some state)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value stop)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5> <game-state> (as mk-abort (ReturnValue (Tuple1 Bool)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Reveal> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Reveal> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((U (el11-1 <unwrap-1>)
)
 (u (el11-2 <unwrap-1>)
)
 (V (el11-3 <unwrap-1>)
)
 (kid (el11-4 <unwrap-1>)
)
 (acc (el11-5 <unwrap-1>)
)
 (_k (el11-6 <unwrap-1>)
)
 (ni (el11-7 <unwrap-1>)
)
 (nr (el11-8 <unwrap-1>)
)
 (kmac (el11-9 <unwrap-1>)
)
 (sid (el11-10 <unwrap-1>)
)
 (mess (el11-11 <unwrap-1>)
)
)
 (ite (= acc (mk-some true)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-2> (maybe-get sid)
)
)
 (ite (= (select RevTested <unwrap-2>)
 (as mk-none (Maybe Bool)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-3> (maybe-get sid)
)
)
 (let ((RevTested (store RevTested <unwrap-3> (mk-some false)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-4> (maybe-get ni)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-5> (maybe-get nr)
)
)
 (let ((RevTestEval (store RevTestEval (mk-tuple5 kid U V <unwrap-4> <unwrap-5>)
 (mk-some ctr)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-6> (maybe-get ni)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-7> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-Eval> <game-state> <game-consts> kid U V <unwrap-6> <unwrap-7> true)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue Bits_256)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
 (k (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value k)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Test> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Test> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (= (select State ctr)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr)
)
)
)
 (let ((U (el11-1 <unwrap-1>)
)
 (u (el11-2 <unwrap-1>)
)
 (V (el11-3 <unwrap-1>)
)
 (kid (el11-4 <unwrap-1>)
)
 (acc (el11-5 <unwrap-1>)
)
 (_k (el11-6 <unwrap-1>)
)
 (ni (el11-7 <unwrap-1>)
)
 (nr (el11-8 <unwrap-1>)
)
 (kmac (el11-9 <unwrap-1>)
)
 (sid (el11-10 <unwrap-1>)
)
 (mess (el11-11 <unwrap-1>)
)
)
 (ite (= acc (mk-some true)
)
 (ite (= (select Fresh ctr)
 (as mk-none (Maybe Bool)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-2> (maybe-get (select Fresh ctr)
)
)
)
 (ite <unwrap-2> (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-3> (maybe-get sid)
)
)
 (ite (= (select RevTested <unwrap-3>)
 (as mk-none (Maybe Bool)
)
)
 (ite (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-4> (maybe-get sid)
)
)
 (let ((RevTested (store RevTested <unwrap-4> (mk-some true)
)
)
)
 (ite b (let ((k (__sample-rand-H7_1_1-Bits_256 (sample-id "KX" "Test" "1")
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (+ 1 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value k)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-5> (maybe-get ni)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-6> (maybe-get nr)
)
)
 (let ((RevTestEval (store RevTestEval (mk-tuple5 kid U V <unwrap-5> <unwrap-6>)
 (mk-some ctr)
)
)
)
 (ite (= ni (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-7> (maybe-get ni)
)
)
 (ite (= nr (as mk-none (Maybe Bits_256)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<unwrap-8> (maybe-get nr)
)
)
 (let ((__ret (<oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-Eval> <game-state> <game-consts> kid U V <unwrap-7> <unwrap-8> true)
)
)
 (ite (= (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
 (as mk-abort (ReturnValue Bits_256)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (as mk-abort (ReturnValue Bits_256)
)
)
)
 (let ((<game-state> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-game-state> __ret)
)
 (k (return-value (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-Eval-return-value-or-abort> __ret)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value k)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
 (let ((<game-state> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test> <game-state> (as mk-abort (ReturnValue Bits_256)
)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-SameKey> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr1 Int)
 (ctr2 Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_SameKey> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (= (select State ctr1)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr1)
)
)
)
 (let ((_U (el11-1 <unwrap-1>)
)
 (_u (el11-2 <unwrap-1>)
)
 (_V (el11-3 <unwrap-1>)
)
 (_kid (el11-4 <unwrap-1>)
)
 (acc1 (el11-5 <unwrap-1>)
)
 (k1 (el11-6 <unwrap-1>)
)
 (_ni (el11-7 <unwrap-1>)
)
 (_nr (el11-8 <unwrap-1>)
)
 (_kmac (el11-9 <unwrap-1>)
)
 (sid1 (el11-10 <unwrap-1>)
)
 (_mess (el11-11 <unwrap-1>)
)
)
 (ite (= (select State ctr2)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-2> (maybe-get (select State ctr2)
)
)
)
 (let ((_U (el11-1 <unwrap-2>)
)
 (_u (el11-2 <unwrap-2>)
)
 (_V (el11-3 <unwrap-2>)
)
 (_kid (el11-4 <unwrap-2>)
)
 (acc2 (el11-5 <unwrap-2>)
)
 (k2 (el11-6 <unwrap-2>)
)
 (_ni (el11-7 <unwrap-2>)
)
 (_nr (el11-8 <unwrap-2>)
)
 (_kmac (el11-9 <unwrap-2>)
)
 (sid2 (el11-10 <unwrap-2>)
)
 (_mess (el11-11 <unwrap-2>)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-AtMost> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (ctr1 Int)
 (ctr2 Int)
 (ctr3 Int)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtMost> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (= (select State ctr1)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-1> (maybe-get (select State ctr1)
)
)
)
 (let ((_U (el11-1 <unwrap-1>)
)
 (_u (el11-2 <unwrap-1>)
)
 (_V (el11-3 <unwrap-1>)
)
 (_kid (el11-4 <unwrap-1>)
)
 (acc1 (el11-5 <unwrap-1>)
)
 (_k (el11-6 <unwrap-1>)
)
 (_ni (el11-7 <unwrap-1>)
)
 (_nr (el11-8 <unwrap-1>)
)
 (_kmac (el11-9 <unwrap-1>)
)
 (sid1 (el11-10 <unwrap-1>)
)
 (_mess (el11-11 <unwrap-1>)
)
)
 (ite (= (select State ctr2)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-2> (maybe-get (select State ctr2)
)
)
)
 (let ((_U (el11-1 <unwrap-2>)
)
 (_u (el11-2 <unwrap-2>)
)
 (_V (el11-3 <unwrap-2>)
)
 (_kid (el11-4 <unwrap-2>)
)
 (acc2 (el11-5 <unwrap-2>)
)
 (_k (el11-6 <unwrap-2>)
)
 (_ni (el11-7 <unwrap-2>)
)
 (_nr (el11-8 <unwrap-2>)
)
 (_kmac (el11-9 <unwrap-2>)
)
 (sid2 (el11-10 <unwrap-2>)
)
 (_mess (el11-11 <unwrap-2>)
)
)
 (ite (= (select State ctr3)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-3> (maybe-get (select State ctr3)
)
)
)
 (let ((_U (el11-1 <unwrap-3>)
)
 (_u (el11-2 <unwrap-3>)
)
 (_V (el11-3 <unwrap-3>)
)
 (_kid (el11-4 <unwrap-3>)
)
 (acc3 (el11-5 <unwrap-3>)
)
 (_k (el11-6 <unwrap-3>)
)
 (_ni (el11-7 <unwrap-3>)
)
 (_nr (el11-8 <unwrap-3>)
)
 (_kmac (el11-9 <unwrap-3>)
)
 (sid3 (el11-10 <unwrap-3>)
)
 (_mess (el11-11 <unwrap-3>)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
)
)
)
)
)
)
)
)
)
)
)
)
(define-fun <oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-AtLeast> ((<game-state> <GameState_H7_<$<!n!>$>>)
 (<game-consts> <GameConsts_H7>)
 (sid (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
)
 <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtLeast> (let ((ctr_ (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTested (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Fresh (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (RevTestEval (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (First (<pkg-state-KX_noprfkey-<$<!n!>$>-First> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (Second (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
 (State (<pkg-state-KX_noprfkey-<$<!n!>$>-State> (<game-H7-<$<!n!>$>-pkgstate-KX> <game-state>)
)
)
)
 (let ((b (<pkg-consts-KX_noprfkey-b> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (n (<pkg-consts-KX_noprfkey-n> (<pkgconsts-H7-KX> <game-consts>)
)
)
 (zeron (<pkg-consts-KX_noprfkey-zeron> (<pkgconsts-H7-KX> <game-consts>)
)
)
)
 (ite (and (= b false)
 (not (= (select First sid)
 (as mk-none (Maybe Int)
)
)
)
 (= (select Second sid)
 (as mk-none (Maybe Int)
)
)
)
 (ite (= (select First sid)
 (as mk-none (Maybe Int)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-1> (maybe-get (select First sid)
)
)
)
 (ite (= (select State <unwrap-1>)
 (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe Bits_256)
 (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
 Int)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-2> (maybe-get (select State <unwrap-1>)
)
)
)
 (let ((_U (el11-1 <unwrap-2>)
)
 (_u (el11-2 <unwrap-2>)
)
 (_V (el11-3 <unwrap-2>)
)
 (_kid (el11-4 <unwrap-2>)
)
 (acc1 (el11-5 <unwrap-2>)
)
 (_k (el11-6 <unwrap-2>)
)
 (_ni (el11-7 <unwrap-2>)
)
 (_nr (el11-8 <unwrap-2>)
)
 (_kmac (el11-9 <unwrap-2>)
)
 (_sid (el11-10 <unwrap-2>)
)
 (_mess (el11-11 <unwrap-2>)
)
)
 (ite (= (select First sid)
 (as mk-none (Maybe Int)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> <game-state> (as mk-abort (ReturnValue Bool)
)
)
 (let ((<unwrap-3> (maybe-get (select First sid)
)
)
)
 (ite (and (= acc1 (mk-some true)
)
 (= (select Fresh <unwrap-3>)
 (mk-some true)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value true)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
)
)
)
)
)
)
)
)
 (<mk-oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast> (<mk-game-H7-<$<!n!>$>> (<game-H7-<$<!n!>$>-pkgstate-PRF> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-MAC> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Nonces> <game-state>)
 (<game-H7-<$<!n!>$>-pkgstate-Prot> <game-state>)
 (<mk-pkg-state-KX_noprfkey-<$<!n!>$>> ctr_ RevTested Fresh RevTestEval First Second State)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <game-state>)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <game-state>)
)
 (mk-return-value false)
)
)
)
)
)
(declare-const <<game-state-H7_1_0-old>> <GameState_H7_<$<!n!>$>>)
(declare-const <<game-state-H7_1_1-old>> <GameState_H7_<$<!n!>$>>)
(declare-const <<theorem-consts>> <TheoremConsts_WHSProto>)
(define-fun <<game-consts-H7_1_0>> ()
 <GameConsts_H7> (<gameconsts-WHSProto-H7_1_0> <<theorem-consts>>)
)
(define-fun <<game-consts-H7_1_1>> ()
 <GameConsts_H7> (<gameconsts-WHSProto-H7_1_1> <<theorem-consts>>)
)
(declare-const <arg-NewKey-ltk> (Maybe Bits_256)
)
(declare-const <arg-NewSession-U> Int)
(declare-const <arg-NewSession-u> Bool)
(declare-const <arg-NewSession-V> Int)
(declare-const <arg-NewSession-kid> Int)
(declare-const <arg-Send1-ctr> Int)
(declare-const <arg-Send2-ctr> Int)
(declare-const <arg-Send2-msg> Bits_256)
(declare-const <arg-Send3-ctr> Int)
(declare-const <arg-Send3-msg> (Tuple2 Bits_256 Bits_256)
)
(declare-const <arg-Send4-ctr> Int)
(declare-const <arg-Send4-msg> (Tuple2 Bits_256 Bits_256)
)
(declare-const <arg-Send5-ctr> Int)
(declare-const <arg-Send5-msg> Bits_256)
(declare-const <arg-Reveal-ctr> Int)
(declare-const <arg-Test-ctr> Int)
(declare-const <arg-SameKey-ctr1> Int)
(declare-const <arg-SameKey-ctr2> Int)
(declare-const <arg-AtMost-ctr1> Int)
(declare-const <arg-AtMost-ctr2> Int)
(declare-const <arg-AtMost-ctr3> Int)
(declare-const <arg-AtLeast-sid> (Tuple5 Int Int Bits_256 Bits_256 Bits_256)
)
(declare-const <return-H7_1_0-NewKey> <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
(assert (= <return-H7_1_0-NewKey> (<oracle-H7-H7_1_0-PRF-PRF-<$<!n!><!prf!>$>-NewKey> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-NewKey-ltk>)
)
)
(declare-const return-value-H7_1_0-PRF-NewKey (ReturnValue Int)
)
(assert (= return-value-H7_1_0-PRF-NewKey (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> <return-H7_1_0-NewKey>)
)
)
(declare-const <return-is-abort-H7_1_0-PRF-NewKey> Bool)
(assert (= <return-is-abort-H7_1_0-PRF-NewKey> (match return-value-H7_1_0-PRF-NewKey (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-NewKey>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-NewKey>> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> <return-H7_1_0-NewKey>)
)
)
(declare-const <return-H7_1_0-NewSession> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_NewSession>)
(assert (= <return-H7_1_0-NewSession> (<oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-NewSession> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-NewSession-U> <arg-NewSession-u> <arg-NewSession-V> <arg-NewSession-kid>)
)
)
(declare-const return-value-H7_1_0-KX-NewSession (ReturnValue Int)
)
(assert (= return-value-H7_1_0-KX-NewSession (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-NewSession-return-value-or-abort> <return-H7_1_0-NewSession>)
)
)
(declare-const <return-is-abort-H7_1_0-KX-NewSession> Bool)
(assert (= <return-is-abort-H7_1_0-KX-NewSession> (match return-value-H7_1_0-KX-NewSession (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-NewSession>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-NewSession>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-NewSession-game-state> <return-H7_1_0-NewSession>)
)
)
(declare-const <return-H7_1_0-Send1> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send1>)
(assert (= <return-H7_1_0-Send1> (<oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send1> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-Send1-ctr>)
)
)
(declare-const return-value-H7_1_0-KX-Send1 (ReturnValue (Tuple1 Bits_256)
)
)
(assert (= return-value-H7_1_0-KX-Send1 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1-return-value-or-abort> <return-H7_1_0-Send1>)
)
)
(declare-const <return-is-abort-H7_1_0-KX-Send1> Bool)
(assert (= <return-is-abort-H7_1_0-KX-Send1> (match return-value-H7_1_0-KX-Send1 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-Send1>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-Send1>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1-game-state> <return-H7_1_0-Send1>)
)
)
(declare-const <return-H7_1_0-Send2> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
(assert (= <return-H7_1_0-Send2> (<oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send2> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-Send2-ctr> <arg-Send2-msg>)
)
)
(declare-const return-value-H7_1_0-KX-Send2 (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
(assert (= return-value-H7_1_0-KX-Send2 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> <return-H7_1_0-Send2>)
)
)
(declare-const <return-is-abort-H7_1_0-KX-Send2> Bool)
(assert (= <return-is-abort-H7_1_0-KX-Send2> (match return-value-H7_1_0-KX-Send2 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-Send2>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-Send2>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-game-state> <return-H7_1_0-Send2>)
)
)
(declare-const <return-H7_1_0-Send3> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send3>)
(assert (= <return-H7_1_0-Send3> (<oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send3> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-Send3-ctr> <arg-Send3-msg>)
)
)
(declare-const return-value-H7_1_0-KX-Send3 (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
(assert (= return-value-H7_1_0-KX-Send3 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3-return-value-or-abort> <return-H7_1_0-Send3>)
)
)
(declare-const <return-is-abort-H7_1_0-KX-Send3> Bool)
(assert (= <return-is-abort-H7_1_0-KX-Send3> (match return-value-H7_1_0-KX-Send3 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-Send3>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-Send3>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3-game-state> <return-H7_1_0-Send3>)
)
)
(declare-const <return-H7_1_0-Send4> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send4>)
(assert (= <return-H7_1_0-Send4> (<oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send4> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-Send4-ctr> <arg-Send4-msg>)
)
)
(declare-const return-value-H7_1_0-KX-Send4 (ReturnValue (Tuple1 Bits_256)
)
)
(assert (= return-value-H7_1_0-KX-Send4 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4-return-value-or-abort> <return-H7_1_0-Send4>)
)
)
(declare-const <return-is-abort-H7_1_0-KX-Send4> Bool)
(assert (= <return-is-abort-H7_1_0-KX-Send4> (match return-value-H7_1_0-KX-Send4 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-Send4>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-Send4>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4-game-state> <return-H7_1_0-Send4>)
)
)
(declare-const <return-H7_1_0-Send5> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send5>)
(assert (= <return-H7_1_0-Send5> (<oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send5> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-Send5-ctr> <arg-Send5-msg>)
)
)
(declare-const return-value-H7_1_0-KX-Send5 (ReturnValue (Tuple1 Bool)
)
)
(assert (= return-value-H7_1_0-KX-Send5 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5-return-value-or-abort> <return-H7_1_0-Send5>)
)
)
(declare-const <return-is-abort-H7_1_0-KX-Send5> Bool)
(assert (= <return-is-abort-H7_1_0-KX-Send5> (match return-value-H7_1_0-KX-Send5 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-Send5>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-Send5>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5-game-state> <return-H7_1_0-Send5>)
)
)
(declare-const <return-H7_1_0-Reveal> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Reveal>)
(assert (= <return-H7_1_0-Reveal> (<oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Reveal> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-Reveal-ctr>)
)
)
(declare-const return-value-H7_1_0-KX-Reveal (ReturnValue Bits_256)
)
(assert (= return-value-H7_1_0-KX-Reveal (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal-return-value-or-abort> <return-H7_1_0-Reveal>)
)
)
(declare-const <return-is-abort-H7_1_0-KX-Reveal> Bool)
(assert (= <return-is-abort-H7_1_0-KX-Reveal> (match return-value-H7_1_0-KX-Reveal (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-Reveal>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-Reveal>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal-game-state> <return-H7_1_0-Reveal>)
)
)
(declare-const <return-H7_1_0-Test> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Test>)
(assert (= <return-H7_1_0-Test> (<oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Test> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-Test-ctr>)
)
)
(declare-const return-value-H7_1_0-KX-Test (ReturnValue Bits_256)
)
(assert (= return-value-H7_1_0-KX-Test (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test-return-value-or-abort> <return-H7_1_0-Test>)
)
)
(declare-const <return-is-abort-H7_1_0-KX-Test> Bool)
(assert (= <return-is-abort-H7_1_0-KX-Test> (match return-value-H7_1_0-KX-Test (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-Test>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-Test>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test-game-state> <return-H7_1_0-Test>)
)
)
(declare-const <return-H7_1_0-SameKey> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_SameKey>)
(assert (= <return-H7_1_0-SameKey> (<oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-SameKey> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-SameKey-ctr1> <arg-SameKey-ctr2>)
)
)
(declare-const return-value-H7_1_0-KX-SameKey (ReturnValue Bool)
)
(assert (= return-value-H7_1_0-KX-SameKey (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey-return-value-or-abort> <return-H7_1_0-SameKey>)
)
)
(declare-const <return-is-abort-H7_1_0-KX-SameKey> Bool)
(assert (= <return-is-abort-H7_1_0-KX-SameKey> (match return-value-H7_1_0-KX-SameKey (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-SameKey>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-SameKey>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey-game-state> <return-H7_1_0-SameKey>)
)
)
(declare-const <return-H7_1_0-AtMost> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtMost>)
(assert (= <return-H7_1_0-AtMost> (<oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-AtMost> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-AtMost-ctr1> <arg-AtMost-ctr2> <arg-AtMost-ctr3>)
)
)
(declare-const return-value-H7_1_0-KX-AtMost (ReturnValue Bool)
)
(assert (= return-value-H7_1_0-KX-AtMost (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost-return-value-or-abort> <return-H7_1_0-AtMost>)
)
)
(declare-const <return-is-abort-H7_1_0-KX-AtMost> Bool)
(assert (= <return-is-abort-H7_1_0-KX-AtMost> (match return-value-H7_1_0-KX-AtMost (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-AtMost>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-AtMost>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost-game-state> <return-H7_1_0-AtMost>)
)
)
(declare-const <return-H7_1_0-AtLeast> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtLeast>)
(assert (= <return-H7_1_0-AtLeast> (<oracle-H7-H7_1_0-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-AtLeast> <<game-state-H7_1_0-old>> <<game-consts-H7_1_0>> <arg-AtLeast-sid>)
)
)
(declare-const return-value-H7_1_0-KX-AtLeast (ReturnValue Bool)
)
(assert (= return-value-H7_1_0-KX-AtLeast (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast-return-value-or-abort> <return-H7_1_0-AtLeast>)
)
)
(declare-const <return-is-abort-H7_1_0-KX-AtLeast> Bool)
(assert (= <return-is-abort-H7_1_0-KX-AtLeast> (match return-value-H7_1_0-KX-AtLeast (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_0-new-AtLeast>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_0-new-AtLeast>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast-game-state> <return-H7_1_0-AtLeast>)
)
)
(declare-const <return-H7_1_1-NewKey> <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
(assert (= <return-H7_1_1-NewKey> (<oracle-H7-H7_1_1-PRF-PRF-<$<!n!><!prf!>$>-NewKey> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-NewKey-ltk>)
)
)
(declare-const return-value-H7_1_1-PRF-NewKey (ReturnValue Int)
)
(assert (= return-value-H7_1_1-PRF-NewKey (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> <return-H7_1_1-NewKey>)
)
)
(declare-const <return-is-abort-H7_1_1-PRF-NewKey> Bool)
(assert (= <return-is-abort-H7_1_1-PRF-NewKey> (match return-value-H7_1_1-PRF-NewKey (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-NewKey>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-NewKey>> (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> <return-H7_1_1-NewKey>)
)
)
(declare-const <return-H7_1_1-NewSession> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_NewSession>)
(assert (= <return-H7_1_1-NewSession> (<oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-NewSession> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-NewSession-U> <arg-NewSession-u> <arg-NewSession-V> <arg-NewSession-kid>)
)
)
(declare-const return-value-H7_1_1-KX-NewSession (ReturnValue Int)
)
(assert (= return-value-H7_1_1-KX-NewSession (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-NewSession-return-value-or-abort> <return-H7_1_1-NewSession>)
)
)
(declare-const <return-is-abort-H7_1_1-KX-NewSession> Bool)
(assert (= <return-is-abort-H7_1_1-KX-NewSession> (match return-value-H7_1_1-KX-NewSession (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-NewSession>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-NewSession>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-NewSession-game-state> <return-H7_1_1-NewSession>)
)
)
(declare-const <return-H7_1_1-Send1> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send1>)
(assert (= <return-H7_1_1-Send1> (<oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send1> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-Send1-ctr>)
)
)
(declare-const return-value-H7_1_1-KX-Send1 (ReturnValue (Tuple1 Bits_256)
)
)
(assert (= return-value-H7_1_1-KX-Send1 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1-return-value-or-abort> <return-H7_1_1-Send1>)
)
)
(declare-const <return-is-abort-H7_1_1-KX-Send1> Bool)
(assert (= <return-is-abort-H7_1_1-KX-Send1> (match return-value-H7_1_1-KX-Send1 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-Send1>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-Send1>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1-game-state> <return-H7_1_1-Send1>)
)
)
(declare-const <return-H7_1_1-Send2> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
(assert (= <return-H7_1_1-Send2> (<oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send2> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-Send2-ctr> <arg-Send2-msg>)
)
)
(declare-const return-value-H7_1_1-KX-Send2 (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
(assert (= return-value-H7_1_1-KX-Send2 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> <return-H7_1_1-Send2>)
)
)
(declare-const <return-is-abort-H7_1_1-KX-Send2> Bool)
(assert (= <return-is-abort-H7_1_1-KX-Send2> (match return-value-H7_1_1-KX-Send2 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-Send2>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-Send2>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-game-state> <return-H7_1_1-Send2>)
)
)
(declare-const <return-H7_1_1-Send3> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send3>)
(assert (= <return-H7_1_1-Send3> (<oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send3> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-Send3-ctr> <arg-Send3-msg>)
)
)
(declare-const return-value-H7_1_1-KX-Send3 (ReturnValue (Tuple2 Bits_256 Bits_256)
)
)
(assert (= return-value-H7_1_1-KX-Send3 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3-return-value-or-abort> <return-H7_1_1-Send3>)
)
)
(declare-const <return-is-abort-H7_1_1-KX-Send3> Bool)
(assert (= <return-is-abort-H7_1_1-KX-Send3> (match return-value-H7_1_1-KX-Send3 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-Send3>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-Send3>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send3-game-state> <return-H7_1_1-Send3>)
)
)
(declare-const <return-H7_1_1-Send4> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send4>)
(assert (= <return-H7_1_1-Send4> (<oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send4> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-Send4-ctr> <arg-Send4-msg>)
)
)
(declare-const return-value-H7_1_1-KX-Send4 (ReturnValue (Tuple1 Bits_256)
)
)
(assert (= return-value-H7_1_1-KX-Send4 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4-return-value-or-abort> <return-H7_1_1-Send4>)
)
)
(declare-const <return-is-abort-H7_1_1-KX-Send4> Bool)
(assert (= <return-is-abort-H7_1_1-KX-Send4> (match return-value-H7_1_1-KX-Send4 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-Send4>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-Send4>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send4-game-state> <return-H7_1_1-Send4>)
)
)
(declare-const <return-H7_1_1-Send5> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send5>)
(assert (= <return-H7_1_1-Send5> (<oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Send5> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-Send5-ctr> <arg-Send5-msg>)
)
)
(declare-const return-value-H7_1_1-KX-Send5 (ReturnValue (Tuple1 Bool)
)
)
(assert (= return-value-H7_1_1-KX-Send5 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5-return-value-or-abort> <return-H7_1_1-Send5>)
)
)
(declare-const <return-is-abort-H7_1_1-KX-Send5> Bool)
(assert (= <return-is-abort-H7_1_1-KX-Send5> (match return-value-H7_1_1-KX-Send5 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-Send5>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-Send5>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5-game-state> <return-H7_1_1-Send5>)
)
)
(declare-const <return-H7_1_1-Reveal> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Reveal>)
(assert (= <return-H7_1_1-Reveal> (<oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Reveal> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-Reveal-ctr>)
)
)
(declare-const return-value-H7_1_1-KX-Reveal (ReturnValue Bits_256)
)
(assert (= return-value-H7_1_1-KX-Reveal (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal-return-value-or-abort> <return-H7_1_1-Reveal>)
)
)
(declare-const <return-is-abort-H7_1_1-KX-Reveal> Bool)
(assert (= <return-is-abort-H7_1_1-KX-Reveal> (match return-value-H7_1_1-KX-Reveal (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-Reveal>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-Reveal>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Reveal-game-state> <return-H7_1_1-Reveal>)
)
)
(declare-const <return-H7_1_1-Test> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Test>)
(assert (= <return-H7_1_1-Test> (<oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-Test> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-Test-ctr>)
)
)
(declare-const return-value-H7_1_1-KX-Test (ReturnValue Bits_256)
)
(assert (= return-value-H7_1_1-KX-Test (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test-return-value-or-abort> <return-H7_1_1-Test>)
)
)
(declare-const <return-is-abort-H7_1_1-KX-Test> Bool)
(assert (= <return-is-abort-H7_1_1-KX-Test> (match return-value-H7_1_1-KX-Test (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-Test>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-Test>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test-game-state> <return-H7_1_1-Test>)
)
)
(declare-const <return-H7_1_1-SameKey> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_SameKey>)
(assert (= <return-H7_1_1-SameKey> (<oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-SameKey> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-SameKey-ctr1> <arg-SameKey-ctr2>)
)
)
(declare-const return-value-H7_1_1-KX-SameKey (ReturnValue Bool)
)
(assert (= return-value-H7_1_1-KX-SameKey (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey-return-value-or-abort> <return-H7_1_1-SameKey>)
)
)
(declare-const <return-is-abort-H7_1_1-KX-SameKey> Bool)
(assert (= <return-is-abort-H7_1_1-KX-SameKey> (match return-value-H7_1_1-KX-SameKey (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-SameKey>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-SameKey>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-SameKey-game-state> <return-H7_1_1-SameKey>)
)
)
(declare-const <return-H7_1_1-AtMost> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtMost>)
(assert (= <return-H7_1_1-AtMost> (<oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-AtMost> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-AtMost-ctr1> <arg-AtMost-ctr2> <arg-AtMost-ctr3>)
)
)
(declare-const return-value-H7_1_1-KX-AtMost (ReturnValue Bool)
)
(assert (= return-value-H7_1_1-KX-AtMost (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost-return-value-or-abort> <return-H7_1_1-AtMost>)
)
)
(declare-const <return-is-abort-H7_1_1-KX-AtMost> Bool)
(assert (= <return-is-abort-H7_1_1-KX-AtMost> (match return-value-H7_1_1-KX-AtMost (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-AtMost>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-AtMost>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtMost-game-state> <return-H7_1_1-AtMost>)
)
)
(declare-const <return-H7_1_1-AtLeast> <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtLeast>)
(assert (= <return-H7_1_1-AtLeast> (<oracle-H7-H7_1_1-KX_noprfkey-KX-<$<!mac!><!n!><!prf!>$>-AtLeast> <<game-state-H7_1_1-old>> <<game-consts-H7_1_1>> <arg-AtLeast-sid>)
)
)
(declare-const return-value-H7_1_1-KX-AtLeast (ReturnValue Bool)
)
(assert (= return-value-H7_1_1-KX-AtLeast (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast-return-value-or-abort> <return-H7_1_1-AtLeast>)
)
)
(declare-const <return-is-abort-H7_1_1-KX-AtLeast> Bool)
(assert (= <return-is-abort-H7_1_1-KX-AtLeast> (match return-value-H7_1_1-KX-AtLeast (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
(declare-const <<game-state-H7_1_1-new-AtLeast>> <GameState_H7_<$<!n!>$>>)
(assert (= <<game-state-H7_1_1-new-AtLeast>> (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast-game-state> <return-H7_1_1-AtLeast>)
)
)
(declare-const randctr-H7_1_0-0 Int)
(assert (= randctr-H7_1_0-0 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <<game-state-H7_1_0-old>>)
)
)
(declare-const randval-H7_1_0-0 Bits_256)
(assert (= randval-H7_1_0-0 (__sample-rand-H7_1_0-Bits_256 (sample-id "PRF" "NewKey" "1")
 (+ 0 randctr-H7_1_0-0)
)
)
)
(declare-const randctr-H7_1_0-1 Int)
(assert (= randctr-H7_1_0-1 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <<game-state-H7_1_0-old>>)
)
)
(declare-const randval-H7_1_0-1 Bits_256)
(assert (= randval-H7_1_0-1 (__sample-rand-H7_1_0-Bits_256 (sample-id "PRF" "Eval" "1")
 (+ 0 randctr-H7_1_0-1)
)
)
)
(declare-const randctr-H7_1_0-2 Int)
(assert (= randctr-H7_1_0-2 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <<game-state-H7_1_0-old>>)
)
)
(declare-const randval-H7_1_0-2 Bits_256)
(assert (= randval-H7_1_0-2 (__sample-rand-H7_1_0-Bits_256 (sample-id "MAC" "Init" "1")
 (+ 0 randctr-H7_1_0-2)
)
)
)
(declare-const randctr-H7_1_0-3 Int)
(assert (= randctr-H7_1_0-3 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <<game-state-H7_1_0-old>>)
)
)
(declare-const randval-H7_1_0-3 Bits_256)
(assert (= randval-H7_1_0-3 (__sample-rand-H7_1_0-Bits_256 (sample-id "Nonces" "Sample" "1")
 (+ 0 randctr-H7_1_0-3)
)
)
)
(declare-const randctr-H7_1_0-4 Int)
(assert (= randctr-H7_1_0-4 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <<game-state-H7_1_0-old>>)
)
)
(declare-const randval-H7_1_0-4 Bits_256)
(assert (= randval-H7_1_0-4 (__sample-rand-H7_1_0-Bits_256 (sample-id "KX" "Test" "1")
 (+ 0 randctr-H7_1_0-4)
)
)
)
(declare-const randctr-H7_1_1-0 Int)
(assert (= randctr-H7_1_1-0 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <<game-state-H7_1_1-old>>)
)
)
(declare-const randval-H7_1_1-0 Bits_256)
(assert (= randval-H7_1_1-0 (__sample-rand-H7_1_1-Bits_256 (sample-id "PRF" "NewKey" "1")
 (+ 0 randctr-H7_1_1-0)
)
)
)
(declare-const randctr-H7_1_1-1 Int)
(assert (= randctr-H7_1_1-1 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <<game-state-H7_1_1-old>>)
)
)
(declare-const randval-H7_1_1-1 Bits_256)
(assert (= randval-H7_1_1-1 (__sample-rand-H7_1_1-Bits_256 (sample-id "PRF" "Eval" "1")
 (+ 0 randctr-H7_1_1-1)
)
)
)
(declare-const randctr-H7_1_1-2 Int)
(assert (= randctr-H7_1_1-2 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <<game-state-H7_1_1-old>>)
)
)
(declare-const randval-H7_1_1-2 Bits_256)
(assert (= randval-H7_1_1-2 (__sample-rand-H7_1_1-Bits_256 (sample-id "MAC" "Init" "1")
 (+ 0 randctr-H7_1_1-2)
)
)
)
(declare-const randctr-H7_1_1-3 Int)
(assert (= randctr-H7_1_1-3 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <<game-state-H7_1_1-old>>)
)
)
(declare-const randval-H7_1_1-3 Bits_256)
(assert (= randval-H7_1_1-3 (__sample-rand-H7_1_1-Bits_256 (sample-id "Nonces" "Sample" "1")
 (+ 0 randctr-H7_1_1-3)
)
)
)
(declare-const randctr-H7_1_1-4 Int)
(assert (= randctr-H7_1_1-4 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <<game-state-H7_1_1-old>>)
)
)
(declare-const randval-H7_1_1-4 Bits_256)
(assert (= randval-H7_1_1-4 (__sample-rand-H7_1_1-Bits_256 (sample-id "KX" "Test" "1")
 (+ 0 randctr-H7_1_1-4)
)
)
)
(define-fun get-rand-ctr-H7_1_0 ((sampleid SampleId)
)
 Int (ite (= sampleid (sample-id "KX" "Test" "1")
)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <<game-state-H7_1_0-old>>)
 (ite (= sampleid (sample-id "Nonces" "Sample" "1")
)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <<game-state-H7_1_0-old>>)
 (ite (= sampleid (sample-id "MAC" "Init" "1")
)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <<game-state-H7_1_0-old>>)
 (ite (= sampleid (sample-id "PRF" "Eval" "1")
)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <<game-state-H7_1_0-old>>)
 (ite (= sampleid (sample-id "PRF" "NewKey" "1")
)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <<game-state-H7_1_0-old>>)
 0)
)
)
)
)
)
(define-fun get-rand-ctr-H7_1_1 ((sampleid SampleId)
)
 Int (ite (= sampleid (sample-id "KX" "Test" "1")
)
 (<game-H7-<$<!n!>$>-rand-KX-Test-1> <<game-state-H7_1_1-old>>)
 (ite (= sampleid (sample-id "Nonces" "Sample" "1")
)
 (<game-H7-<$<!n!>$>-rand-Nonces-Sample-1> <<game-state-H7_1_1-old>>)
 (ite (= sampleid (sample-id "MAC" "Init" "1")
)
 (<game-H7-<$<!n!>$>-rand-MAC-Init-1> <<game-state-H7_1_1-old>>)
 (ite (= sampleid (sample-id "PRF" "Eval" "1")
)
 (<game-H7-<$<!n!>$>-rand-PRF-Eval-1> <<game-state-H7_1_1-old>>)
 (ite (= sampleid (sample-id "PRF" "NewKey" "1")
)
 (<game-H7-<$<!n!>$>-rand-PRF-NewKey-1> <<game-state-H7_1_1-old>>)
 0)
)
)
)
)
)
(define-fun rand-is-eq ((sample-id-left SampleId)
 (sample-id-right SampleId)
 (sample-ctr-left Int)
 (sample-ctr-right Int)
)
 Bool (ite (and (or (= (sample-id "PRF" "NewKey" "1")
 sample-id-left)
 (= (sample-id "PRF" "Eval" "1")
 sample-id-left)
 (= (sample-id "MAC" "Init" "1")
 sample-id-left)
 (= (sample-id "Nonces" "Sample" "1")
 sample-id-left)
 (= (sample-id "KX" "Test" "1")
 sample-id-left)
)
 (or (= (sample-id "PRF" "NewKey" "1")
 sample-id-right)
 (= (sample-id "PRF" "Eval" "1")
 sample-id-right)
 (= (sample-id "MAC" "Init" "1")
 sample-id-right)
 (= (sample-id "Nonces" "Sample" "1")
 sample-id-right)
 (= (sample-id "KX" "Test" "1")
 sample-id-right)
)
)
 (= (__sample-rand-H7_1_0-Bits_256 sample-id-left sample-ctr-left)
 (__sample-rand-H7_1_1-Bits_256 sample-id-right sample-ctr-right)
)
 true)
)
(push 1)(declare-const <equal-aborts> Bool)
(assert (= <equal-aborts> (= (match return-value-H7_1_0-KX-Send2 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
 (match return-value-H7_1_1-KX-Send2 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
)
(declare-const <no-aborts> Bool)
(assert (= <no-aborts> (and (not (match return-value-H7_1_0-KX-Send2 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
 (not (match return-value-H7_1_1-KX-Send2 (((mk-return-value returnvalue)
 false)
 (mk-abort true)
)
)
)
)
)
)
(declare-const <same-outputs> Bool)
(assert (= <same-outputs> (= return-value-H7_1_0-KX-Send2 return-value-H7_1_1-KX-Send2)
)
)
(define-fun <relation-equal-aborts-H7_1_0-H7_1_1-Send2> ((old-state-left <GameState_H7_<$<!n!>$>>)
 (old-state-right <GameState_H7_<$<!n!>$>>)
 (return-left <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
 (return-right <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
 (ctr Int)
 (msg Bits_256)
)
 Bool (let ((return-value-left (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> return-left)
)
 (return-value-right (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> return-right)
)
)
 (= ((_ is mk-abort)
 return-value-left)
 ((_ is mk-abort)
 return-value-right)
)
)
)
(define-fun <relation-left-no-abort-H7_1_0-H7_1_1-Send2> ((old-state-left <GameState_H7_<$<!n!>$>>)
 (old-state-right <GameState_H7_<$<!n!>$>>)
 (return-left <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
 (return-right <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
 (ctr Int)
 (msg Bits_256)
)
 Bool (not ((_ is mk-abort)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> return-left)
)
)
)
(define-fun <relation-right-no-abort-H7_1_0-H7_1_1-Send2> ((old-state-left <GameState_H7_<$<!n!>$>>)
 (old-state-right <GameState_H7_<$<!n!>$>>)
 (return-left <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
 (return-right <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
 (ctr Int)
 (msg Bits_256)
)
 Bool (not ((_ is mk-abort)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> return-right)
)
)
)
(define-fun <relation-no-abort-H7_1_0-H7_1_1-Send2> ((old-state-left <GameState_H7_<$<!n!>$>>)
 (old-state-right <GameState_H7_<$<!n!>$>>)
 (return-left <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
 (return-right <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
 (ctr Int)
 (msg Bits_256)
)
 Bool (and (not ((_ is mk-abort)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> return-left)
)
)
 (not ((_ is mk-abort)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> return-right)
)
)
)
)
(define-fun <relation-same-output-H7_1_0-H7_1_1-Send2> ((old-state-left <GameState_H7_<$<!n!>$>>)
 (old-state-right <GameState_H7_<$<!n!>$>>)
 (return-left <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
 (return-right <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
 (ctr Int)
 (msg Bits_256)
)
 Bool (= (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> return-left)
 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> return-right)
)
)


(define-fun select-kmac
    ((ctr Int)
     (State (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (Fresh (Array Int (Maybe Bool)))
     (Keys (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Bits_256))))
  (Maybe Bits_256)
  (let ((state (select State ctr)))
    (ite (is-mk-none state)
         (as mk-none (Maybe Bits_256))
         (let  ((U    (el11-1  (maybe-get state)))
                (u    (el11-2  (maybe-get state)))
                (V    (el11-3  (maybe-get state)))
                (kid  (el11-4  (maybe-get state)))
                (acc  (el11-5  (maybe-get state)))
                (k    (el11-6  (maybe-get state)))
                (ni   (el11-7  (maybe-get state)))
                (nr   (el11-8  (maybe-get state)))
                (kmac (el11-9  (maybe-get state)))
                (sid  (el11-10 (maybe-get state)))
                (mess (el11-11 (maybe-get state))))
           (ite (= (select Fresh ctr) (mk-some true))
                (select Keys (mk-tuple5 kid U V
                                        (maybe-get ni)
                                        (maybe-get nr)))
                kmac)))))




(define-fun prfeval-has-matching-session
    ((prf (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool) (Maybe Bits_256)))
     (revtesteval (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Int)))
     (revtesteval1 (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Int)))
     (revtest (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256) (Maybe Bool)))
     (state (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (Fresh (Array Int (Maybe Bool)))
     (Keys (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Bits_256))))
  Bool
  (let ((none (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                          (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                          (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int)))))
    (forall ((kid Int) (U Int) (V Int) (ni Bits_256) (nr Bits_256))
            (let ((pos-prf (mk-tuple6 kid U V ni nr true))
                  (pos-rev (mk-tuple5 kid U V ni nr)))
              (and (=> (not (is-mk-none (select prf pos-prf)))
                       (not (is-mk-none (select revtesteval pos-rev))))
                   (=> (not (is-mk-none (select revtesteval pos-rev)))
                       (let ((ctr (maybe-get (select revtesteval pos-rev)))
                             (st (select state (maybe-get (select revtesteval pos-rev)))))
                         (and
                          (not (is-mk-none st))
                          (let  ((Up   (el11-1  (maybe-get st)))
                                 (u    (el11-2  (maybe-get st)))
                                 (Vp   (el11-3  (maybe-get st)))
                                 (kidp (el11-4  (maybe-get st)))
                                 (acc  (el11-5  (maybe-get st)))
                                 (k    (el11-6  (maybe-get st)))
                                 (nip  (el11-7  (maybe-get st)))
                                 (nrp  (el11-8  (maybe-get st)))
                                 (kmac (el11-9  (maybe-get st)))
                                 (sid  (el11-10 (maybe-get st)))
                                 (mess (el11-11 (maybe-get st))))
                            (and
                             (= acc (mk-some true))
                             (not (is-mk-none sid))
                             (= ni (maybe-get nip))
                             (= nr (maybe-get nrp))
                             (= U Up)
                             (= V Vp)
                             (= kid kidp)
                             (let ((kmac (ite (= (select Fresh ctr) (mk-some true))
                                              (select Keys (mk-tuple5 kid U V ni nr))
                                              kmac)))
                               (let ((tau (<<func-mac>> (maybe-get kmac) nr 2)))
                                 (= (mk-tuple5 U V ni nr tau)
                                    (maybe-get sid))))
                             (not (= (select revtest (maybe-get sid))
                                     (as mk-none (Maybe Bool))))))))))))))


(define-fun sid-matches
    ((state (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (prf (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool) (Maybe Bits_256))))
  Bool
  (let ((none (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                          (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                          (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int)))))
    (forall ((ctr1 Int) (ctr2 Int))
            (let ((state1 (select state ctr1))
                  (state2 (select state ctr2)))
            (=> (and (not (= none state1))
                     (not (= none state2)))
                (let ((U1    (el11-1 (maybe-get state1)))
                      (U2    (el11-1 (maybe-get state2)))
                      (u1    (el11-2 (maybe-get state1)))
                      (u2    (el11-2 (maybe-get state2)))
                      (V1    (el11-3 (maybe-get state1)))
                      (V2    (el11-3 (maybe-get state2)))
                      (kid1  (el11-4 (maybe-get state1)))
                      (kid2  (el11-4 (maybe-get state2)))
                      (ni1   (el11-7 (maybe-get state1)))
                      (ni2   (el11-7 (maybe-get state2)))
                      (nr1   (el11-8 (maybe-get state1)))
                      (nr2   (el11-8 (maybe-get state2)))
                      (kmac1 (el11-9 (maybe-get state1)))
                      (kmac2 (el11-9 (maybe-get state2)))
                      (sid1  (el11-10 (maybe-get state1)))
                      (sid2  (el11-10 (maybe-get state2))))
                  (=> (and (not (= sid1 (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)))))
                           (not (= sid2 (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)))))
                           (= (mk-tuple5 kid1 U1 V1 ni1 nr1)
                              (mk-tuple5 kid2 U2 V2 ni2 nr2)))
                      (= sid1 sid2))))))))


(define-fun sid-is-wellformed
    ((state (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (prf (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool) (Maybe Bits_256)))
     (Fresh (Array Int (Maybe Bool)))
     (Keys (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Bits_256))))
  Bool
  (forall ((ctr Int))
          (let ((state (select state ctr)))
            (=> (not (is-mk-none state))
                (let  ((U    (el11-1  (maybe-get state)))
                       (u    (el11-2  (maybe-get state)))
                       (V    (el11-3  (maybe-get state)))
                       (kid  (el11-4  (maybe-get state)))
                       (acc  (el11-5  (maybe-get state)))
                       (k    (el11-6  (maybe-get state)))
                       (ni   (el11-7  (maybe-get state)))
                       (nr   (el11-8  (maybe-get state)))
                       (kmac (el11-9  (maybe-get state)))
                       (sid  (el11-10 (maybe-get state)))
                       (mess (el11-11 (maybe-get state))))
                  (=> (not (is-mk-none sid))
                      (let ((kmac (ite (= (select Fresh ctr) (mk-some true))
                                       (select Keys (mk-tuple5 kid U V
                                                               (maybe-get ni)
                                                               (maybe-get nr)))
                                       kmac)))
                        (and
                         (not (is-mk-none kmac))
                         (let ((tau (<<func-mac>> (maybe-get kmac) (maybe-get nr) 2)))
                           (= (mk-tuple5 U V
                                         (maybe-get ni)
                                         (maybe-get nr)
                                         tau)
                              (maybe-get sid)))))))))))


(define-fun key-not-computed-unless-test-or-reveal
    ((state (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (revtest (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256) (Maybe Bool)))
     (prf (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool) (Maybe Bits_256)))
     (H (Array Int (Maybe Bool)))
     (Keys (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Bits_256))))
  Bool
  (and
   ;; mac keys are computed before output keys
   (forall ((kid Int)
            (U Int)
            (V Int)
            (ni Bits_256)
            (nr Bits_256))
           (=> (not (= (select prf (mk-tuple6 kid U V ni nr true))
                       (as mk-none (Maybe Bits_256))))
               (ite (= (select H kid) (mk-some true))
                    (not (is-mk-none (select Keys (mk-tuple5 kid U V ni nr))))
                    (not (is-mk-none (select prf (mk-tuple6 kid U V ni nr false)))))))

   ;; output keys are only computed when revtesting
   (forall ((kid Int)
            (U Int)
            (V Int)
            (ni Bits_256)
            (nr Bits_256)
            (kmac-prime Bits_256))
           (and
            ;; entry in PRF table => entry in revtest
            (=> (not (is-mk-none (select prf (mk-tuple6 kid U V ni nr true))))
                (let ((kmac (ite (= (select H kid) (mk-some true))
                                 (select Keys (mk-tuple5 kid U V ni nr))
                                 (select prf (mk-tuple6 kid U V ni nr false)))))
                  (let ((tau (<<func-mac>> (maybe-get kmac) nr 2)))
                    (not (= (select revtest (mk-tuple5 U V ni nr tau))
                            (as mk-none (Maybe Bool)))))))

            ;; revtest none => prf none
            (=> (let ((tau (<<func-mac>> kmac-prime nr 2)))
                  (= (select revtest (mk-tuple5 U V ni nr tau))
                     (as mk-none (Maybe Bool))))
                (=> (= (ite (= (select H kid) (mk-some true))
                                     (select Keys (mk-tuple5 kid U V ni nr))
                                     (select prf (mk-tuple6 kid U V ni nr false)))
                       (mk-some kmac-prime))
                    (= (select prf (mk-tuple6 kid U V ni nr true))
                       (as mk-none (Maybe Bits_256)))))))))

(define-fun key-not-computed-unless-reveal
    ((state (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (revtest (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256) (Maybe Bool)))
     (prf (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool) (Maybe Bits_256)))
     (H (Array Int (Maybe Bool)))
     (Keys (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Bits_256))))
  Bool
  (and
   ;; mac keys are computed before output keys
   (forall ((kid Int)
            (U Int)
            (V Int)
            (ni Bits_256)
            (nr Bits_256))
           (=> (not (= (select prf (mk-tuple6 kid U V ni nr true))
                       (as mk-none (Maybe Bits_256))))
               (ite (= (select H kid) (mk-some true))
                    (not (is-mk-none (select Keys (mk-tuple5 kid U V ni nr))))
                    (not (is-mk-none (select prf (mk-tuple6 kid U V ni nr false)))))))

   ;; output keys are only computed when revealing
   (forall ((kid Int)
            (U Int)
            (V Int)
            (ni Bits_256)
            (nr Bits_256)
            (kmac-prime Bits_256))
           (and
            ;; entry in PRF table => false entry in revtest
            (=> (not (is-mk-none (select prf (mk-tuple6 kid U V ni nr true))))
                (let ((kmac (ite (= (select H kid) (mk-some true))
                                 (select Keys (mk-tuple5 kid U V ni nr))
                                 (select prf (mk-tuple6 kid U V ni nr false)))))
                  (let ((tau (<<func-mac>> (maybe-get kmac) nr 2)))
                         (= (select revtest (mk-tuple5 U V ni nr tau))
                            (mk-some false)))))

            ;; revtest none => prf none
            (=> (let ((tau (<<func-mac>> kmac-prime nr 2)))
                  (= (select revtest (mk-tuple5 U V ni nr tau))
                     (as mk-none (Maybe Bool))))
                (=> (= (ite (= (select H kid) (mk-some true))
                                     (select Keys (mk-tuple5 kid U V ni nr))
                                     (select prf (mk-tuple6 kid U V ni nr false)))
                       (mk-some kmac-prime))
                    (= (select prf (mk-tuple6 kid U V ni nr true))
                       (as mk-none (Maybe Bits_256)))))
            ;; tested => prf none
            (=> (let ((tau (<<func-mac>> kmac-prime nr 2)))
                  (= (select revtest (mk-tuple5 U V ni nr tau))
                     (mk-some true)))
                (=> (= (ite (= (select H kid) (mk-some true))
                                     (select Keys (mk-tuple5 kid U V ni nr))
                                     (select prf (mk-tuple6 kid U V ni nr false)))
                       (mk-some kmac-prime))
                    (= (select prf (mk-tuple6 kid U V ni nr true))
                       (as mk-none (Maybe Bits_256)))))            
                       ))))


;; Some consistency checks on the PRF package
;;
;; (i) LTK and H are written at the same locations
;; (ii) neither is written on larger indices than kid
;;
(define-fun no-overwriting-prf
    ((kid Int)
     (Prf (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool) (Maybe Bits_256)))
     (H (Array Int (Maybe Bool)))
     (Keys (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Bits_256)))
     (Ltk (Array Int (Maybe Bits_256))))
  Bool
    (forall ((i Int) (U Int) (V Int) (ni Bits_256) (nr Bits_256))
            (and
             (=> (= (select H i) (as mk-none (Maybe Bool)))
                 (= (select Ltk i) (as mk-none (Maybe Bits_256))))
             (=> (= (select Ltk i) (as mk-none (Maybe Bits_256)))
                 (= (select H i) (as mk-none (Maybe Bool))))
             (=> (> i kid)
                 (and
                  (is-mk-none (select H i))
                  (is-mk-none (select Ltk i))
                  (is-mk-none (select Keys (mk-tuple5 i U V ni nr)))
                  (is-mk-none (select Prf (mk-tuple6 i U V ni nr true)))
                  (is-mk-none (select Prf (mk-tuple6 i U V ni nr false))))))))

(define-fun no-overwriting-game
    ((state (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (ctr Int))
  Bool
  (forall ((i Int))
          (=> (> i ctr)
              (is-mk-none (select state i)))))


(define-fun mac-keys-equal-in-prf
    ((prf0 (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool) (Maybe Bits_256)))
     (prf1 (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool) (Maybe Bits_256))))
  Bool
  (forall ((in (Tuple6 Int Int Int Bits_256 Bits_256 Bool)))
          (=> (= false (el6-6 in))
              (= (select prf0 in)
                 (select prf1 in)))))


(define-fun kmac-and-tau-are-computed-correctly
    ((state (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (prf (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool) (Maybe Bits_256)))
     (honesty (Array Int (Maybe Bool)))
     (ltk (Array Int (Maybe Bits_256)))
     (Fresh (Array Int (Maybe Bool)))
     (Keys (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Bits_256))))
  Bool
  (let ((none (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                          (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                          (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int)))))
    (forall ((ctr Int))
            (let ((state (select state ctr)))
              (=> (not (= state none))
                  (let  ((U    (el11-1  (maybe-get state)))
                         (u    (el11-2  (maybe-get state)))
                         (V    (el11-3  (maybe-get state)))
                         (kid  (el11-4  (maybe-get state)))
                         (acc  (el11-5  (maybe-get state)))
                         (k    (el11-6  (maybe-get state)))
                         (ni   (el11-7  (maybe-get state)))
                         (nr   (el11-8  (maybe-get state)))
                         (kmac (el11-9  (maybe-get state)))
                         (sid  (el11-10 (maybe-get state)))
                         (mess (el11-11 (maybe-get state))))
                    (and
                     (not (= (select ltk kid) (as mk-none (Maybe Bits_256))))
                     (not (= (select honesty kid) (as mk-none (Maybe Bool))))
                     (and
                      (=> (and (not (= kmac (as mk-none (Maybe Bits_256))))
                               (= (select honesty kid) (mk-some false)))
                          (= kmac (mk-some (<<func-prf>> (maybe-get (select ltk kid)) U V
                                                         (maybe-get ni) (maybe-get nr) false))))))))))))


(define-fun stuff-not-initialized-early
    ((State (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (Fresh (Array Int (Maybe Bool)))
     (Keys (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Bits_256))))
  Bool
  (let ((none (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                          (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                          (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int)))))
    (forall ((ctr Int))
            (let ((state (select State ctr)))
              (=> (not (= state none))
                  (let  ((U    (el11-1  (maybe-get state)))
                         (u    (el11-2  (maybe-get state)))
                         (V    (el11-3  (maybe-get state)))
                         (kid  (el11-4  (maybe-get state)))
                         (acc  (el11-5  (maybe-get state)))
                         (k    (el11-6  (maybe-get state)))
                         (ni   (el11-7  (maybe-get state)))
                         (nr   (el11-8  (maybe-get state)))
                         (kmac (el11-9  (maybe-get state)))
                         (sid  (el11-10 (maybe-get state)))
                         (mess (el11-11 (maybe-get state))))
                    (and (ite u
                              (ite (> mess 0)
                                   (and (not (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)))))
                                        (ite (= (select Fresh ctr) (mk-some true))
                                             (not (is-mk-none (select Keys (mk-tuple5 kid U V (maybe-get ni) (maybe-get nr)))))
                                             (not (is-mk-none kmac)))
                                        (not (= ni (as mk-none (Maybe Bits_256))))
                                        (not (= nr (as mk-none (Maybe Bits_256)))))
                                   (and (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256))))
                                        (= ni nr kmac (as mk-none (Maybe Bits_256)))))
                              (ite (= mess 0)
                                   (and (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256))))
                                        (= ni nr kmac (as mk-none (Maybe Bits_256))))
                                   (ite (= mess 1)
                                        (and (not (= ni (as mk-none (Maybe Bits_256))))
                                             (= nr kmac (as mk-none (Maybe Bits_256)))
                                             (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)))))
                                        (and (not (= sid (as mk-none (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)))))
                                             (ite (= (select Fresh ctr) (mk-some true))
                                                  (not (is-mk-none (select Keys (mk-tuple5 kid U V (maybe-get ni) (maybe-get nr)))))
                                                  (not (is-mk-none kmac)))
                                             (not (= ni (as mk-none (Maybe Bits_256))))
                                             (not (= nr (as mk-none (Maybe Bits_256)))))))))))))))



(define-fun own-nonce-is-unique
    ((state (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (nonces (Array Bits_256 (Maybe Bool))))
  Bool
  (let ((none (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                          (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                          (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int)))))
    (and
     (forall ((ctr Int))
             (let ((state (select state ctr)))
               (=> (not (= state none))
                   (let  ((U    (el11-1  (maybe-get state)))
                          (u    (el11-2  (maybe-get state)))
                          (V    (el11-3  (maybe-get state)))
                          (ltk  (el11-4  (maybe-get state)))
                          (acc  (el11-5  (maybe-get state)))
                          (k    (el11-6  (maybe-get state)))
                          (ni   (el11-7  (maybe-get state)))
                          (nr   (el11-8  (maybe-get state)))
                          (kmac (el11-9  (maybe-get state)))
                          (sid  (el11-10 (maybe-get state)))
                          (mess (el11-11 (maybe-get state))))
                     (ite u
                          (=> (not (= nr (as mk-none (Maybe Bits_256))))
                              (= (select nonces (maybe-get nr)) (mk-some true)))
                          (=> (not (= ni (as mk-none (Maybe Bits_256))))
                              (= (select nonces (maybe-get ni)) (mk-some true))))))))

     (forall ((ctr1 Int)(ctr2 Int))
             (let ((state1 (select state ctr1))
                   (state2 (select state ctr2)))
               (=> (and (not (= none state1))
                        (not (= none state2)))
                   (let ((u1    (el11-2 (maybe-get state1)))
                         (u2    (el11-2 (maybe-get state2)))
                         (ni1   (el11-7 (maybe-get state1)))
                         (ni2   (el11-7 (maybe-get state2)))
                         (nr1   (el11-8 (maybe-get state1)))
                         (nr2   (el11-8 (maybe-get state2))))
                     (and
                      (let ((nonce1 (ite u1 nr1 ni1))
                            (nonce2 (ite u2 nr2 ni2)))
                        (=> (and (not (= ctr1 ctr2))
                                 (not (= nonce1 (as mk-none (Maybe Bits_256)))))
                            (not (= nonce1 nonce2))))))))))))


(define-fun revtesteval-populated
    ((revtesteval (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Int)))
     (H (Array Int (Maybe Bool)))
     (prf (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool) (Maybe Bits_256))))
  Bool
  (forall ((kid Int) (U Int) (V Int) (ni Bits_256) (nr Bits_256))
          (let ((pos-prf (mk-tuple6 kid U V ni nr true))
                (pos-rev (mk-tuple5 kid U V ni nr)))
            (and
             (=> (= (select prf pos-prf)
                    (as mk-none (Maybe Bits_256)))
                 (or (= (select H kid) (mk-some false))
                     (= (select revtesteval pos-rev)
                        (as mk-none (Maybe Int)))))
             (=> (= (select revtesteval pos-rev)
                    (as mk-none (Maybe Int)))
                 (= (select prf pos-prf)
                    (as mk-none (Maybe Bits_256))))))))


(define-fun revtesteval-matches-sometimes
    ((state (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (revtesteval0 (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Int)))
     (revtesteval1 (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Int)))
     (revtest (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256) (Maybe Bool))))
  Bool
     (and
      (forall ((kid Int) (U Int) (V Int) (ni Bits_256) (nr Bits_256))
              (=> (not (is-mk-none (select revtesteval1 (mk-tuple5 kid U V ni nr))))
                  (= (select revtesteval1 (mk-tuple5 kid U V ni nr))
                     (select revtesteval0 (mk-tuple5 kid U V ni nr)))))))



(define-fun freshness-and-honesty-matches
    ((state (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (fresh (Array Int (Maybe Bool)))
     (honest (Array Int (Maybe Bool))))
  Bool
  (let ((none (as mk-none (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                          (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                          (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int)))))
    (forall ((ctr Int))
            (let ((state (select state ctr)))
              (=> (not (= state none))
                  (let ((kid (el11-4  (maybe-get state))))
                    (= (select fresh ctr)
                       (select honest kid))))))))


(define-fun mac-table-wellformed
    ((Keys (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Bits_256)))
     (Values (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256) (Tuple2 Bits_256 Int)) (Maybe Bits_256))))
  Bool
  (forall ((idx (Tuple5 Int Int Int Bits_256 Bits_256))
           (msg1 Bits_256)
           (msg2 Int))
          (let ((val-idx (mk-tuple2 idx (mk-tuple2 msg1 msg2))))
            (and (=> (is-mk-none (select Keys idx))
                     (is-mk-none (select Values val-idx)))

                 (=> (not (is-mk-none (select Values val-idx)))
                     (= (select Values val-idx)
                        (mk-some (<<func-mac>> (maybe-get (select Keys idx))
                                               msg1 msg2))))))))


(define-fun no-ideal-values-for-dishonest-keys
    ((H (Array Int (Maybe Bool)))
     (Prf (Array (Tuple6 Int Int Int Bits_256 Bits_256 Bool) (Maybe Bits_256)))
     (Keys (Array (Tuple5 Int Int Int Bits_256 Bits_256) (Maybe Bits_256))))
  Bool
  (forall ((kid Int)
           (U Int)
           (V Int)
           (ni Bits_256)
           (nr Bits_256))
          (=> (= (select H kid) (mk-some false))
              (and
               (is-mk-none (select Keys (mk-tuple5 kid U V ni nr)))
               (is-mk-none (select Prf (mk-tuple6 kid U V ni nr true)))
               (is-mk-none (select Prf (mk-tuple6 kid U V ni nr false)))))))


(define-fun honest-sessions-to-first-and-second
    ((State (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (Fresh (Array Int (Maybe Bool)))
     (First (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256) (Maybe Int)))
     (Second (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256) (Maybe Int))))
  Bool
  (forall ((ctr Int))
          (let ((state (select State ctr)))
            (=> (not (is-mk-none state))
                (let  ((U    (el11-1  (maybe-get state)))
                       (u    (el11-2  (maybe-get state)))
                       (V    (el11-3  (maybe-get state)))
                       (kid  (el11-4  (maybe-get state)))
                       (acc  (el11-5  (maybe-get state)))
                       (k    (el11-6  (maybe-get state)))
                       (ni   (el11-7  (maybe-get state)))
                       (nr   (el11-8  (maybe-get state)))
                       (kmac (el11-9  (maybe-get state)))
                       (sid  (el11-10 (maybe-get state)))
                       (mess (el11-11 (maybe-get state))))
                  (=> (and (> mess 1)
                           (= (select Fresh ctr) (mk-some true))
                           (or (not u)
                               (= acc (mk-some true))))
                      (ite u
                           (= (mk-some ctr) (select First (maybe-get sid)))
                           (= (mk-some ctr) (select Second (maybe-get sid))))))))))
    
(define-fun sessions-in-first-exist
    ((First (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256) (Maybe Int)))
     (State (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int)))))
  Bool
  (forall ((sid (Tuple5 Int Int Bits_256 Bits_256 Bits_256)))
          (=> (not (is-mk-none (select First sid)))
              (not (is-mk-none (select State (maybe-get (select First sid))))))))


(define-fun honest-sid-have-tau-in-mac
    ((State (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (Fresh (Array Int (Maybe Bool)))
     (Values (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256) (Tuple2 Bits_256 Int)) (Maybe Bits_256))))
  Bool
  (forall ((ctr Int))
          (let ((state (select State ctr)))
            (=> (and (= (select Fresh ctr)
                        (mk-some true))
                     (not (is-mk-none state)))
                (let  ((U    (el11-1  (maybe-get state)))
                       (u    (el11-2  (maybe-get state)))
                       (V    (el11-3  (maybe-get state)))
                       (kid  (el11-4  (maybe-get state)))
                       (acc  (el11-5  (maybe-get state)))
                       (k    (el11-6  (maybe-get state)))
                       (ni   (el11-7  (maybe-get state)))
                       (nr   (el11-8  (maybe-get state)))
                       (kmac (el11-9  (maybe-get state)))
                       (sid  (el11-10 (maybe-get state)))
                       (mess (el11-11 (maybe-get state))))
                  (=> (not (is-mk-none sid))
                      (let ((tau (el5-5 (maybe-get sid))))
                        (= (mk-some tau)
                           (select Values (mk-tuple2 (mk-tuple5 kid U V
                                                                (maybe-get ni) (maybe-get nr))
                                                     (mk-tuple2 (maybe-get nr) 2)))))))))))
                


(define-fun first-set-by-initiator
    ((State (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int))))
     (First (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256) (Maybe Int)))
     (Fresh (Array Int (Maybe Bool)))
     (Values (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256) (Tuple2 Bits_256 Int)) (Maybe Bits_256))))
  Bool
  (forall ((U Int) (V Int) (ni Bits_256) (nr Bits_256) (tau Bits_256))
          (let ((sid (mk-tuple5 U V ni nr tau)))
            (=> (not (is-mk-none (select First sid)))
                (let ((ctr (maybe-get (select First sid))))
                  (let ((kid (el11-4 (maybe-get (select State ctr))))
                        (acc  (el11-5  (maybe-get (select State ctr))))
                        (u   (el11-2 (maybe-get (select State ctr)))))
                    (=> (and (= (select Fresh ctr) (mk-some true))
                             (not (= acc (mk-some false))))
                        (and (= u false)))))))))

(define-fun three-mac-implies-two-mac
    ((Values (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256) (Tuple2 Bits_256 Int)) (Maybe Bits_256))))
  Bool
  (forall ((kid Int) (U Int) (V Int) (ni Bits_256) (nr Bits_256))
          (=> (not (is-mk-none (select Values (mk-tuple2 (mk-tuple5 kid U V ni nr)
                                                         (mk-tuple2 ni 3)))))
              (not (is-mk-none (select Values (mk-tuple2 (mk-tuple5 kid U V ni nr)
                                                         (mk-tuple2 nr 2))))))))                  

(define-fun four-mac-implies-three-mac
    ((Values (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256) (Tuple2 Bits_256 Int)) (Maybe Bits_256))))
  Bool
  (forall ((kid Int) (U Int) (V Int) (ni Bits_256) (nr Bits_256))
          (=> (not (is-mk-none (select Values (mk-tuple2 (mk-tuple5 kid U V ni nr)
                                                         (mk-tuple2 nr 4)))))
              (not (is-mk-none (select Values (mk-tuple2 (mk-tuple5 kid U V ni nr)
                                                         (mk-tuple2 ni 3))))))))                  

(define-fun two-mac-implies-first
    ((Values (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256) (Tuple2 Bits_256 Int)) (Maybe Bits_256)))
     (First (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256) (Maybe Int))))
  Bool
  (forall ((kid Int) (U Int) (V Int) (ni Bits_256) (nr Bits_256))
          (=> (not (is-mk-none (select Values (mk-tuple2 (mk-tuple5 kid U V ni nr)
                                                         (mk-tuple2 nr 2)))))
              (let ((tau (maybe-get (select Values (mk-tuple2 (mk-tuple5 kid U V ni nr)
                                                              (mk-tuple2 nr 2))))))
                (not (is-mk-none (select First (mk-tuple5 U V ni nr tau))))))))

(define-fun three-mac-implies-second
    ((Values (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256) (Tuple2 Bits_256 Int)) (Maybe Bits_256)))
     (Second (Array (Tuple5 Int Int Bits_256 Bits_256 Bits_256) (Maybe Int))))
  Bool
  (forall ((kid Int) (U Int) (V Int) (ni Bits_256) (nr Bits_256))
          (=> (not (is-mk-none (select Values (mk-tuple2 (mk-tuple5 kid U V ni nr)
                                                         (mk-tuple2 ni 3)))))
              (let ((tau (maybe-get (select Values (mk-tuple2 (mk-tuple5 kid U V ni nr)
                                                              (mk-tuple2 ni 3))))))
                (not (is-mk-none (select Second (mk-tuple5 U V ni nr tau))))))))



(define-fun initiator-accepts-with-mac-four-only
    ((Values (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256) (Tuple2 Bits_256 Int)) (Maybe Bits_256)))
     (Fresh (Array Int (Maybe Bool)))
     (State (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int)))))
  Bool
  (forall ((ctr Int))
          (let ((state (select State ctr)))
            (=> (and (not (is-mk-none state))
                     (= (mk-some true) (select Fresh ctr)))
                (let  ((U    (el11-1  (maybe-get state)))
                       (u    (el11-2  (maybe-get state)))
                       (V    (el11-3  (maybe-get state)))
                       (kid  (el11-4  (maybe-get state)))
                       (acc  (el11-5  (maybe-get state)))
                       (k    (el11-6  (maybe-get state)))
                       (ni   (el11-7  (maybe-get state)))
                       (nr   (el11-8  (maybe-get state)))
                       (kmac (el11-9  (maybe-get state)))
                       (sid  (el11-10 (maybe-get state)))
                       (mess (el11-11 (maybe-get state))))
                  (=> (and (= u false)
                           (= acc (mk-some true)))
                      (not (is-mk-none (select Values (mk-tuple2 (mk-tuple5 kid U V (maybe-get ni) (maybe-get nr))
                                                                 (mk-tuple2 (maybe-get nr) 4)))))))))))

(define-fun initiator-msg-2-with-mac-three-only
    ((Values (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256) (Tuple2 Bits_256 Int)) (Maybe Bits_256)))
     (Fresh (Array Int (Maybe Bool)))
     (State (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int)))))
  Bool
  (forall ((ctr Int))
          (let ((state (select State ctr)))
            (=> (and (not (is-mk-none state))
                     (= (mk-some true) (select Fresh ctr)))
                (let  ((U    (el11-1  (maybe-get state)))
                       (u    (el11-2  (maybe-get state)))
                       (V    (el11-3  (maybe-get state)))
                       (kid  (el11-4  (maybe-get state)))
                       (acc  (el11-5  (maybe-get state)))
                       (k    (el11-6  (maybe-get state)))
                       (ni   (el11-7  (maybe-get state)))
                       (nr   (el11-8  (maybe-get state)))
                       (kmac (el11-9  (maybe-get state)))
                       (sid  (el11-10 (maybe-get state)))
                       (mess (el11-11 (maybe-get state))))
                  (=> (and (= u false)
                           (> mess 1))
                      (not (is-mk-none (select Values (mk-tuple2 (mk-tuple5 kid U V (maybe-get ni) (maybe-get nr))
                                                                 (mk-tuple2 (maybe-get ni) 3)))))))))))


(define-fun initiator-accepts-with-msg-2-only
    ((Values (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256) (Tuple2 Bits_256 Int)) (Maybe Bits_256)))
     (Fresh (Array Int (Maybe Bool)))
     (State (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int)))))
  Bool
  (forall ((ctr Int))
          (let ((state (select State ctr)))
            (=> (and (not (is-mk-none state))
                     (= (mk-some true) (select Fresh ctr)))
                (let  ((U    (el11-1  (maybe-get state)))
                       (u    (el11-2  (maybe-get state)))
                       (V    (el11-3  (maybe-get state)))
                       (kid  (el11-4  (maybe-get state)))
                       (acc  (el11-5  (maybe-get state)))
                       (k    (el11-6  (maybe-get state)))
                       (ni   (el11-7  (maybe-get state)))
                       (nr   (el11-8  (maybe-get state)))
                       (kmac (el11-9  (maybe-get state)))
                       (sid  (el11-10 (maybe-get state)))
                       (mess (el11-11 (maybe-get state))))
                  (=> (and (= u false)
                           (= acc (mk-some true)))
                      (> mess 1)))))))

(define-fun responder-accepts-with-mac-three-only
    ((Values (Array (Tuple2 (Tuple5 Int Int Int Bits_256 Bits_256) (Tuple2 Bits_256 Int)) (Maybe Bits_256)))
     (Fresh (Array Int (Maybe Bool)))
     (State (Array Int (Maybe (Tuple11 Int Bool Int Int (Maybe Bool) (Maybe Bits_256)
                                       (Maybe Bits_256) (Maybe Bits_256) (Maybe Bits_256)
                                       (Maybe (Tuple5 Int Int Bits_256 Bits_256 Bits_256)) Int)))))
  Bool
  (forall ((ctr Int))
          (let ((state (select State ctr)))
            (=> (and (not (is-mk-none state))
                     (= (mk-some true) (select Fresh ctr)))
                (let  ((U    (el11-1  (maybe-get state)))
                       (u    (el11-2  (maybe-get state)))
                       (V    (el11-3  (maybe-get state)))
                       (kid  (el11-4  (maybe-get state)))
                       (acc  (el11-5  (maybe-get state)))
                       (k    (el11-6  (maybe-get state)))
                       (ni   (el11-7  (maybe-get state)))
                       (nr   (el11-8  (maybe-get state)))
                       (kmac (el11-9  (maybe-get state)))
                       (sid  (el11-10 (maybe-get state)))
                       (mess (el11-11 (maybe-get state))))
                  (=> (and (= u true)
                           (= acc (mk-some true)))
                      (not (is-mk-none (select Values (mk-tuple2 (mk-tuple5 kid U V (maybe-get ni) (maybe-get nr))
                                                                 (mk-tuple2 (maybe-get ni) 3)))))))))))

;; if first[sid] = some ctr and state[ctr].kid is fresh
;; the state[ctr].u == false and prfvalues[...] = tau
;; (forall kid U V ni nr tau ctr
        
        

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Brainstorming on AtLeast
;;
;; For honest session U should write to one of First, Second and V should write to the other
;; To argue, we can use MAC security to notice that order of events is correct

(define-fun invariant
    ((state-H710  <GameState_H7_<$<!n!>$>>)
     (state-H711  <GameState_H7_<$<!n!>$>>))
  Bool
  (let ((nonces-H710 (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H710))
        (nonces-H711 (<game-H7-<$<!n!>$>-pkgstate-Nonces>  state-H711))
        (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
        (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
        (game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
        (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
        (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
        (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
    (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
          (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
          (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
          (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
          (First0 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H710))
          (First1 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H711))
          (Second0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H710))
          (Second1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H711))
          (RevTested0 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710))
          (RevTested1 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H711))
          (RevTestEval0 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710))
          (RevTestEval1 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711))
          (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
          (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
          (Nonces0 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H710))
          (Nonces1 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H711))
          (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
          (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))
          (Values0 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
          (Values1 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
          (kid0 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
          (kid1 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
          (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
          (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
          (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
          (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
          (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
          (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
      (and (= nonces-H710 nonces-H711)
           (= Ltk0 Ltk1)
           (= H0 H1)
           (= kid0 kid1)
           (= ctr0 ctr1)
           (= State0 State1)
           (= RevTested0 RevTested1)
           (= Fresh0 Fresh1)
           (= Keys0 Keys1)
           (= Values0 Values1)
           (= First0 First1)
           (= Second0 Second1)
           
           (no-overwriting-prf kid0 Prf0 H0 Keys0 Ltk0)
           (no-overwriting-prf kid1 Prf1 H1 Keys1 Ltk1)

           (no-overwriting-game State0 ctr0)
           (sid-is-wellformed State0 Prf0 Fresh0 Keys0)

           (revtesteval-matches-sometimes State0 RevTestEval0 RevTestEval1 RevTested0)
           (mac-keys-equal-in-prf Prf0 Prf1)
           (kmac-and-tau-are-computed-correctly State0 Prf0 H0 Ltk0 Fresh0 Keys0)
           (kmac-and-tau-are-computed-correctly State1 Prf1 H1 Ltk1 Fresh1 Keys1)

           (sid-matches State0 Prf0) ; this property needs mac properties as pre-conditions to hold
           (revtesteval-populated RevTestEval0 H0 Prf0)
           (revtesteval-populated RevTestEval1 H1 Prf1)
           (own-nonce-is-unique State0 Nonces0) ; Chris: takes 1:10 up to here for Send2


;          (prfeval-has-matching-session Prf0 RevTestEval0 RevTestEval1 RevTested0 State0 Fresh0 Keys0)


;           (key-not-computed-unless-test-or-reveal State0 RevTested0 Prf0 H0 Keys0)
;           (key-not-computed-unless-reveal         State1 RevTested1 Prf1 H1 Keys1)

;           (freshness-and-honesty-matches State0 Fresh0 H0)

;           (stuff-not-initialized-early State0 Fresh0 Keys0)
;           (mac-table-wellformed Keys0 Values0)

;           (no-ideal-values-for-dishonest-keys H0 Prf0 Keys0)

;           (sessions-in-first-exist First0 State0)
;           (sessions-in-first-exist Second0 State0)

;           (four-mac-implies-three-mac Values0)
;           (three-mac-implies-two-mac Values0) ; Chris: takes 17 up to here for Send2

           (two-mac-implies-first Values0 First0) ; <--- This condition is wrong.
;           (three-mac-implies-second Values0 Second0)

 ;          (initiator-accepts-with-msg-2-only Values0 Fresh0 State0)
 ;          (initiator-accepts-with-mac-four-only Values0 Fresh0 State0)
 ;          (initiator-msg-2-with-mac-three-only Values0 Fresh0 State0)
 ;          (responder-accepts-with-mac-three-only Values0 Fresh0 State0)
           
 ;          (honest-sid-have-tau-in-mac State0 Fresh0 Values0)
 ;          (first-set-by-initiator State0 First0 Fresh0 Values0)
 ;          (honest-sessions-to-first-and-second State0 Fresh0 First0 Second0)

           ))))

(check-sat)
(define-fun <relation-lemma-false-H7_1_0-H7_1_1-AtLeast>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtLeast>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtLeast>)
     (sid (Tuple5 Int Int Bits_256 Bits_256 Bits_256)))
  Bool
  false)

(define-fun <relation-lemma-false-H7_1_0-H7_1_1-Test>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Test>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Test>)
     (ctr Int))
  Bool
  false)




(define-fun <relation-lemma-debug-H7_1_0-H7_1_1-Test>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Test>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Test>)
     (ctr Int))
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Test-return-value-or-abort> H711-return)))
    (let ((nonces-H710 (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H710))
          (nonces-H711 (<game-H7-<$<!n!>$>-pkgstate-Nonces>  state-H711))
          (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
          (game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
          (game-H710-old (<game-H7-<$<!n!>$>-pkgstate-KX> H710-old))
          (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (game-H711-old (<game-H7-<$<!n!>$>-pkgstate-KX>  H711-old))
          (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H710-old (<game-H7-<$<!n!>$>-pkgstate-PRF> H710-old))
          (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
            (RevTested0 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710))
            (RevTested0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710-old))
            (RevTested1 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H711))
            (RevTestEval0 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710))
            (RevTestEval0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710-old))
            (RevTestEval1 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711))
            (RevTestEval1-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711-old))
            (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Nonces0 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H710))
            (Nonces1 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H711))
            (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))
            (Values0 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
            (Values1 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
            (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf0-old (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710-old))
            (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
        (and

         (=> (not (= retval0 retval1))
             (let ((state (select State0 ctr)))
               (let  ((U    (el11-1  (maybe-get state)))
                      (u    (el11-2  (maybe-get state)))
                      (V    (el11-3  (maybe-get state)))
                      (kid  (el11-4  (maybe-get state)))
                      (acc  (el11-5  (maybe-get state)))
                      (k    (el11-6  (maybe-get state)))
                      (ni   (el11-7  (maybe-get state)))
                      (nr   (el11-8  (maybe-get state)))
                      (kmac (el11-9  (maybe-get state)))
                      (sid  (el11-10 (maybe-get state)))
                      (mess (el11-11 (maybe-get state))))
                   (is-mk-none (select Prf0-old (mk-tuple6 kid U V (maybe-get ni) (maybe-get nr) true))))))

         
             )))))




(define-fun <relation-lemma-debug-H7_1_0-H7_1_1-AtLeast>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtLeast>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_AtLeast>)
     (sid (Tuple5 Int Int Bits_256 Bits_256 Bits_256)))
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-AtLeast-return-value-or-abort> H711-return)))
    (let ((nonces-H710 (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H710))
          (nonces-H711 (<game-H7-<$<!n!>$>-pkgstate-Nonces>  state-H711))
          (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
          (game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
          (game-H710-old (<game-H7-<$<!n!>$>-pkgstate-KX> H710-old))
          (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (game-H711-old (<game-H7-<$<!n!>$>-pkgstate-KX>  H711-old))
          (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H710-old (<game-H7-<$<!n!>$>-pkgstate-PRF> H710-old))
          (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
          (First0 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H710))
          (First1 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H711))
          (Second0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H710))
          (Second1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H711))
            (RevTested0 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710))
            (RevTested0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710-old))
            (RevTested1 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H711))
            (RevTestEval0 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710))
            (RevTestEval0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710-old))
            (RevTestEval1 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711))
            (RevTestEval1-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711-old))
            (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Nonces0 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H710))
            (Nonces1 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H711))
            (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))
            (Values0 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
            (Values1 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
            (kid0 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid1 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf0-old (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710-old))
            (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
        (and (= nonces-H710 nonces-H711)
           (= Ltk0 Ltk1)
           (= H0 H1)
           (= kid0 kid1)
           (= ctr0 ctr1)
           (= State0 State1)
           (= RevTested0 RevTested1)
           (= Fresh0 Fresh1)
           (= Keys0 Keys1)
           (= Values0 Values1)
           (= First0 First1)
           (= Second0 Second1)
           
           (freshness-and-honesty-matches State0 Fresh0 H0)
           (revtesteval-matches-sometimes State0 RevTestEval0 RevTestEval1 RevTested0)
           (no-overwriting-prf kid0 Prf0 H0 Keys0 Ltk0)
           (no-overwriting-game State0 ctr0)
           (sid-is-wellformed State0 Prf0 Fresh0 Keys0)
           (sid-matches State0 Prf0)
           (own-nonce-is-unique State0 Nonces0)
           (revtesteval-populated RevTestEval0 H0 Prf0)
           (revtesteval-populated RevTestEval1 H1 Prf1)
           (prfeval-has-matching-session Prf0 RevTestEval0 RevTestEval1 RevTested0 State0 Fresh0 Keys0)
           (key-not-computed-unless-test-or-reveal State0 RevTested0 Prf0 H0 Keys0)
           (mac-keys-equal-in-prf Prf0 Prf1)
           (kmac-and-tau-are-computed-correctly State0 Prf0 H0 Ltk0 Fresh0 Keys0)
           (kmac-and-tau-are-computed-correctly State1 Prf1 H1 Ltk1 Fresh1 Keys1)
           (stuff-not-initialized-early State0 Fresh0 Keys0)
           (mac-table-wellformed Keys0 Values0)

           (no-ideal-values-for-dishonest-keys H0 Prf0 Keys0)

           (sessions-in-first-exist First0 State0)
           (sessions-in-first-exist Second0 State0)

           (honest-sid-have-tau-in-mac State0 Fresh0 Values0)
           (first-set-by-initiator State0 First0 Fresh0 Values0)
           ;;(honest-sessions-to-first-and-second State0 Fresh0 First0 Second0)

           )))))



(define-fun <relation-lemma-debug-H7_1_0-H7_1_1-Send5>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send5>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send5>)
     (ctr Int) (msg Bits_256))
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send5-return-value-or-abort> H711-return)))
    (let ((nonces-H710 (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H710))
          (nonces-H711 (<game-H7-<$<!n!>$>-pkgstate-Nonces>  state-H711))
          (mac-H710 (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H711 (<game-H7-<$<!n!>$>-pkgstate-MAC>  state-H711))
          (game-H710 (<game-H7-<$<!n!>$>-pkgstate-KX> state-H710))
          (game-H710-old (<game-H7-<$<!n!>$>-pkgstate-KX> H710-old))
          (game-H711 (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (game-H711-old (<game-H7-<$<!n!>$>-pkgstate-KX>  H711-old))
          (prf-H710 (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H710-old (<game-H7-<$<!n!>$>-pkgstate-PRF> H710-old))
          (prf-H711 (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
          (First0 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H710))
          (First1 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H711))
          (Second0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H710))
          (Second1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H711))
            (RevTested0 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710))
            (RevTested0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710-old))
            (RevTested1 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H711))
            (RevTestEval0 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710))
            (RevTestEval0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710-old))
            (RevTestEval1 (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711))
            (RevTestEval1-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711-old))
            (Fresh0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Nonces0 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H710))
            (Nonces1 (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H711))
            (Keys0 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1 (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))
            (Values0 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
            (Values1 (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
            (kid0 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid1 (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (Ltk0 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk1 (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Prf0 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf0-old (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710-old))
            (Prf1 (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (H0 (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H1 (<pkg-state-PRF-<$<!n!>$>-H> prf-H711)))
        (and (= nonces-H710 nonces-H711)
           (= Ltk0 Ltk1)
           (= H0 H1)
           (= kid0 kid1)
           (= ctr0 ctr1)
           (= State0 State1)
           (= RevTested0 RevTested1)
           (= Fresh0 Fresh1)
           (= Keys0 Keys1)
           (= Values0 Values1)
           (= First0 First1)
           (= Second0 Second1)
           
           (freshness-and-honesty-matches State0 Fresh0 H0)
           (revtesteval-matches-sometimes State0 RevTestEval0 RevTestEval1 RevTested0)
           (no-overwriting-prf kid0 Prf0 H0 Keys0 Ltk0)
           (no-overwriting-game State0 ctr0)
           (sid-is-wellformed State0 Prf0 Fresh0 Keys0)
           (sid-matches State0 Prf0)
           (own-nonce-is-unique State0 Nonces0)
           (revtesteval-populated RevTestEval0 H0 Prf0)
           (revtesteval-populated RevTestEval1 H1 Prf1)
           (prfeval-has-matching-session Prf0 RevTestEval0 RevTestEval1 RevTested0 State0 Fresh0 Keys0)
           (key-not-computed-unless-test-or-reveal State0 RevTested0 Prf0 H0 Keys0)
           (mac-keys-equal-in-prf Prf0 Prf1)
           (kmac-and-tau-are-computed-correctly State0 Prf0 H0 Ltk0 Fresh0 Keys0)
           (kmac-and-tau-are-computed-correctly State1 Prf1 H1 Ltk1 Fresh1 Keys1)
           (stuff-not-initialized-early State0 Fresh0 Keys0)
           (mac-table-wellformed Keys0 Values0)

           (no-ideal-values-for-dishonest-keys H0 Prf0 Keys0)

           (sessions-in-first-exist First0 State0)
           (sessions-in-first-exist Second0 State0)

           (four-mac-implies-three-mac Values0)
           (three-mac-implies-two-mac Values0)

           (two-mac-implies-first Values0 First0)
           (three-mac-implies-second Values0 Second0)

           (initiator-accepts-with-msg-2-only Values0 Fresh0 State0)
           (initiator-accepts-with-mac-four-only Values0 Fresh0 State0)
           (initiator-msg-2-with-mac-three-only Values0 Fresh0 State0)
           (responder-accepts-with-mac-three-only Values0 Fresh0 State0)
           
           (honest-sid-have-tau-in-mac State0 Fresh0 Values0)
           (first-set-by-initiator State0 First0 Fresh0 Values0)

           )))))

(define-fun <relation-debug-H7_1_0-H7_1_1-Send2>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send2>)
     (ctr Int) (msg Bits_256))
  Bool
    (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-game-state> H710-return))
          (state-H711 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-game-state> H711-return))
          (retval0    (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> H710-return))
          (retval1    (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send2-return-value-or-abort> H711-return)))
    (let ((nonces-H710     (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H710))
          (nonces-H710-old (<game-H7-<$<!n!>$>-pkgstate-Nonces> H710-old))
          (nonces-H711     (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H711))
          (nonces-H711-old (<game-H7-<$<!n!>$>-pkgstate-Nonces> H711-old))
          (mac-H710      (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H710-old  (<game-H7-<$<!n!>$>-pkgstate-MAC> H710-old))
          (mac-H711      (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H711))
          (mac-H711-old  (<game-H7-<$<!n!>$>-pkgstate-MAC> H711-old))
          (game-H710     (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H710))
          (game-H710-old (<game-H7-<$<!n!>$>-pkgstate-KX>  H710-old))
          (game-H711     (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (game-H711-old (<game-H7-<$<!n!>$>-pkgstate-KX>  H711-old))
          (prf-H710      (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H710-old  (<game-H7-<$<!n!>$>-pkgstate-PRF> H710-old))
          (prf-H711      (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711))
          (prf-H711-old  (<game-H7-<$<!n!>$>-pkgstate-PRF> H711-old)))
      (let ((ctr0         (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1         (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0       (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State0-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710-old))
            (State1       (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
            (State1-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711-old))
            (First0       (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H710))
            (First0-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H710-old))
            (First1       (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H711))
            (First1-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H711-old))
            (Second0      (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H710))
            (Second0-old  (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H710-old))
            (Second1      (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H711))
            (Second1-old  (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H711-old))
            (RevTested0       (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710))
            (RevTested0-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710-old))
            (RevTested1       (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H711))
            (RevTested1-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H711-old))
            (RevTestEval0     (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710))
            (RevTestEval0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710-old))
            (RevTestEval1     (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711))
            (RevTestEval1-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711-old))
            (Fresh0           (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh0-old       (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710-old))
            (Fresh1           (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Fresh1-old       (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711-old))
            (Nonces0          (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H710))
            (Nonces0-old      (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H710-old))
            (Nonces1          (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H711))
            (Nonces1-old      (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H711-old))
            (Keys0            (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys0-old        (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710-old))
            (Keys1            (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))
            (Keys1-old        (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711-old))
            (Values0      (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
            (Values0-old  (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710-old))
            (Values1      (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
            (Values1-old  (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711-old))
            (kid0         (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid0-old     (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710-old))
            (kid1         (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (kid1-old     (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711-old))
            (Ltk0         (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk0-old     (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710-old))
            (Ltk1         (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Ltk1-old     (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711-old))
            (Prf0         (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf0-old     (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710-old))
            (Prf1         (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (Prf1-old     (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711-old))
            (H0           (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H0-old       (<pkg-state-PRF-<$<!n!>$>-H> prf-H710-old))
            (H1           (<pkg-state-PRF-<$<!n!>$>-H> prf-H711))
            (H1-old       (<pkg-state-PRF-<$<!n!>$>-H> prf-H711-old)))
          (and
           (= nonces-H710 nonces-H711)
           (= Ltk0 Ltk1)
           (= H0 H1)
           (= kid0 kid1)
           (= ctr0 ctr1)
           (= State0 State1)
           (= RevTested0 RevTested1)
           (= Fresh0 Fresh1)
           (= Keys0 Keys1)
           (= Values0 Values1)
           (= First0 First1)
           (= Second0 Second1)
;           (= mac-H710-old mac-H710) changes at specific position
;           (= mac-H711-old mac-H711) changes at specific position
;           For all 4-tuples: The 4-tuple is either equal to what is used by this oracle or mac-old = mac-new
;           (= nonces-H710 nonces-H710-old) changes at specific position
;           (= nonces-H711 nonces-H711-old) changes at specific position
;           For all nc_: nc_ either equal to what is sampled in this oracle or Nonces-old[nc_] = Nonces-new[nc_]
;           (= Prf0 Prf0-old) changes at specific position
;           (= Prf1 Prf1-old) changes at specific position
           (= Fresh0 Fresh0-old)
           (= Fresh1 Fresh1-old)
           (forall ((ctr_ Int)) (or (= ctr ctr_) (and
                         (= (select State0-old ctr_) (select State0 ctr_))
                         (= (select State1-old ctr_) (select State1 ctr_)))))
           (= kid0 kid0-old)
           (= kid1 kid1-old)
           (= Ltk0 Ltk0-old)
           (= Ltk1 Ltk1-old)
           (= H0 H0-old)
           (= H1 H1-old)
           (own-nonce-is-unique State1-old Nonces1-old)
           (sid-matches State0-old Prf0-old)
           (sid-matches State1-old Prf1-old)
           (key-not-computed-unless-test-or-reveal State0 RevTested0 Prf0 H0 Keys0)
           (key-not-computed-unless-reveal         State1 RevTested1 Prf1 H1 Keys1)


           (freshness-and-honesty-matches State1-old Fresh1-old H1-old)

           (stuff-not-initialized-early State1-old Fresh1-old Keys1-old)
           (mac-table-wellformed Keys1-old Values1-old)

           (no-ideal-values-for-dishonest-keys H1-old Prf1-old Keys1-old)

           (sessions-in-first-exist First1-old State1-old)
           (sessions-in-first-exist Second1-old State1-old)

           (four-mac-implies-three-mac Values1-old)
           (three-mac-implies-two-mac Values1-old)

        ;  (two-mac-implies-first Values0-old First0-old) ; <--- Wrong for Send2.
           (three-mac-implies-second Values1-old Second1-old)

           (initiator-accepts-with-msg-2-only Values1-old Fresh1-old State1-old)
           (initiator-accepts-with-mac-four-only Values1-old Fresh1-old State1-old)
           (initiator-msg-2-with-mac-three-only Values1-old Fresh1-old State1-old)
           (responder-accepts-with-mac-three-only Values1-old Fresh1-old State1-old)
           
           (honest-sid-have-tau-in-mac State1-old Fresh1-old Values1-old)
           (first-set-by-initiator State1-old First1-old Fresh1-old Values1-old)
           (honest-sessions-to-first-and-second State1-old Fresh1-old First1-old Second1-old)

           )))))


(define-fun <relation-lemma-debug-H7_1_0-H7_1_1-NewKey>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_PRF_<$<!n!>$>_NewKey>)
     (k (Maybe Bits_256))
    )
  Bool
  (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H710-return))
        (state-H711 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-game-state> H711-return))
        (retval0 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H710-return))
        (retval1 (<oracle-return-H7-<$<!n!>$>-PRF-<$<!n!>$>-NewKey-return-value-or-abort> H711-return)))
    (let ((nonces-H710     (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H710))
          (nonces-H710-old (<game-H7-<$<!n!>$>-pkgstate-Nonces> H710-old))
          (nonces-H711     (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H711))
          (nonces-H711-old (<game-H7-<$<!n!>$>-pkgstate-Nonces> H711-old))
          (mac-H710      (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H710-old  (<game-H7-<$<!n!>$>-pkgstate-MAC> H710-old))
          (mac-H711      (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H711))
          (mac-H711-old  (<game-H7-<$<!n!>$>-pkgstate-MAC> H711-old))
          (game-H710     (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H710))
          (game-H710-old (<game-H7-<$<!n!>$>-pkgstate-KX>  H710-old))
          (game-H711     (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (game-H711-old (<game-H7-<$<!n!>$>-pkgstate-KX>  H711-old))
          (prf-H710      (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H710-old  (<game-H7-<$<!n!>$>-pkgstate-PRF> H710-old))
          (prf-H711      (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711))
          (prf-H711-old  (<game-H7-<$<!n!>$>-pkgstate-PRF> H711-old)))
      (let ((ctr0 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1 (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State1 (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
          (First0 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H710))
          (First1 (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H711))
          (Second0 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H710))
          (Second1 (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H711))
            (RevTested0       (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710))
            (RevTested0-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710-old))
            (RevTested1       (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H711))
            (RevTestEval0     (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710))
            (RevTestEval0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710-old))
            (RevTestEval1     (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711))
            (RevTestEval1-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711-old))
            (Fresh0           (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh1           (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Nonces0          (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H710))
            (Nonces1          (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H711))
            (Keys0            (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys1            (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))
            (Values0     (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
            (Values0-old (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710-old))
            (Values1     (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
            (Values1-old (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711-old))
            (kid0     (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid0-old (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710-old))
            (kid1     (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (kid1-old (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711-old))
            (Ltk0     (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk0-old (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710-old))
            (Ltk1     (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Ltk1-old (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711-old))
            (Prf0     (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf0-old (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710-old))
            (Prf1     (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (Prf1-old (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711-old))
            (H0     (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H0-old (<pkg-state-PRF-<$<!n!>$>-H> prf-H710-old))
            (H1     (<pkg-state-PRF-<$<!n!>$>-H> prf-H711))
            (H1-old (<pkg-state-PRF-<$<!n!>$>-H> prf-H711-old)))
        (and (= nonces-H710 nonces-H711)
           (= Ltk0 Ltk1)
           (= H0 H1)
           (= kid0 kid1)
           (= ctr0 ctr1)
           (= State0 State1)
           (= RevTested0 RevTested1)
           (= Fresh0 Fresh1)
           (= Keys0 Keys1)
           (= Values0 Values1)
           (= First0 First1)
           (= Second0 Second1)
           (= mac-H710-old mac-H710)
           (= mac-H711-old mac-H711)
           (= nonces-H710 nonces-H710-old)
           (= nonces-H711 nonces-H711-old)
           (= game-H710 game-H710-old)
           (= game-H711 game-H711-old)
           (= Prf0 Prf0-old)
           (= Prf1 Prf1-old)
           (= kid0 (+ 1 kid0-old))
           (= kid1 (+ 1 kid1-old))
           (forall ((kid Int)) (or (= kid kid0) (and
                                                (= (select Ltk0-old kid) (select Ltk0 kid))
                                                (= (select Ltk1-old kid) (select Ltk1 kid)))))
           (forall ((kid Int)) (or (= kid kid0) (and
                                                (= (select H0-old kid) (select H0 kid))
                                                (= (select H1-old kid) (select H1 kid)))))
           (no-overwriting-prf kid0 Prf0 H0 Keys0 Ltk0)
           (no-overwriting-prf kid1 Prf1 H1 Keys1 Ltk1)


           )))))

(define-fun <relation-debug-H7_1_0-H7_1_1-Send1>
    ((H710-old <GameState_H7_<$<!n!>$>>)
     (H711-old <GameState_H7_<$<!n!>$>>)
     (H710-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send1>)
     (H711-return <OracleReturn_H7_<$<!n!>$>_KX_noprfkey_<$<!n!>$>_Send1>)
     (ctr Int))
  Bool
    (let ((state-H710 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1-game-state> H710-return))
          (state-H711 (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1-game-state> H711-return))
          (retval0    (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1-return-value-or-abort> H710-return))
          (retval1    (<oracle-return-H7-<$<!n!>$>-KX_noprfkey-<$<!n!>$>-Send1-return-value-or-abort> H711-return)))
    (let ((nonces-H710     (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H710))
          (nonces-H710-old (<game-H7-<$<!n!>$>-pkgstate-Nonces> H710-old))
          (nonces-H711     (<game-H7-<$<!n!>$>-pkgstate-Nonces> state-H711))
          (nonces-H711-old (<game-H7-<$<!n!>$>-pkgstate-Nonces> H711-old))
          (mac-H710      (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H710))
          (mac-H710-old  (<game-H7-<$<!n!>$>-pkgstate-MAC> H710-old))
          (mac-H711      (<game-H7-<$<!n!>$>-pkgstate-MAC> state-H711))
          (mac-H711-old  (<game-H7-<$<!n!>$>-pkgstate-MAC> H711-old))
          (game-H710     (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H710))
          (game-H710-old (<game-H7-<$<!n!>$>-pkgstate-KX>  H710-old))
          (game-H711     (<game-H7-<$<!n!>$>-pkgstate-KX>  state-H711))
          (game-H711-old (<game-H7-<$<!n!>$>-pkgstate-KX>  H711-old))
          (prf-H710      (<game-H7-<$<!n!>$>-pkgstate-PRF> state-H710))
          (prf-H710-old  (<game-H7-<$<!n!>$>-pkgstate-PRF> H710-old))
          (prf-H711      (<game-H7-<$<!n!>$>-pkgstate-PRF>  state-H711))
          (prf-H711-old  (<game-H7-<$<!n!>$>-pkgstate-PRF> H711-old)))
      (let ((ctr0         (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H710))
            (ctr1         (<pkg-state-KX_noprfkey-<$<!n!>$>-ctr_> game-H711))
            (State0       (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710))
            (State0-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H710-old))
            (State1       (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711))
            (State1-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-State> game-H711-old))
            (First0       (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H710))
            (First0-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H710-old))
            (First1       (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H711))
            (First1-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-First> game-H711-old))
            (Second0      (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H710))
            (Second0-old  (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H710-old))
            (Second1      (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H711))
            (Second1-old  (<pkg-state-KX_noprfkey-<$<!n!>$>-Second> game-H711-old))
            (RevTested0       (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710))
            (RevTested0-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H710-old))
            (RevTested1       (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H711))
            (RevTested1-old   (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTested> game-H711-old))
            (RevTestEval0     (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710))
            (RevTestEval0-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H710-old))
            (RevTestEval1     (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711))
            (RevTestEval1-old (<pkg-state-KX_noprfkey-<$<!n!>$>-RevTestEval> game-H711-old))
            (Fresh0           (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710))
            (Fresh0-old       (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H710-old))
            (Fresh1           (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711))
            (Fresh1-old       (<pkg-state-KX_noprfkey-<$<!n!>$>-Fresh> game-H711-old))
            (Nonces0          (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H710))
            (Nonces0-old      (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H710-old))
            (Nonces1          (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H711))
            (Nonces1-old      (<pkg-state-Nonces-<$<!n!>$>-Nonces> nonces-H711-old))
            (Keys0            (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710))
            (Keys0-old        (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H710-old))
            (Keys1            (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711))
            (Keys1-old        (<pkg-state-MAC-<$<!n!>$>-Keys> mac-H711-old))
            (Values0      (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710))
            (Values0-old  (<pkg-state-MAC-<$<!n!>$>-Values> mac-H710-old))
            (Values1      (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711))
            (Values1-old  (<pkg-state-MAC-<$<!n!>$>-Values> mac-H711-old))
            (kid0         (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710))
            (kid0-old     (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H710-old))
            (kid1         (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711))
            (kid1-old     (<pkg-state-PRF-<$<!n!>$>-kid_> prf-H711-old))
            (Ltk0         (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710))
            (Ltk0-old     (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H710-old))
            (Ltk1         (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711))
            (Ltk1-old     (<pkg-state-PRF-<$<!n!>$>-LTK> prf-H711-old))
            (Prf0         (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710))
            (Prf0-old     (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H710-old))
            (Prf1         (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711))
            (Prf1-old     (<pkg-state-PRF-<$<!n!>$>-PRF> prf-H711-old))
            (H0           (<pkg-state-PRF-<$<!n!>$>-H> prf-H710))
            (H0-old       (<pkg-state-PRF-<$<!n!>$>-H> prf-H710-old))
            (H1           (<pkg-state-PRF-<$<!n!>$>-H> prf-H711))
            (H1-old       (<pkg-state-PRF-<$<!n!>$>-H> prf-H711-old)))
          (and
           (= nonces-H710 nonces-H711)
           (= Ltk0 Ltk1)
           (= H0 H1)
           (= kid0 kid1)
           (= ctr0 ctr1)
           (= State0 State1)
           (= RevTested0 RevTested1)
           (= Fresh0 Fresh1)
           (= Keys0 Keys1)
           (= Values0 Values1)
           (= First0 First1)
           (= Second0 Second1)
;           (= mac-H710-old mac-H710) changes at specific position
;           (= mac-H711-old mac-H711) changes at specific position
;           For all 4-tuples: The 4-tuple is either equal to what is used by this oracle or mac-old = mac-new
;           (= nonces-H710 nonces-H710-old) changes at specific position
;           (= nonces-H711 nonces-H711-old) changes at specific position
;           For all nc_: nc_ either equal to what is sampled in this oracle or Nonces-old[nc_] = Nonces-new[nc_]
;           (= Prf0 Prf0-old) changes at specific position
;           (= Prf1 Prf1-old) changes at specific position
           (= Fresh0 Fresh0-old)
           (= Fresh1 Fresh1-old)
           (forall ((ctr_ Int)) (or (= ctr ctr_) (and
                         (= (select State0-old ctr_) (select State0 ctr_))
                         (= (select State1-old ctr_) (select State1 ctr_)))))
           (= kid0 kid0-old)
           (= kid1 kid1-old)
           (= Ltk0 Ltk0-old)
           (= Ltk1 Ltk1-old)
           (= H0 H0-old)
           (= H1 H1-old)
           (own-nonce-is-unique State1-old Nonces1-old)
           (sid-matches State0-old Prf0-old)
           (sid-matches State1-old Prf1-old)
           (key-not-computed-unless-test-or-reveal State0 RevTested0 Prf0 H0 Keys0)
           (key-not-computed-unless-reveal         State1 RevTested1 Prf1 H1 Keys1)


           (freshness-and-honesty-matches State1-old Fresh1-old H1-old)

           (stuff-not-initialized-early State1-old Fresh1-old Keys1-old)
           (mac-table-wellformed Keys1-old Values1-old)

           (no-ideal-values-for-dishonest-keys H1-old Prf1-old Keys1-old)

           (sessions-in-first-exist First1-old State1-old)
           (sessions-in-first-exist Second1-old State1-old)

           (four-mac-implies-three-mac Values1-old)
           (three-mac-implies-two-mac Values1-old)

        ;  (two-mac-implies-first Values0-old First0-old) ; <--- Wrong for Send2.
           (three-mac-implies-second Values1-old Second1-old)

           (initiator-accepts-with-msg-2-only Values1-old Fresh1-old State1-old)
           (initiator-accepts-with-mac-four-only Values1-old Fresh1-old State1-old)
           (initiator-msg-2-with-mac-three-only Values1-old Fresh1-old State1-old)
           (responder-accepts-with-mac-three-only Values1-old Fresh1-old State1-old)
           
           (honest-sid-have-tau-in-mac State1-old Fresh1-old Values1-old)
           (first-set-by-initiator State1-old First1-old Fresh1-old Values1-old)
           (honest-sessions-to-first-and-second State1-old Fresh1-old First1-old Second1-old)

           )))))


(check-sat)
(define-fun randomness-mapping-NewSession
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  false)

(define-fun randomness-mapping-NewKey
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  (and (= base-ctr-0 scr-0)
       (= base-ctr-1 scr-1)
       (= id-0 id-1)))

(define-fun randomness-mapping-Send1
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  (and (= base-ctr-0 scr-0)
       (= base-ctr-1 scr-1)
       (= id-0 id-1)))

(define-fun randomness-mapping-Send2
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  (and (= base-ctr-0 scr-0)
       (= base-ctr-1 scr-1)
       (= id-0 id-1)))

(define-fun randomness-mapping-Send3
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  (and (= base-ctr-0 scr-0)
       (= base-ctr-1 scr-1)
       (= id-0 id-1)))

(define-fun randomness-mapping-Send4
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  false)

(define-fun randomness-mapping-Send5
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  false)

(define-fun randomness-mapping-Test
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  (and
   (= scr-1 base-ctr-1)
   (= scr-0 base-ctr-0)
   (= id-0 (sample-id "PRF" "Eval" "1"))
   (= id-1 (sample-id "KX" "Test" "1"))))

(define-fun randomness-mapping-Reveal
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  (and (= base-ctr-0 scr-0)
       (= base-ctr-1 scr-1)
       (= id-0 id-1)))

(define-fun randomness-mapping-SameKey
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  false)

(define-fun randomness-mapping-AtMost
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  false)

(define-fun randomness-mapping-AtLeast
    ((base-ctr-0 Int) (base-ctr-1 Int)
     (id-0 SampleId) (id-1 SampleId)
     (scr-0 Int) (scr-1 Int))
  Bool
  false)



(check-sat)
(push 1)(assert (not (=> (and (forall ((randmap-sample-id-left SampleId)
 (randmap-sample-ctr-left Int)
 (randmap-sample-id-right SampleId)
 (randmap-sample-ctr-right Int)
)
 (=> (randomness-mapping-Send2 (get-rand-ctr-H7_1_0 randmap-sample-id-left)
 (get-rand-ctr-H7_1_1 randmap-sample-id-right)
 randmap-sample-id-left randmap-sample-id-right randmap-sample-ctr-left randmap-sample-ctr-right)
 (rand-is-eq randmap-sample-id-left randmap-sample-id-right randmap-sample-ctr-left randmap-sample-ctr-right)
)
)
 (invariant <<game-state-H7_1_0-old>> <<game-state-H7_1_1-old>>)
)
 (<relation-equal-aborts-H7_1_0-H7_1_1-Send2> <<game-state-H7_1_0-old>> <<game-state-H7_1_1-old>> <return-H7_1_0-Send2> <return-H7_1_1-Send2> <arg-Send2-ctr> <arg-Send2-msg>)
)
)
)

(check-sat)
(pop 1)(push 1)(assert (not (=> (and (forall ((randmap-sample-id-left SampleId)
 (randmap-sample-ctr-left Int)
 (randmap-sample-id-right SampleId)
 (randmap-sample-ctr-right Int)
)
 (=> (randomness-mapping-Send2 (get-rand-ctr-H7_1_0 randmap-sample-id-left)
 (get-rand-ctr-H7_1_1 randmap-sample-id-right)
 randmap-sample-id-left randmap-sample-id-right randmap-sample-ctr-left randmap-sample-ctr-right)
 (rand-is-eq randmap-sample-id-left randmap-sample-id-right randmap-sample-ctr-left randmap-sample-ctr-right)
)
)
 (invariant <<game-state-H7_1_0-old>> <<game-state-H7_1_1-old>>)
 (<relation-no-abort-H7_1_0-H7_1_1-Send2> <<game-state-H7_1_0-old>> <<game-state-H7_1_1-old>> <return-H7_1_0-Send2> <return-H7_1_1-Send2> <arg-Send2-ctr> <arg-Send2-msg>)
)
 (<relation-same-output-H7_1_0-H7_1_1-Send2> <<game-state-H7_1_0-old>> <<game-state-H7_1_1-old>> <return-H7_1_0-Send2> <return-H7_1_1-Send2> <arg-Send2-ctr> <arg-Send2-msg>)
)
)
)




(check-sat)
(pop 1)(push 1)(assert (not (=> (and 
(rand-is-eq (sample-id "Nonces" "Sample" "1") 
            (sample-id "Nonces" "Sample" "1") 
            (get-rand-ctr-H7_1_0 (sample-id "Nonces" "Sample" "1"))
            (get-rand-ctr-H7_1_1 (sample-id "Nonces" "Sample" "1")))
(rand-is-eq (sample-id "MAC" "Init" "1") 
            (sample-id "MAC" "Init" "1") 
            (get-rand-ctr-H7_1_0 (sample-id "MAC" "Init" "1"))
            (get-rand-ctr-H7_1_1 (sample-id "MAC" "Init" "1")))
(rand-is-eq (sample-id "PRF" "Eval" "1") 
            (sample-id "PRF" "Eval" "1") 
            (get-rand-ctr-H7_1_0 (sample-id "PRF" "Eval" "1"))
            (get-rand-ctr-H7_1_1 (sample-id "PRF" "Eval" "1")))

(invariant <<game-state-H7_1_0-old>> <<game-state-H7_1_1-old>>)
(<relation-no-abort-H7_1_0-H7_1_1-Send2> <<game-state-H7_1_0-old>> <<game-state-H7_1_1-old>> <return-H7_1_0-Send2> <return-H7_1_1-Send2> <arg-Send2-ctr> <arg-Send2-msg>)
)
 (<relation-debug-H7_1_0-H7_1_1-Send2> <<game-state-H7_1_0-old>> <<game-state-H7_1_1-old>> <return-H7_1_0-Send2> <return-H7_1_1-Send2> <arg-Send2-ctr> <arg-Send2-msg>)
)
)
)

(check-sat)
(get-model)
